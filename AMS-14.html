<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clase 14: Diagramas de Clases UML</title>
    <meta name="description" content="Curso de Análisis y Metodología de Sistemas - Material educativo para estudiantes de Tecnicatura Superior en Análisis de Sistemas">
    <meta name="author" content="Curso AMS HTML">
    <meta name="keywords" content="análisis de sistemas, metodologías de desarrollo, ingeniería de software, sistemas de información">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --background-color: #ecf0f1;
            --text-color: #2c3e50;
            --border-color: #bdc3c7;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --info-color: #3498db;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        h2 {
            color: var(--primary-color);
            margin: 2rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--secondary-color);
        }

        h3 {
            color: var(--secondary-color);
            margin: 1.5rem 0 0.75rem;
        }

        h4 {
            color: var(--primary-color);
            margin: 1rem 0 0.5rem;
        }

        .section {
            background: white;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .intro-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border-left: 5px solid var(--secondary-color);
        }

        .concept-box {
            background: #f8f9fa;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .example-box {
            background: #e8f5e9;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            border: 1px solid #4caf50;
        }

        .warning-box {
            background: #fff3cd;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            border: 1px solid #ffc107;
        }

        .diagram-container {
            background: white;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow-x: auto;
            text-align: center;
        }

        .diagram-title {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 1rem;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #d73a49;
        }

        .code-block {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            border: 1px solid #3e3e3e;
        }

        .code-header {
            background-color: #2d2d2d;
            padding: 0.5rem 1rem;
            margin: -1.5rem -1.5rem 1rem -1.5rem;
            border-bottom: 1px solid #3e3e3e;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .code-lang {
            color: #608b4e;
            font-weight: bold;
            font-size: 12px;
        }

        .code-filename {
            color: #808080;
            font-size: 12px;
            margin-left: auto;
        }

        /* Sintaxis highlighting estilo VS Code Dark+ */
        .keyword {
            color: #569cd6;
        }

        .string {
            color: #ce9178;
        }

        .comment {
            color: #6a9955;
            font-style: italic;
        }

        .function {
            color: #dcdcaa;
        }

        .class-name {
            color: #4ec9b0;
        }

        .decorator {
            color: #ffd700;
        }

        .number {
            color: #b5cea8;
        }

        .operator {
            color: #d4d4d4;
        }

        .self {
            color: #9cdcfe;
        }

        .builtin {
            color: #ce9178;
        }

        .parameter {
            color: #9cdcfe;
        }

        .synoptic-table {
            background: #f0f8ff;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 10px;
            border: 2px solid var(--info-color);
        }

        .pattern-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .pattern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .quiz-section {
            background: #f9f9f9;
            padding: 2rem;
            margin-top: 3rem;
            border-radius: 10px;
            border: 2px solid var(--primary-color);
        }

        .quiz-instructions {
            background: var(--info-color);
            color: white;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .question {
            background: white;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .question.answered {
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }

        .question h4 {
            color: var(--secondary-color);
            margin-bottom: 1rem;
        }

        .options {
            list-style-type: none;
            margin-left: 0;
        }

        .options li {
            background: #f4f4f4;
            padding: 0.75rem 1rem;
            margin: 0.5rem 0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .options li:hover {
            background: #e0e0e0;
            transform: translateX(5px);
        }

        .options li.selected {
            background: #d0e4f5;
            border-color: var(--secondary-color);
            font-weight: bold;
        }

        .options li.correct {
            background: #d4edda;
            border-color: var(--success-color);
            color: var(--success-color);
        }

        .options li.incorrect {
            background: #f8d7da;
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .quiz-controls {
            text-align: center;
            margin: 2rem 0;
        }

        .quiz-button {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 5px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 0.5rem;
        }

        .quiz-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .quiz-button.secondary {
            background: var(--warning-color);
        }

        .quiz-button.secondary:hover {
            background: #e67e22;
        }

        .quiz-results {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin-top: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .results-summary {
            text-align: center;
            margin-bottom: 2rem;
        }

        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 2rem auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: scale(0);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .score-text {
            color: white;
            font-size: 3rem;
            font-weight: bold;
        }

        .score-total {
            font-size: 1.5rem;
        }

        .score-percentage {
            color: white;
            font-size: 1.5rem;
            margin-top: 0.5rem;
        }

        .score-message {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 2rem 0;
            padding: 1rem;
            border-radius: 10px;
        }

        .score-message.excellent {
            color: var(--success-color);
            background: #d4edda;
        }

        .score-message.good {
            color: var(--info-color);
            background: #cce5ff;
        }

        .score-message.regular {
            color: var(--warning-color);
            background: #fff3cd;
        }

        .score-message.needs-improvement {
            color: var(--accent-color);
            background: #f8d7da;
        }

        .answers-review {
            margin-top: 2rem;
        }

        .answer-item {
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .answer-item.correct {
            background: #d4edda;
            color: var(--success-color);
        }

        .answer-item.incorrect {
            background: #f8d7da;
            color: var(--accent-color);
        }

        .answer-icon {
            font-size: 1.5rem;
        }

        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .notation-reference {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .notation-item {
            background: white;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            text-align: center;
        }

        .interactive-diagram {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .interactive-diagram:hover {
            filter: brightness(1.1);
        }

        .quiz-button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), var(--info-color));
            width: 0%;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            table {
                font-size: 0.9rem;
            }

            .notation-reference {
                grid-template-columns: 1fr;
            }
            
            .score-circle {
                width: 150px;
                height: 150px;
            }
            
            .score-text {
                font-size: 2rem;
            }
        }
    </style>
    <link rel="stylesheet" href="accessibility.css">
</head>
<body role="document">
    <header>
        <h1 id="main-title">Clase 14: Diagramas de Clases UML</h1>
        <p>Análisis y Metodología de Sistemas - Unidad 4</p>
        <p>Modelado Visual de Estructuras Orientadas a Objetos</p>
    </header>

    <div class="container" role="main">
        <!-- Introducción -->
        <section class="section">
            <h2>Introducción</h2>
            <div class="intro-box">
                <p>Los diagramas de clases UML representan la columna vertebral del modelado orientado a objetos. Son la herramienta fundamental para visualizar, especificar, construir y documentar los artefactos de un sistema software. En esta clase, profundizaremos en la notación completa de UML 2.0, las relaciones entre clases, las técnicas de modelado efectivo y la representación de patrones de diseño.</p>
                
                <p>Un diagrama de clases muestra un conjunto de clases, interfaces y colaboraciones, junto con sus relaciones. Estos diagramas son los más comunes en el modelado de sistemas orientados a objetos y cubren tanto la vista de diseño estática como la vista de procesos estática de un sistema.</p>
            </div>

            <h3>Objetivos de Aprendizaje</h3>
            <ul role="list">
                <li role="listitem">Dominar la notación completa de diagramas de clases UML 2.0</li>
                <li role="listitem">Comprender y aplicar correctamente todos los tipos de relaciones entre clases</li>
                <li role="listitem">Desarrollar habilidades para el modelado efectivo de dominios complejos</li>
                <li role="listitem">Representar patrones de diseño usando notación UML estándar</li>
                <li role="listitem">Aplicar mejores prácticas en la construcción de modelos de clases</li>
            </ul>
        </section>

        <!-- Sección 1: Notación UML Básica -->
        <section class="section">
            <h2>1. Notación UML Básica (1000 palabras)</h2>
            
            <h3>1.1 Representación de Clases</h3>
            <p>Una clase en UML se representa mediante un rectángulo dividido en tres compartimentos horizontales. Esta estructura fundamental permite expresar la esencia de una clase: su identidad, su estado y su comportamiento.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 1: Estructura Básica de una Clase UML</div>
                <svg width="300" height="200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Clase básica -->
                    <rect x="50" y="20" width="200" height="160" fill="white" stroke="black" stroke-width="2"/>
                    
                    <!-- Divisiones -->
                    <line x1="50" y1="60" x2="250" y2="60" stroke="black" stroke-width="1"/>
                    <line x1="50" y1="120" x2="250" y2="120" stroke="black" stroke-width="1"/>
                    
                    <!-- Contenido -->
                    <text x="150" y="45" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">NombreClase</text>
                    <text x="60" y="85" font-family="Arial" font-size="14">- atributo1: Tipo</text>
                    <text x="60" y="105" font-family="Arial" font-size="14">+ atributo2: Tipo = valor</text>
                    <text x="60" y="145" font-family="Arial" font-size="14">+ método1(): TipoRetorno</text>
                    <text x="60" y="165" font-family="Arial" font-size="14"># método2(param: Tipo)</text>
                </svg>
            </div>

            <h4>1.1.1 Compartimento del Nombre</h4>
            <p>El compartimento superior contiene el nombre de la clase. Este debe ser un sustantivo o frase nominal que represente claramente el concepto que modela. Las convenciones de nomenclatura siguen el estilo CamelCase, comenzando con mayúscula.</p>

            <div class="concept-box">
                <h4>Modificadores del Nombre de Clase:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Clase Abstracta:</strong> Se representa con el nombre en <em>cursiva</em> o con el estereotipo «abstract»</li>
                    <li role="listitem"><strong>Interfaz:</strong> Se indica con el estereotipo «interface» sobre el nombre</li>
                    <li role="listitem"><strong>Clase Parametrizada (Template):</strong> Se añade un rectángulo punteado en la esquina superior derecha</li>
                    <li role="listitem"><strong>Estereotipos personalizados:</strong> Entre comillas angulares «estereotipo»</li>
                </ul>
            </div>

            <h4>1.1.2 Compartimento de Atributos</h4>
            <p>El segundo compartimento lista los atributos de la clase. Cada atributo sigue una sintaxis específica que permite expresar su visibilidad, nombre, tipo, multiplicidad y valor inicial.</p>

            <div class="synoptic-table">
                <h4>Sintaxis Completa de Atributos:</h4>
                <code>[visibilidad] nombre [multiplicidad] : tipo [= valor_inicial] [{propiedades}]</code>
                
                <table role="table">
                    <tr role="row">
                        <th role="columnheader">Elemento</th>
                        <th role="columnheader">Descripción</th>
                        <th role="columnheader">Ejemplo</th>
                    </tr>
                    <tr role="row">
                        <td role="cell">Visibilidad</td>
                        <td role="cell">
                            + (público)<br>
                            - (privado)<br>
                            # (protegido)<br>
                            ~ (paquete)
                        </td>
                        <td role="cell">- nombre: String</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Multiplicidad</td>
                        <td role="cell">Cardinalidad del atributo</td>
                        <td role="cell">telefonos[0..*]: String</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Propiedades</td>
                        <td role="cell">Restricciones adicionales</td>
                        <td role="cell">id: Integer {readonly}</td>
                    </tr>
                </table>
            </div>

            <h4>1.1.3 Compartimento de Operaciones</h4>
            <p>El tercer compartimento contiene las operaciones (métodos) de la clase. Al igual que los atributos, las operaciones tienen una sintaxis específica que permite expresar toda la información relevante sobre su firma.</p>

            <div class="example-box">
                <h4>Ejemplo de Notación de Operaciones:</h4>
                <code>+ calcularTotal(descuento: Double = 0.0): Money {query}</code>
                <ul role="list">
                    <li role="listitem"><strong>+</strong> : Visibilidad pública</li>
                    <li role="listitem"><strong>calcularTotal</strong> : Nombre del método</li>
                    <li role="listitem"><strong>descuento: Double = 0.0</strong> : Parámetro con valor por defecto</li>
                    <li role="listitem"><strong>Money</strong> : Tipo de retorno</li>
                    <li role="listitem"><strong>{query}</strong> : Propiedad que indica que no modifica el estado</li>
                </ul>
            </div>

            <h3>1.2 Visibilidad en UML</h3>
            <p>La visibilidad es un aspecto crucial del encapsulamiento en el diseño orientado a objetos. UML proporciona cuatro niveles de visibilidad que corresponden directamente con los modificadores de acceso en la mayoría de los lenguajes de programación orientados a objetos.</p>

            <div class="notation-reference">
                <div class="notation-item">
                    <h4>+ Público</h4>
                    <p>Accesible desde cualquier clase</p>
                </div>
                <div class="notation-item">
                    <h4>- Privado</h4>
                    <p>Solo accesible dentro de la misma clase</p>
                </div>
                <div class="notation-item">
                    <h4># Protegido</h4>
                    <p>Accesible desde la clase y sus subclases</p>
                </div>
                <div class="notation-item">
                    <h4>~ Paquete</h4>
                    <p>Accesible dentro del mismo paquete</p>
                </div>
            </div>

            <h3>1.3 Tipos de Datos y Multiplicidad</h3>
            <p>UML permite especificar tipos de datos tanto primitivos como definidos por el usuario. La multiplicidad indica cuántas instancias de un tipo puede contener un atributo.</p>

            <table role="table">
                <tr role="row">
                    <th role="columnheader">Multiplicidad</th>
                    <th role="columnheader">Significado</th>
                    <th role="columnheader">Ejemplo de Uso</th>
                </tr>
                <tr role="row">
                    <td role="cell">1</td>
                    <td role="cell">Exactamente uno (por defecto)</td>
                    <td role="cell">nombre: String</td>
                </tr>
                <tr role="row">
                    <td role="cell">0..1</td>
                    <td role="cell">Cero o uno (opcional)</td>
                    <td role="cell">segundoNombre[0..1]: String</td>
                </tr>
                <tr role="row">
                    <td role="cell">*</td>
                    <td role="cell">Cero o más</td>
                    <td role="cell">emails[*]: String</td>
                </tr>
                <tr role="row">
                    <td role="cell">1..*</td>
                    <td role="cell">Uno o más</td>
                    <td role="cell">items[1..*]: LineaItem</td>
                </tr>
                <tr role="row">
                    <td role="cell">n..m</td>
                    <td role="cell">Entre n y m</td>
                    <td role="cell">calificaciones[1..5]: Integer</td>
                </tr>
            </table>

            <h3>1.4 Estereotipos, Etiquetas y Restricciones</h3>
            <p>UML proporciona mecanismos de extensión que permiten adaptar el lenguaje a dominios específicos sin modificar el metamodelo base.</p>

            <div class="concept-box">
                <h4>Mecanismos de Extensión:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Estereotipos:</strong> Extienden el vocabulario de UML (ej: «entity», «boundary», «control»)</li>
                    <li role="listitem"><strong>Valores etiquetados:</strong> Pares nombre-valor para propiedades adicionales</li>
                    <li role="listitem"><strong>Restricciones:</strong> Reglas que deben cumplirse, expresadas en OCL o lenguaje natural</li>
                </ul>
            </div>

            <p>La notación básica de UML proporciona un lenguaje visual rico y expresivo para modelar sistemas orientados a objetos. El dominio de estos elementos fundamentales es esencial para crear modelos precisos y comunicativos que sirvan como blueprint efectivo para el desarrollo de software.</p>
        </section>

        <!-- Sección 2: Relaciones entre Clases -->
        <section class="section">
            <h2>2. Relaciones entre Clases (1500 palabras)</h2>
            
            <p>Las relaciones entre clases son fundamentales para expresar cómo los objetos colaboran y se estructuran en un sistema. UML define seis tipos principales de relaciones, cada una con semántica y notación específicas.</p>

            <h3>2.1 Asociación</h3>
            <p>La asociación es la relación más general entre clases. Representa una conexión semántica entre instancias de las clases, indicando que los objetos de una clase conocen y pueden interactuar con objetos de otra clase.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 2: Tipos de Asociación</div>
                <svg width="700" height="400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Asociación simple -->
                    <rect x="20" y="20" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="80" y="50" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Empresa</text>
                    
                    <rect x="300" y="20" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="360" y="50" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Empleado</text>
                    
                    <line x1="140" y1="60" x2="300" y2="60" stroke="black" stroke-width="2"/>
                    <text x="200" y="50" text-anchor="middle" font-family="Arial" font-size="12">trabaja-para</text>
                    <text x="150" y="80" font-family="Arial" font-size="12">1</text>
                    <text x="280" y="80" font-family="Arial" font-size="12">*</text>
                    
                    <!-- Asociación navegable -->
                    <rect x="20" y="150" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="80" y="180" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Cliente</text>
                    
                    <rect x="300" y="150" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="360" y="180" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Pedido</text>
                    
                    <line x1="140" y1="190" x2="290" y2="190" stroke="black" stroke-width="2"/>
                    <polygon points="290,190 300,185 300,195" fill="black"/>
                    <text x="200" y="180" text-anchor="middle" font-family="Arial" font-size="12">realiza</text>
                    
                    <!-- Asociación reflexiva -->
                    <rect x="500" y="20" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="560" y="50" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Persona</text>
                    
                    <path d="M 620 40 Q 680 40 680 60 Q 680 80 620 80" fill="none" stroke="black" stroke-width="2"/>
                    <text x="650" y="30" font-family="Arial" font-size="12">padre</text>
                    <text x="650" y="95" font-family="Arial" font-size="12">hijo</text>
                    <text x="630" y="50" font-family="Arial" font-size="12">1</text>
                    <text x="630" y="75" font-family="Arial" font-size="12">*</text>
                </svg>
            </div>

            <h4>2.1.1 Elementos de una Asociación</h4>
            <div class="concept-box">
                <ul role="list">
                    <li role="listitem"><strong>Nombre de la asociación:</strong> Verbo o frase verbal que describe la relación</li>
                    <li role="listitem"><strong>Roles:</strong> Nombres que describen el papel de cada clase en la relación</li>
                    <li role="listitem"><strong>Multiplicidad:</strong> Número de instancias que pueden participar</li>
                    <li role="listitem"><strong>Navegabilidad:</strong> Dirección en la que se puede recorrer la asociación</li>
                    <li role="listitem"><strong>Calificadores:</strong> Atributos que reducen la multiplicidad efectiva</li>
                </ul>
            </div>

            <h4>2.1.2 Clases de Asociación</h4>
            <p>Cuando una asociación tiene atributos o comportamiento propio, se modela como una clase de asociación. Esto es común cuando la relación misma tiene información que no pertenece naturalmente a ninguna de las clases participantes.</p>

            <div class="example-box">
                <h4>Ejemplo: Clase de Asociación</h4>
                <p>En la relación entre Estudiante y Curso, la Inscripción es una clase de asociación que contiene la fecha de inscripción, la calificación final y el estado.</p>
            </div>

            <h3>2.2 Agregación</h3>
            <p>La agregación es una forma especial de asociación que representa una relación "todo-parte" débil. El "todo" puede existir sin las "partes" y viceversa. Se representa con un diamante vacío en el extremo del "todo".</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 3: Agregación</div>
                <svg width="400" height="150" xmlns="http://www.w3.org/2000/svg">
                    <rect x="20" y="40" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="80" y="70" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Universidad</text>
                    
                    <rect x="260" y="40" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="320" y="70" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Estudiante</text>
                    
                    <line x1="140" y1="80" x2="260" y2="80" stroke="black" stroke-width="2"/>
                    <polygon points="140,80 150,75 150,85 140,80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="150" y="70" font-family="Arial" font-size="12">1</text>
                    <text x="240" y="70" font-family="Arial" font-size="12">*</text>
                </svg>
            </div>

            <h3>2.3 Composición</h3>
            <p>La composición es una forma más fuerte de agregación donde las partes no pueden existir sin el todo. El ciclo de vida de las partes está ligado al del todo. Se representa con un diamante relleno.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 4: Composición</div>
                <svg width="400" height="150" xmlns="http://www.w3.org/2000/svg">
                    <rect x="20" y="40" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="80" y="70" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Pedido</text>
                    
                    <rect x="260" y="40" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="320" y="70" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">LineaPedido</text>
                    
                    <line x1="140" y1="80" x2="260" y2="80" stroke="black" stroke-width="2"/>
                    <polygon points="140,80 150,75 150,85 140,80" fill="black" stroke="black" stroke-width="2"/>
                    <text x="150" y="70" font-family="Arial" font-size="12">1</text>
                    <text x="240" y="70" font-family="Arial" font-size="12">1..*</text>
                </svg>
            </div>

            <div class="synoptic-table">
                <h4>Diferencias entre Agregación y Composición</h4>
                <table role="table">
                    <tr role="row">
                        <th role="columnheader">Aspecto</th>
                        <th role="columnheader">Agregación</th>
                        <th role="columnheader">Composición</th>
                    </tr>
                    <tr role="row">
                        <td role="cell">Fuerza de la relación</td>
                        <td role="cell">Débil ("usa-un")</td>
                        <td role="cell">Fuerte ("es-parte-de")</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Ciclo de vida</td>
                        <td role="cell">Independiente</td>
                        <td role="cell">Dependiente del todo</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Compartición</td>
                        <td role="cell">Las partes pueden ser compartidas</td>
                        <td role="cell">Las partes son exclusivas</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Ejemplo</td>
                        <td role="cell">Equipo-Jugador</td>
                        <td role="cell">Casa-Habitación</td>
                    </tr>
                </table>
            </div>

            <h3>2.4 Herencia (Generalización/Especialización)</h3>
            <p>La herencia representa una relación taxonómica entre una clase más general (superclase) y una más específica (subclase). La subclase hereda estructura y comportamiento de la superclase.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 5: Jerarquía de Herencia</div>
                <svg width="500" height="300" xmlns="http://www.w3.org/2000/svg">
                    <!-- Superclase -->
                    <rect x="190" y="20" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="250" y="50" text-anchor="middle" font-family="Arial" font-size="14" font-style="italic">Figura</text>
                    <text x="250" y="70" text-anchor="middle" font-family="Arial" font-size="12">+ area(): Double</text>
                    
                    <!-- Subclases -->
                    <rect x="50" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="110" y="210" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Circulo</text>
                    <text x="110" y="230" text-anchor="middle" font-family="Arial" font-size="12">- radio: Double</text>
                    
                    <rect x="190" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="250" y="210" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Rectangulo</text>
                    <text x="250" y="230" text-anchor="middle" font-family="Arial" font-size="12">- ancho: Double</text>
                    <text x="250" y="245" text-anchor="middle" font-family="Arial" font-size="12">- alto: Double</text>
                    
                    <rect x="330" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="390" y="210" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Triangulo</text>
                    <text x="390" y="230" text-anchor="middle" font-family="Arial" font-size="12">- base: Double</text>
                    <text x="390" y="245" text-anchor="middle" font-family="Arial" font-size="12">- altura: Double</text>
                    
                    <!-- Flechas de herencia -->
                    <line x1="110" y1="180" x2="230" y2="100" stroke="black" stroke-width="2"/>
                    <line x1="250" y1="180" x2="250" y2="100" stroke="black" stroke-width="2"/>
                    <line x1="390" y1="180" x2="270" y2="100" stroke="black" stroke-width="2"/>
                    
                    <!-- Punta de flecha -->
                    <polygon points="250,100 240,110 260,110" fill="white" stroke="black" stroke-width="2"/>
                </svg>
            </div>

            <h3>2.5 Dependencia</h3>
            <p>La dependencia es la relación más débil entre clases. Indica que una clase usa o depende de otra de forma temporal. Cambios en la clase independiente pueden afectar a la clase dependiente.</p>

            <div class="warning-box">
                <h4>Cuándo usar Dependencia:</h4>
                <ul role="list">
                    <li role="listitem">Una clase usa otra como parámetro en un método</li>
                    <li role="listitem">Una clase crea instancias locales de otra</li>
                    <li role="listitem">Una clase accede a elementos estáticos de otra</li>
                    <li role="listitem">El uso es temporal y no implica un atributo permanente</li>
                </ul>
            </div>

            <h3>2.6 Realización (Implementación de Interfaces)</h3>
            <p>La realización representa la relación entre una interfaz y las clases que la implementan. La clase realizadora debe proporcionar implementaciones concretas de todas las operaciones definidas en la interfaz.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 6: Realización de Interfaz</div>
                <svg width="400" height="200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Interfaz -->
                    <rect x="140" y="20" width="120" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="200" y="40" text-anchor="middle" font-family="Arial" font-size="12">«interface»</text>
                    <text x="200" y="60" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Ordenable</text>
                    
                    <!-- Clase implementadora -->
                    <rect x="140" y="140" width="120" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="200" y="170" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Producto</text>
                    
                    <!-- Flecha de realización (línea punteada) -->
                    <line x1="200" y1="140" x2="200" y2="80" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="200,80 190,90 210,90" fill="white" stroke="black" stroke-width="2"/>
                </svg>
            </div>

            <p>El dominio completo de estas relaciones es fundamental para crear modelos de clases expresivos y precisos. Cada tipo de relación comunica información semántica específica sobre cómo las clases colaboran y se estructuran en el sistema.</p>
        </section>

        <!-- Sección 3: Técnicas de Modelado -->
        <section class="section">
            <h2>3. Técnicas de Modelado (800 palabras)</h2>
            
            <p>El modelado efectivo de clases requiere más que conocer la notación; demanda técnicas sistemáticas para identificar, refinar y validar los elementos del modelo.</p>

            <h3>3.1 Identificación de Clases del Dominio</h3>
            <p>La identificación de clases es el primer paso crítico en el modelado orientado a objetos. Existen varias técnicas probadas para descubrir las clases candidatas en un dominio.</p>

            <h4>3.1.1 Análisis Lingüístico</h4>
            <div class="concept-box">
                <h4>Técnica de Sustantivos y Verbos:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Sustantivos →</strong> Clases candidatas o atributos</li>
                    <li role="listitem"><strong>Verbos →</strong> Métodos o asociaciones</li>
                    <li role="listitem"><strong>Adjetivos →</strong> Atributos o estados</li>
                </ul>
                <p>Analice las especificaciones de requisitos, casos de uso y documentación del dominio buscando estos elementos lingüísticos.</p>
            </div>

            <h4>3.1.2 Categorías de Clases</h4>
            <table role="table">
                <tr role="row">
                    <th role="columnheader">Categoría</th>
                    <th role="columnheader">Descripción</th>
                    <th role="columnheader">Ejemplos</th>
                </tr>
                <tr role="row">
                    <td role="cell">Cosas tangibles</td>
                    <td role="cell">Objetos físicos del dominio</td>
                    <td role="cell">Producto, Vehículo, Sensor</td>
                </tr>
                <tr role="row">
                    <td role="cell">Roles</td>
                    <td role="cell">Papeles desempeñados por personas</td>
                    <td role="cell">Cliente, Empleado, Administrador</td>
                </tr>
                <tr role="row">
                    <td role="cell">Eventos</td>
                    <td role="cell">Ocurrencias significativas</td>
                    <td role="cell">Venta, Reunión, Transacción</td>
                </tr>
                <tr role="row">
                    <td role="cell">Lugares</td>
                    <td role="cell">Ubicaciones relevantes</td>
                    <td role="cell">Tienda, Almacén, Oficina</td>
                </tr>
                <tr role="row">
                    <td role="cell">Conceptos</td>
                    <td role="cell">Ideas abstractas del dominio</td>
                    <td role="cell">Política, Estrategia, Contrato</td>
                </tr>
            </table>

            <h3>3.2 Análisis de Responsabilidades CRC</h3>
            <p>Las tarjetas CRC (Clase-Responsabilidad-Colaboración) son una técnica efectiva para descubrir y refinar clases durante sesiones de diseño colaborativo.</p>

            <div class="example-box">
                <h4>Ejemplo de Tarjeta CRC: Clase Pedido</h4>
                <div style="border: 2px solid #333; padding: 1rem; background: #fffacd;">
                    <h5 style="text-align: center; border-bottom: 1px solid #333; padding-bottom: 0.5rem;">Pedido</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div>
                            <h6>Responsabilidades:</h6>
                            <ul style="font-size: 0.9rem;">
                                <li role="listitem">Conocer items del pedido</li>
                                <li role="listitem">Calcular total</li>
                                <li role="listitem">Validar disponibilidad</li>
                                <li role="listitem">Generar factura</li>
                            </ul>
                        </div>
                        <div>
                            <h6>Colaboradores:</h6>
                            <ul style="font-size: 0.9rem;">
                                <li role="listitem">Cliente</li>
                                <li role="listitem">LineaPedido</li>
                                <li role="listitem">Inventario</li>
                                <li role="listitem">SistemaFacturacion</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <h3>3.3 Refinamiento Iterativo del Modelo</h3>
            <p>El modelado de clases es un proceso iterativo que requiere múltiples pasadas de refinamiento.</p>

            <h4>3.3.1 Criterios de Refinamiento</h4>
            <div class="synoptic-table">
                <h4>Lista de Verificación para Refinamiento:</h4>
                <ul role="list">
                    <li role="listitem">☐ <strong>Cohesión:</strong> ¿Cada clase tiene una responsabilidad única y bien definida?</li>
                    <li role="listitem">☐ <strong>Acoplamiento:</strong> ¿Se minimizan las dependencias entre clases?</li>
                    <li role="listitem">☐ <strong>Completitud:</strong> ¿Están representados todos los conceptos importantes del dominio?</li>
                    <li role="listitem">☐ <strong>Consistencia:</strong> ¿Los nombres y relaciones son coherentes?</li>
                    <li role="listitem">☐ <strong>Claridad:</strong> ¿El modelo es comprensible para los stakeholders?</li>
                </ul>
            </div>

            <h4>3.3.2 Técnicas de Refinamiento</h4>
            <ol role="list">
                <li role="listitem"><strong>Factorización:</strong> Extraer comportamiento común a superclases abstractas</li>
                <li role="listitem"><strong>Partición:</strong> Dividir clases con demasiadas responsabilidades</li>
                <li role="listitem"><strong>Agregación:</strong> Combinar clases muy acopladas con poca funcionalidad individual</li>
                <li role="listitem"><strong>Abstracción:</strong> Introducir interfaces para reducir dependencias concretas</li>
            </ol>

            <h3>3.4 Validación con Stakeholders</h3>
            <p>La validación del modelo con los expertos del dominio y stakeholders es crucial para asegurar que el modelo refleja correctamente la realidad del negocio.</p>

            <div class="warning-box">
                <h4>Estrategias de Validación:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Walkthroughs:</strong> Recorrer escenarios usando el modelo</li>
                    <li role="listitem"><strong>Prototipos:</strong> Crear implementaciones parciales para validar conceptos</li>
                    <li role="listitem"><strong>Revisiones formales:</strong> Sesiones estructuradas con checklists</li>
                    <li role="listitem"><strong>Mapeo con casos de uso:</strong> Verificar que el modelo soporta todos los casos de uso</li>
                </ul>
            </div>

            <p>El éxito en el modelado de clases depende de la aplicación sistemática de estas técnicas, combinada con la experiencia y el conocimiento profundo del dominio. La práctica constante y la reflexión sobre los resultados son esenciales para desarrollar la intuición necesaria para crear modelos efectivos.</p>
        </section>

        <!-- Sección 4: Patrones en UML -->
        <section class="section">
            <h2>4. Patrones de Diseño en UML (2000 palabras)</h2>
            
            <p>Los patrones de diseño representan soluciones probadas a problemas recurrentes en el desarrollo de software. UML proporciona la notación perfecta para documentar y comunicar estos patrones de manera visual y precisa. En esta sección, exploraremos en detalle los patrones más importantes y su representación en UML.</p>

            <h3>4.1 Patrones Creacionales</h3>
            
            <h4>4.1.1 Patrón Singleton</h4>
            <p>El patrón Singleton garantiza que una clase tenga solo una instancia y proporciona un punto de acceso global a ella. Es uno de los patrones más utilizados cuando necesitamos controlar el acceso a recursos compartidos como conexiones a base de datos, archivos de configuración o pools de objetos.</p>

            <div class="concept-box">
                <h4>Problema que resuelve:</h4>
                <ul role="list">
                    <li role="listitem">Necesidad de exactamente una instancia de una clase</li>
                    <li role="listitem">Acceso global controlado a esa instancia</li>
                    <li role="listitem">Control sobre cuándo se crea la instancia (lazy initialization)</li>
                </ul>
            </div>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 7: Patrón Singleton Detallado</div>
                <svg width="400" height="250" xmlns="http://www.w3.org/2000/svg">
                    <rect x="50" y="20" width="300" height="220" fill="white" stroke="black" stroke-width="2"/>
                    <line x1="50" y1="60" x2="350" y2="60" stroke="black" stroke-width="1"/>
                    <line x1="50" y1="120" x2="350" y2="120" stroke="black" stroke-width="1"/>
                    
                    <text x="200" y="45" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">«Singleton»</text>
                    <text x="200" y="45" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" dy="15">ConfiguracionSistema</text>
                    
                    <text x="60" y="80" font-family="Arial" font-size="12" text-decoration="underline">- instancia: ConfiguracionSistema</text>
                    <text x="60" y="95" font-family="Arial" font-size="12">- propiedades: Map&lt;String, String&gt;</text>
                    <text x="60" y="110" font-family="Arial" font-size="12">- archivoConfig: String</text>
                    
                    <text x="60" y="140" font-family="Arial" font-size="12">- ConfiguracionSistema()</text>
                    <text x="60" y="155" font-family="Arial" font-size="12" text-decoration="underline">+ getInstance(): ConfiguracionSistema</text>
                    <text x="60" y="170" font-family="Arial" font-size="12">+ getPropiedad(clave: String): String</text>
                    <text x="60" y="185" font-family="Arial" font-size="12">+ setPropiedad(clave: String, valor: String)</text>
                    <text x="60" y="200" font-family="Arial" font-size="12">+ cargarConfiguracion(archivo: String)</text>
                    <text x="60" y="215" font-family="Arial" font-size="12">+ guardarConfiguracion()</text>
                    <text x="60" y="230" font-family="Arial" font-size="12">- inicializar()</text>
                </svg>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PYTHON</span>
                    <span class="code-filename">configuracion_sistema.py</span>
                </div>
                <pre><span class="keyword">class</span> <span class="class-name">ConfiguracionSistema</span>:
    <span class="string">"""Implementación del patrón Singleton para configuración global"""</span>
    
    <span class="comment"># Variable de clase para almacenar la única instancia</span>
    <span class="self">_instancia</span> = <span class="builtin">None</span>
    <span class="self">_lock</span> = threading.Lock()  <span class="comment"># Para thread safety</span>
    
    <span class="keyword">def</span> <span class="function">__new__</span>(<span class="self">cls</span>):
        <span class="string">"""Controla la creación de instancias"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">cls._instancia</span>:
            <span class="keyword">with</span> <span class="self">cls._lock</span>:
                <span class="comment"># Double-check locking pattern</span>
                <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">cls._instancia</span>:
                    <span class="self">cls._instancia</span> = <span class="builtin">super</span>().__new__(<span class="self">cls</span>)
        <span class="keyword">return</span> <span class="self">cls._instancia</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>):
        <span class="string">"""Inicializa la configuración solo una vez"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="builtin">hasattr</span>(<span class="self">self</span>, <span class="string">'_initialized'</span>):
            <span class="self">self._propiedades</span> = {}
            <span class="self">self._archivo_config</span> = <span class="string">'config.json'</span>
            <span class="self">self._initialized</span> = <span class="builtin">True</span>
            <span class="self">self._cargar_configuracion</span>()
    
    <span class="keyword">def</span> <span class="function">get_propiedad</span>(<span class="self">self</span>, <span class="parameter">clave</span>: <span class="builtin">str</span>) -> <span class="builtin">str</span>:
        <span class="string">"""Obtiene una propiedad de configuración"""</span>
        <span class="keyword">return</span> <span class="self">self._propiedades</span>.get(<span class="parameter">clave</span>, <span class="string">''</span>)
    
    <span class="keyword">def</span> <span class="function">set_propiedad</span>(<span class="self">self</span>, <span class="parameter">clave</span>: <span class="builtin">str</span>, <span class="parameter">valor</span>: <span class="builtin">str</span>):
        <span class="string">"""Establece una propiedad de configuración"""</span>
        <span class="self">self._propiedades</span>[<span class="parameter">clave</span>] = <span class="parameter">valor</span>
        <span class="self">self._guardar_configuracion</span>()
    
    <span class="keyword">def</span> <span class="function">_cargar_configuracion</span>(<span class="self">self</span>):
        <span class="string">"""Carga la configuración desde archivo"""</span>
        <span class="keyword">try</span>:
            <span class="keyword">import</span> json
            <span class="keyword">with</span> <span class="builtin">open</span>(<span class="self">self._archivo_config</span>, <span class="string">'r'</span>) <span class="keyword">as</span> <span class="parameter">f</span>:
                <span class="self">self._propiedades</span> = json.load(<span class="parameter">f</span>)
        <span class="keyword">except</span> <span class="builtin">FileNotFoundError</span>:
            <span class="comment"># Configuración por defecto</span>
            <span class="self">self._propiedades</span> = {
                <span class="string">'database_url'</span>: <span class="string">'postgresql://localhost/myapp'</span>,
                <span class="string">'debug_mode'</span>: <span class="string">'False'</span>,
                <span class="string">'max_connections'</span>: <span class="string">'100'</span>
            }

<span class="comment"># Uso del Singleton</span>
<span class="parameter">config1</span> = <span class="class-name">ConfiguracionSistema</span>()
<span class="parameter">config2</span> = <span class="class-name">ConfiguracionSistema</span>()

<span class="builtin">print</span>(<span class="parameter">config1</span> <span class="keyword">is</span> <span class="parameter">config2</span>)  <span class="comment"># True - misma instancia</span>
<span class="parameter">config1</span>.set_propiedad(<span class="string">'api_key'</span>, <span class="string">'abc123'</span>)
<span class="builtin">print</span>(<span class="parameter">config2</span>.get_propiedad(<span class="string">'api_key'</span>))  <span class="comment"># 'abc123'</span></pre>
            </div>

            <div class="warning-box">
                <h4>Consideraciones importantes del Singleton:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Thread Safety:</strong> En ambientes multihilo, debe sincronizarse el acceso</li>
                    <li role="listitem"><strong>Testing:</strong> Puede dificultar las pruebas unitarias por su naturaleza global</li>
                    <li role="listitem"><strong>Acoplamiento:</strong> Crea dependencias ocultas en el código</li>
                    <li role="listitem"><strong>Herencia:</strong> Es difícil extender un Singleton</li>
                </ul>
            </div>

            <h4>4.1.2 Patrón Factory Method</h4>
            <p>El patrón Factory Method define una interfaz para crear objetos, pero permite a las subclases decidir qué clase instanciar. Este patrón es fundamental cuando necesitamos delegar la creación de objetos a las subclases, promoviendo el principio de inversión de dependencias.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 8: Patrón Factory Method Completo</div>
                <svg width="700" height="400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Creator -->
                    <rect x="50" y="20" width="200" height="120" fill="white" stroke="black" stroke-width="2"/>
                    <text x="150" y="50" text-anchor="middle" font-family="Arial" font-size="14" font-style="italic">DocumentoCreator</text>
                    <line x1="50" y1="60" x2="250" y2="60" stroke="black" stroke-width="1"/>
                    <text x="60" y="80" font-family="Arial" font-size="12">+ crearDocumento(): Documento</text>
                    <text x="60" y="95" font-family="Arial" font-size="12" font-style="italic">+ factoryMethod(): Documento</text>
                    <text x="60" y="110" font-family="Arial" font-size="12">+ abrirDocumento()</text>
                    <text x="60" y="125" font-family="Arial" font-size="12">+ guardarDocumento()</text>
                    
                    <!-- ConcreteCreator1 -->
                    <rect x="20" y="200" width="130" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="85" y="230" text-anchor="middle" font-family="Arial" font-size="14">PDFCreator</text>
                    <line x1="20" y1="240" x2="150" y2="240" stroke="black" stroke-width="1"/>
                    <text x="30" y="260" font-family="Arial" font-size="11">+ factoryMethod():</text>
                    <text x="40" y="275" font-family="Arial" font-size="11">Documento</text>
                    
                    <!-- ConcreteCreator2 -->
                    <rect x="170" y="200" width="130" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="235" y="230" text-anchor="middle" font-family="Arial" font-size="14">WordCreator</text>
                    <line x1="170" y1="240" x2="300" y2="240" stroke="black" stroke-width="1"/>
                    <text x="180" y="260" font-family="Arial" font-size="11">+ factoryMethod():</text>
                    <text x="190" y="275" font-family="Arial" font-size="11">Documento</text>
                    
                    <!-- Product -->
                    <rect x="400" y="20" width="150" height="100" fill="white" stroke="black" stroke-width="2"/>
                    <text x="475" y="40" text-anchor="middle" font-family="Arial" font-size="12">«interface»</text>
                    <text x="475" y="60" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Documento</text>
                    <line x1="400" y1="70" x2="550" y2="70" stroke="black" stroke-width="1"/>
                    <text x="410" y="85" font-family="Arial" font-size="12">+ abrir()</text>
                    <text x="410" y="100" font-family="Arial" font-size="12">+ guardar()</text>
                    <text x="410" y="115" font-family="Arial" font-size="12">+ cerrar()</text>
                    
                    <!-- ConcreteProduct1 -->
                    <rect x="350" y="200" width="100" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="400" y="230" text-anchor="middle" font-family="Arial" font-size="14">PDF</text>
                    
                    <!-- ConcreteProduct2 -->
                    <rect x="500" y="200" width="100" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="550" y="230" text-anchor="middle" font-family="Arial" font-size="14">Word</text>
                    
                    <!-- Relations -->
                    <line x1="85" y1="200" x2="150" y2="140" stroke="black" stroke-width="2"/>
                    <line x1="235" y1="200" x2="150" y2="140" stroke="black" stroke-width="2"/>
                    <polygon points="150,140 140,150 160,150" fill="white" stroke="black" stroke-width="2"/>
                    
                    <line x1="400" y1="200" x2="475" y2="120" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="550" y1="200" x2="475" y2="120" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="475,120 465,130 485,130" fill="white" stroke="black" stroke-width="2"/>
                    
                    <!-- Dependency -->
                    <line x1="250" y1="80" x2="400" y2="80" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="400,80 390,75 390,85" fill="black"/>
                    <text x="320" y="70" font-family="Arial" font-size="11">«create»</text>
                </svg>
            </div>

            <div class="example-box">
                <h4>Ejemplo de Uso:</h4>
                <p>Un sistema de gestión documental que necesita crear diferentes tipos de documentos (PDF, Word, Excel) sin que el código cliente conozca las clases concretas. El Factory Method permite agregar nuevos tipos de documentos sin modificar el código existente.</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PYTHON</span>
                    <span class="code-filename">factory_documentos.py</span>
                </div>
                <pre><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="comment"># Interfaz Product</span>
<span class="keyword">class</span> <span class="class-name">Documento</span>(ABC):
    <span class="string">"""Interfaz abstracta para todos los documentos"""</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">abrir</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">guardar</span>(<span class="self">self</span>, <span class="parameter">contenido</span>: <span class="builtin">str</span>) -> <span class="builtin">bool</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">cerrar</span>(<span class="self">self</span>) -> <span class="builtin">None</span>:
        <span class="keyword">pass</span>

<span class="comment"># Concrete Products</span>
<span class="keyword">class</span> <span class="class-name">DocumentoPDF</span>(<span class="class-name">Documento</span>):
    <span class="string">"""Implementación concreta para documentos PDF"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>):
        <span class="self">self.nombre</span> = <span class="parameter">nombre</span>
        <span class="self">self.contenido</span> = <span class="string">""</span>
        <span class="self">self.abierto</span> = <span class="builtin">False</span>
    
    <span class="keyword">def</span> <span class="function">abrir</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="self">self.abierto</span> = <span class="builtin">True</span>
        <span class="builtin">print</span>(<span class="string">f"📄 Abriendo PDF: {<span class="self">self.nombre</span>}.pdf"</span>)
        <span class="keyword">return</span> <span class="self">self.contenido</span>
    
    <span class="keyword">def</span> <span class="function">guardar</span>(<span class="self">self</span>, <span class="parameter">contenido</span>: <span class="builtin">str</span>) -> <span class="builtin">bool</span>:
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self.abierto</span>:
            <span class="keyword">return</span> <span class="builtin">False</span>
        <span class="self">self.contenido</span> = <span class="parameter">contenido</span>
        <span class="builtin">print</span>(<span class="string">f"💾 Guardando PDF con {<span class="builtin">len</span>(<span class="parameter">contenido</span>)} caracteres"</span>)
        <span class="keyword">return</span> <span class="builtin">True</span>
    
    <span class="keyword">def</span> <span class="function">cerrar</span>(<span class="self">self</span>) -> <span class="builtin">None</span>:
        <span class="self">self.abierto</span> = <span class="builtin">False</span>
        <span class="builtin">print</span>(<span class="string">f"❌ Cerrando PDF: {<span class="self">self.nombre</span>}.pdf"</span>)

<span class="keyword">class</span> <span class="class-name">DocumentoWord</span>(<span class="class-name">Documento</span>):
    <span class="string">"""Implementación concreta para documentos Word"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>):
        <span class="self">self.nombre</span> = <span class="parameter">nombre</span>
        <span class="self">self.contenido</span> = <span class="string">""</span>
        <span class="self">self.abierto</span> = <span class="builtin">False</span>
        <span class="self">self.metadata</span> = {<span class="string">'created'</span>: datetime.now()}
    
    <span class="keyword">def</span> <span class="function">abrir</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="self">self.abierto</span> = <span class="builtin">True</span>
        <span class="builtin">print</span>(<span class="string">f"📝 Abriendo Word: {<span class="self">self.nombre</span>}.docx"</span>)
        <span class="keyword">return</span> <span class="self">self.contenido</span>
    
    <span class="keyword">def</span> <span class="function">guardar</span>(<span class="self">self</span>, <span class="parameter">contenido</span>: <span class="builtin">str</span>) -> <span class="builtin">bool</span>:
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self.abierto</span>:
            <span class="keyword">return</span> <span class="builtin">False</span>
        <span class="self">self.contenido</span> = <span class="parameter">contenido</span>
        <span class="self">self.metadata</span>[<span class="string">'modified'</span>] = datetime.now()
        <span class="builtin">print</span>(<span class="string">f"💾 Guardando Word con metadata actualizada"</span>)
        <span class="keyword">return</span> <span class="builtin">True</span>
    
    <span class="keyword">def</span> <span class="function">cerrar</span>(<span class="self">self</span>) -> <span class="builtin">None</span>:
        <span class="self">self.abierto</span> = <span class="builtin">False</span>
        <span class="builtin">print</span>(<span class="string">f"❌ Cerrando Word: {<span class="self">self.nombre</span>}.docx"</span>)

<span class="comment"># Abstract Creator</span>
<span class="keyword">class</span> <span class="class-name">DocumentoCreator</span>(ABC):
    <span class="string">"""Clase abstracta Creator"""</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">factory_method</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>) -> <span class="class-name">Documento</span>:
        <span class="string">"""Factory method que las subclases deben implementar"""</span>
        <span class="keyword">pass</span>
    
    <span class="keyword">def</span> <span class="function">crear_documento</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>) -> <span class="class-name">Documento</span>:
        <span class="string">"""Método template que usa el factory method"""</span>
        <span class="comment"># Llamar al factory method</span>
        <span class="parameter">documento</span> = <span class="self">self</span>.factory_method(<span class="parameter">nombre</span>)
        
        <span class="comment"># Lógica común para todos los documentos</span>
        <span class="builtin">print</span>(<span class="string">f"✨ Creando nuevo documento: {<span class="parameter">nombre</span>}"</span>)
        <span class="parameter">documento</span>.abrir()
        <span class="parameter">documento</span>.guardar(<span class="string">"Contenido inicial"</span>)
        
        <span class="keyword">return</span> <span class="parameter">documento</span>

<span class="comment"># Concrete Creators</span>
<span class="keyword">class</span> <span class="class-name">PDFCreator</span>(<span class="class-name">DocumentoCreator</span>):
    <span class="string">"""Creator concreto para documentos PDF"""</span>
    
    <span class="keyword">def</span> <span class="function">factory_method</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>) -> <span class="class-name">Documento</span>:
        <span class="keyword">return</span> <span class="class-name">DocumentoPDF</span>(<span class="parameter">nombre</span>)

<span class="keyword">class</span> <span class="class-name">WordCreator</span>(<span class="class-name">DocumentoCreator</span>):
    <span class="string">"""Creator concreto para documentos Word"""</span>
    
    <span class="keyword">def</span> <span class="function">factory_method</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>) -> <span class="class-name">Documento</span>:
        <span class="keyword">return</span> <span class="class-name">DocumentoWord</span>(<span class="parameter">nombre</span>)

<span class="comment"># Código cliente</span>
<span class="keyword">def</span> <span class="function">procesar_documento</span>(<span class="parameter">creator</span>: <span class="class-name">DocumentoCreator</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>):
    <span class="string">"""El cliente trabaja con creators sin conocer las clases concretas"""</span>
    <span class="parameter">doc</span> = <span class="parameter">creator</span>.crear_documento(<span class="parameter">nombre</span>)
    <span class="parameter">doc</span>.guardar(<span class="string">"Este es el contenido del documento"</span>)
    <span class="parameter">doc</span>.cerrar()

<span class="comment"># Uso del patrón</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="comment"># El cliente puede trabajar con cualquier creator</span>
    <span class="parameter">pdf_creator</span> = <span class="class-name">PDFCreator</span>()
    <span class="parameter">word_creator</span> = <span class="class-name">WordCreator</span>()
    
    procesar_documento(<span class="parameter">pdf_creator</span>, <span class="string">"reporte_ventas"</span>)
    <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">50</span>)
    procesar_documento(<span class="parameter">word_creator</span>, <span class="string">"carta_cliente"</span>)</pre>
            </div>

            <h3>4.2 Patrones Estructurales</h3>

            <h4>4.2.1 Patrón Decorator</h4>
            <p>El patrón Decorator permite agregar responsabilidades a objetos de forma dinámica. Proporciona una alternativa flexible a la herencia para extender funcionalidad.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 9: Patrón Decorator - Sistema de Cafetería</div>
                <svg width="700" height="450" xmlns="http://www.w3.org/2000/svg">
                    <!-- Component -->
                    <rect x="250" y="20" width="150" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="325" y="40" text-anchor="middle" font-family="Arial" font-size="12">«interface»</text>
                    <text x="325" y="60" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Bebida</text>
                    <line x1="250" y1="70" x2="400" y2="70" stroke="black" stroke-width="1"/>
                    <text x="260" y="85" font-family="Arial" font-size="12">+ getDescripcion(): String</text>
                    <text x="260" y="95" font-family="Arial" font-size="12">+ getCosto(): double</text>
                    
                    <!-- ConcreteComponent -->
                    <rect x="50" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="110" y="210" text-anchor="middle" font-family="Arial" font-size="14">CafeSimple</text>
                    <line x1="50" y1="220" x2="170" y2="220" stroke="black" stroke-width="1"/>
                    <text x="60" y="235" font-family="Arial" font-size="11">- descripcion: String</text>
                    <text x="60" y="250" font-family="Arial" font-size="11">- costo: double</text>
                    
                    <!-- Decorator -->
                    <rect x="250" y="180" width="150" height="100" fill="white" stroke="black" stroke-width="2"/>
                    <text x="325" y="210" text-anchor="middle" font-family="Arial" font-size="14" font-style="italic">DecoradorBebida</text>
                    <line x1="250" y1="220" x2="400" y2="220" stroke="black" stroke-width="1"/>
                    <text x="260" y="235" font-family="Arial" font-size="12"># bebida: Bebida</text>
                    <text x="260" y="255" font-family="Arial" font-size="12">+ getDescripcion()</text>
                    <text x="260" y="270" font-family="Arial" font-size="12">+ getCosto()</text>
                    
                    <!-- ConcreteDecorators -->
                    <rect x="150" y="350" width="100" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="200" y="380" text-anchor="middle" font-family="Arial" font-size="14">Leche</text>
                    
                    <rect x="280" y="350" width="100" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="330" y="380" text-anchor="middle" font-family="Arial" font-size="14">Azucar</text>
                    
                    <rect x="410" y="350" width="100" height="60" fill="white" stroke="black" stroke-width="2"/>
                    <text x="460" y="380" text-anchor="middle" font-family="Arial" font-size="14">Crema</text>
                    
                    <!-- Relations -->
                    <line x1="110" y1="180" x2="325" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="325" y1="180" x2="325" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="325,100 315,110 335,110" fill="white" stroke="black" stroke-width="2"/>
                    
                    <line x1="200" y1="350" x2="325" y2="280" stroke="black" stroke-width="2"/>
                    <line x1="330" y1="350" x2="325" y2="280" stroke="black" stroke-width="2"/>
                    <line x1="460" y1="350" x2="325" y2="280" stroke="black" stroke-width="2"/>
                    <polygon points="325,280 315,290 335,290" fill="white" stroke="black" stroke-width="2"/>
                    
                    <!-- Aggregation -->
                    <line x1="250" y1="230" x2="200" y2="230" stroke="black" stroke-width="2"/>
                    <line x1="200" y1="230" x2="200" y2="60" stroke="black" stroke-width="2"/>
                    <line x1="200" y1="60" x2="250" y2="60" stroke="black" stroke-width="2"/>
                    <polygon points="250,60 240,55 240,65" fill="white" stroke="black" stroke-width="2"/>
                </svg>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PYTHON</span>
                    <span class="code-filename">decorator_cafe.py</span>
                </div>
                <pre><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod

<span class="comment"># Component Interface</span>
<span class="keyword">class</span> <span class="class-name">Bebida</span>(ABC):
    <span class="string">"""Interfaz para todas las bebidas"""</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">pass</span>

<span class="comment"># Concrete Component</span>
<span class="keyword">class</span> <span class="class-name">CafeSimple</span>(<span class="class-name">Bebida</span>):
    <span class="string">"""Café base sin decoraciones"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>):
        <span class="self">self._descripcion</span> = <span class="string">"Café Simple"</span>
        <span class="self">self._costo</span> = <span class="number">2.0</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="self">self._descripcion</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._costo</span>

<span class="keyword">class</span> <span class="class-name">Espresso</span>(<span class="class-name">Bebida</span>):
    <span class="string">"""Espresso base sin decoraciones"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>):
        <span class="self">self._descripcion</span> = <span class="string">"Espresso"</span>
        <span class="self">self._costo</span> = <span class="number">2.5</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="self">self._descripcion</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._costo</span>

<span class="comment"># Base Decorator</span>
<span class="keyword">class</span> <span class="class-name">DecoradorBebida</span>(<span class="class-name">Bebida</span>):
    <span class="string">"""Clase base abstracta para todos los decoradores"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">bebida</span>: <span class="class-name">Bebida</span>):
        <span class="self">self._bebida</span> = <span class="parameter">bebida</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">pass</span>

<span class="comment"># Concrete Decorators</span>
<span class="keyword">class</span> <span class="class-name">Leche</span>(<span class="class-name">DecoradorBebida</span>):
    <span class="string">"""Decorador que añade leche"""</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="string">f"{<span class="self">self._bebida</span>.get_descripcion()}, con Leche"</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._bebida</span>.get_costo() + <span class="number">0.5</span>

<span class="keyword">class</span> <span class="class-name">Azucar</span>(<span class="class-name">DecoradorBebida</span>):
    <span class="string">"""Decorador que añade azúcar"""</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="string">f"{<span class="self">self._bebida</span>.get_descripcion()}, con Azúcar"</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._bebida</span>.get_costo() + <span class="number">0.2</span>

<span class="keyword">class</span> <span class="class-name">Crema</span>(<span class="class-name">DecoradorBebida</span>):
    <span class="string">"""Decorador que añade crema"""</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="string">f"{<span class="self">self._bebida</span>.get_descripcion()}, con Crema"</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._bebida</span>.get_costo() + <span class="number">0.8</span>

<span class="keyword">class</span> <span class="class-name">Caramelo</span>(<span class="class-name">DecoradorBebida</span>):
    <span class="string">"""Decorador que añade jarabe de caramelo"""</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="string">f"{<span class="self">self._bebida</span>.get_descripcion()}, con Caramelo"</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._bebida</span>.get_costo() + <span class="number">0.6</span>

<span class="keyword">class</span> <span class="class-name">ExtraShot</span>(<span class="class-name">DecoradorBebida</span>):
    <span class="string">"""Decorador que añade un shot extra de café"""</span>
    
    <span class="keyword">def</span> <span class="function">get_descripcion</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="string">f"{<span class="self">self._bebida</span>.get_descripcion()}, con Shot Extra"</span>
    
    <span class="keyword">def</span> <span class="function">get_costo</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._bebida</span>.get_costo() + <span class="number">1.0</span>

<span class="comment"># Función auxiliar para mostrar la bebida</span>
<span class="keyword">def</span> <span class="function">mostrar_bebida</span>(<span class="parameter">bebida</span>: <span class="class-name">Bebida</span>):
    <span class="string">"""Muestra la descripción y costo de una bebida"""</span>
    <span class="builtin">print</span>(<span class="string">f"☕ {<span class="parameter">bebida</span>.get_descripcion()}"</span>)
    <span class="builtin">print</span>(<span class="string">f"💰 Costo: ${<span class="parameter">bebida</span>.get_costo():.2f}"</span>)
    <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">50</span>)

<span class="comment"># Uso del patrón Decorator</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="builtin">print</span>(<span class="string">"=== CAFETERÍA - SISTEMA DE PEDIDOS ==="</span>)
    <span class="builtin">print</span>()
    
    <span class="comment"># Bebida simple</span>
    <span class="parameter">bebida1</span> = <span class="class-name">CafeSimple</span>()
    mostrar_bebida(<span class="parameter">bebida1</span>)
    
    <span class="comment"># Café con leche y azúcar</span>
    <span class="parameter">bebida2</span> = <span class="class-name">CafeSimple</span>()
    <span class="parameter">bebida2</span> = <span class="class-name">Leche</span>(<span class="parameter">bebida2</span>)
    <span class="parameter">bebida2</span> = <span class="class-name">Azucar</span>(<span class="parameter">bebida2</span>)
    mostrar_bebida(<span class="parameter">bebida2</span>)
    
    <span class="comment"># Espresso con doble decoración</span>
    <span class="parameter">bebida3</span> = <span class="class-name">Espresso</span>()
    <span class="parameter">bebida3</span> = <span class="class-name">Crema</span>(<span class="parameter">bebida3</span>)
    <span class="parameter">bebida3</span> = <span class="class-name">Caramelo</span>(<span class="parameter">bebida3</span>)
    <span class="parameter">bebida3</span> = <span class="class-name">ExtraShot</span>(<span class="parameter">bebida3</span>)
    mostrar_bebida(<span class="parameter">bebida3</span>)
    
    <span class="comment"># Bebida compleja con múltiples decoradores</span>
    <span class="parameter">bebida4</span> = <span class="class-name">CafeSimple</span>()
    <span class="parameter">bebida4</span> = <span class="class-name">Leche</span>(<span class="parameter">bebida4</span>)
    <span class="parameter">bebida4</span> = <span class="class-name">Leche</span>(<span class="parameter">bebida4</span>)  <span class="comment"># Doble leche</span>
    <span class="parameter">bebida4</span> = <span class="class-name">Azucar</span>(<span class="parameter">bebida4</span>)
    <span class="parameter">bebida4</span> = <span class="class-name">Crema</span>(<span class="parameter">bebida4</span>)
    <span class="parameter">bebida4</span> = <span class="class-name">Caramelo</span>(<span class="parameter">bebida4</span>)
    mostrar_bebida(<span class="parameter">bebida4</span>)</pre>
            </div>

            <h3>4.3 Patrones de Comportamiento</h3>

            <h4>4.3.1 Patrón Observer</h4>
            <p>El patrón Observer define una dependencia uno-a-muchos entre objetos, de modo que cuando un objeto cambia su estado, todos sus dependientes son notificados y actualizados automáticamente. Es fundamental en la implementación del patrón MVC y sistemas reactivos.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 10: Patrón Observer - Sistema de Notificaciones</div>
                <svg width="700" height="400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Subject Interface -->
                    <rect x="20" y="20" width="200" height="120" fill="white" stroke="black" stroke-width="2"/>
                    <text x="120" y="40" text-anchor="middle" font-family="Arial" font-size="12">«interface»</text>
                    <text x="120" y="60" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Subject</text>
                    <line x1="20" y1="70" x2="220" y2="70" stroke="black" stroke-width="1"/>
                    <text x="25" y="85" font-family="Arial" font-size="11">+ attach(observer: Observer)</text>
                    <text x="25" y="100" font-family="Arial" font-size="11">+ detach(observer: Observer)</text>
                    <text x="25" y="115" font-family="Arial" font-size="11">+ notify()</text>
                    <text x="25" y="130" font-family="Arial" font-size="11">+ getState(): Estado</text>
                    
                    <!-- Observer Interface -->
                    <rect x="350" y="20" width="200" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="450" y="40" text-anchor="middle" font-family="Arial" font-size="12">«interface»</text>
                    <text x="450" y="60" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Observer</text>
                    <line x1="350" y1="70" x2="550" y2="70" stroke="black" stroke-width="1"/>
                    <text x="355" y="90" font-family="Arial" font-size="11">+ update(subject: Subject)</text>
                    
                    <!-- Concrete Subject -->
                    <rect x="20" y="200" width="200" height="120" fill="white" stroke="black" stroke-width="2"/>
                    <text x="120" y="230" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">StockPrice</text>
                    <line x1="20" y1="240" x2="220" y2="240" stroke="black" stroke-width="1"/>
                    <text x="25" y="255" font-family="Arial" font-size="11">- observers: List&lt;Observer&gt;</text>
                    <text x="25" y="270" font-family="Arial" font-size="11">- symbol: String</text>
                    <text x="25" y="285" font-family="Arial" font-size="11">- price: double</text>
                    <text x="25" y="300" font-family="Arial" font-size="11">+ setPrice(price: double)</text>
                    <text x="25" y="315" font-family="Arial" font-size="11">- notifyObservers()</text>
                    
                    <!-- Concrete Observers -->
                    <rect x="300" y="200" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="360" y="230" text-anchor="middle" font-family="Arial" font-size="14">InvestorApp</text>
                    <line x1="300" y1="240" x2="420" y2="240" stroke="black" stroke-width="1"/>
                    <text x="305" y="260" font-family="Arial" font-size="11">+ update(subject)</text>
                    <text x="305" y="275" font-family="Arial" font-size="11">+ display()</text>
                    
                    <rect x="450" y="200" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="510" y="230" text-anchor="middle" font-family="Arial" font-size="14">NewsAlert</text>
                    <line x1="450" y1="240" x2="570" y2="240" stroke="black" stroke-width="1"/>
                    <text x="455" y="260" font-family="Arial" font-size="11">+ update(subject)</text>
                    <text x="455" y="275" font-family="Arial" font-size="11">+ sendAlert()</text>
                    
                    <!-- Relations -->
                    <line x1="120" y1="200" x2="120" y2="140" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="120,140 110,150 130,150" fill="white" stroke="black" stroke-width="2"/>
                    
                    <line x1="360" y1="200" x2="450" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="510" y1="200" x2="450" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="450,100 440,110 460,110" fill="white" stroke="black" stroke-width="2"/>
                    
                    <line x1="220" y1="60" x2="350" y2="60" stroke="black" stroke-width="2"/>
                    <text x="270" y="50" font-family="Arial" font-size="11">notifica</text>
                    <text x="330" y="75" font-family="Arial" font-size="11">*</text>
                </svg>
            </div>

            <div class="pattern-card">
                <h5>Secuencia de Notificación:</h5>
                <ol role="list">
                    <li role="listitem">El Subject cambia su estado interno</li>
                    <li role="listitem">El Subject llama a notify() para todos sus observers</li>
                    <li role="listitem">Cada Observer llama a getState() del Subject</li>
                    <li role="listitem">Cada Observer actualiza su propia vista/estado</li>
                </ol>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PYTHON</span>
                    <span class="code-filename">observer_stock.py</span>
                </div>
                <pre><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod
<span class="keyword">from</span> typing <span class="keyword">import</span> List
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="comment"># Subject Interface</span>
<span class="keyword">class</span> <span class="class-name">Subject</span>(ABC):
    <span class="string">"""Interfaz para los sujetos observables"""</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">attach</span>(<span class="self">self</span>, <span class="parameter">observer</span>: <span class="string">'Observer'</span>) -> <span class="builtin">None</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">detach</span>(<span class="self">self</span>, <span class="parameter">observer</span>: <span class="string">'Observer'</span>) -> <span class="builtin">None</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">notify</span>(<span class="self">self</span>) -> <span class="builtin">None</span>:
        <span class="keyword">pass</span>

<span class="comment"># Observer Interface</span>
<span class="keyword">class</span> <span class="class-name">Observer</span>(ABC):
    <span class="string">"""Interfaz para los observadores"""</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">update</span>(<span class="self">self</span>, <span class="parameter">subject</span>: <span class="class-name">Subject</span>) -> <span class="builtin">None</span>:
        <span class="keyword">pass</span>

<span class="comment"># Concrete Subject</span>
<span class="keyword">class</span> <span class="class-name">StockPrice</span>(<span class="class-name">Subject</span>):
    <span class="string">"""Sujeto concreto que mantiene el precio de una acción"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">symbol</span>: <span class="builtin">str</span>, <span class="parameter">initial_price</span>: <span class="builtin">float</span>):
        <span class="self">self._observers</span>: List[<span class="class-name">Observer</span>] = []
        <span class="self">self._symbol</span> = <span class="parameter">symbol</span>
        <span class="self">self._price</span> = <span class="parameter">initial_price</span>
        <span class="self">self._previous_price</span> = <span class="parameter">initial_price</span>
        <span class="self">self._timestamp</span> = datetime.now()
    
    <span class="keyword">def</span> <span class="function">attach</span>(<span class="self">self</span>, <span class="parameter">observer</span>: <span class="class-name">Observer</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Agregar un observador"""</span>
        <span class="keyword">if</span> <span class="parameter">observer</span> <span class="keyword">not in</span> <span class="self">self._observers</span>:
            <span class="self">self._observers</span>.append(<span class="parameter">observer</span>)
            <span class="builtin">print</span>(<span class="string">f"✅ Observador agregado. Total: {<span class="builtin">len</span>(<span class="self">self._observers</span>)}"</span>)
    
    <span class="keyword">def</span> <span class="function">detach</span>(<span class="self">self</span>, <span class="parameter">observer</span>: <span class="class-name">Observer</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Remover un observador"""</span>
        <span class="keyword">if</span> <span class="parameter">observer</span> <span class="keyword">in</span> <span class="self">self._observers</span>:
            <span class="self">self._observers</span>.remove(<span class="parameter">observer</span>)
            <span class="builtin">print</span>(<span class="string">f"❌ Observador removido. Total: {<span class="builtin">len</span>(<span class="self">self._observers</span>)}"</span>)
    
    <span class="keyword">def</span> <span class="function">notify</span>(<span class="self">self</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Notificar a todos los observadores"""</span>
        <span class="builtin">print</span>(<span class="string">f"📢 Notificando a {<span class="builtin">len</span>(<span class="self">self._observers</span>)} observadores..."</span>)
        <span class="keyword">for</span> <span class="parameter">observer</span> <span class="keyword">in</span> <span class="self">self._observers</span>:
            <span class="parameter">observer</span>.update(<span class="self">self</span>)
    
    <span class="decorator">@property</span>
    <span class="keyword">def</span> <span class="function">price</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self._price</span>
    
    <span class="decorator">@price.setter</span>
    <span class="keyword">def</span> <span class="function">price</span>(<span class="self">self</span>, <span class="parameter">new_price</span>: <span class="builtin">float</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Establecer nuevo precio y notificar cambios"""</span>
        <span class="self">self._previous_price</span> = <span class="self">self._price</span>
        <span class="self">self._price</span> = <span class="parameter">new_price</span>
        <span class="self">self._timestamp</span> = datetime.now()
        <span class="builtin">print</span>(<span class="string">f"\n💹 {<span class="self">self._symbol</span>}: ${<span class="self">self._previous_price</span>:.2f} → ${<span class="self">self._price</span>:.2f}"</span>)
        <span class="self">self</span>.notify()
    
    <span class="decorator">@property</span>
    <span class="keyword">def</span> <span class="function">symbol</span>(<span class="self">self</span>) -> <span class="builtin">str</span>:
        <span class="keyword">return</span> <span class="self">self._symbol</span>
    
    <span class="decorator">@property</span>
    <span class="keyword">def</span> <span class="function">change_percentage</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="string">"""Calcular porcentaje de cambio"""</span>
        <span class="keyword">if</span> <span class="self">self._previous_price</span> == <span class="number">0</span>:
            <span class="keyword">return</span> <span class="number">0</span>
        <span class="keyword">return</span> ((<span class="self">self._price</span> - <span class="self">self._previous_price</span>) / <span class="self">self._previous_price</span>) * <span class="number">100</span>

<span class="comment"># Concrete Observers</span>
<span class="keyword">class</span> <span class="class-name">InvestorApp</span>(<span class="class-name">Observer</span>):
    <span class="string">"""Aplicación móvil para inversores"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">investor_name</span>: <span class="builtin">str</span>):
        <span class="self">self._name</span> = <span class="parameter">investor_name</span>
        <span class="self">self._portfolio</span> = {}
    
    <span class="keyword">def</span> <span class="function">update</span>(<span class="self">self</span>, <span class="parameter">subject</span>: <span class="class-name">StockPrice</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Actualizar la vista del inversor"""</span>
        <span class="parameter">change</span> = <span class="parameter">subject</span>.change_percentage
        <span class="parameter">emoji</span> = <span class="string">"📈"</span> <span class="keyword">if</span> <span class="parameter">change</span> >= <span class="number">0</span> <span class="keyword">else</span> <span class="string">"📉"</span>
        
        <span class="builtin">print</span>(<span class="string">f"  📱 [{<span class="self">self._name</span>}] {<span class="parameter">emoji</span>} {<span class="parameter">subject</span>.symbol}: ${<span class="parameter">subject</span>.price:.2f} "</span>
              <span class="string">f"({<span class="parameter">change</span>:+.2f}%)"</span>)
        
        <span class="comment"># Actualizar portfolio interno</span>
        <span class="self">self._portfolio</span>[<span class="parameter">subject</span>.symbol] = <span class="parameter">subject</span>.price

<span class="keyword">class</span> <span class="class-name">NewsAlert</span>(<span class="class-name">Observer</span>):
    <span class="string">"""Sistema de alertas de noticias financieras"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">channel</span>: <span class="builtin">str</span>):
        <span class="self">self._channel</span> = <span class="parameter">channel</span>
        <span class="self">self._alert_threshold</span> = <span class="number">5.0</span>  <span class="comment"># Alertar si el cambio es mayor a 5%</span>
    
    <span class="keyword">def</span> <span class="function">update</span>(<span class="self">self</span>, <span class="parameter">subject</span>: <span class="class-name">StockPrice</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Enviar alerta si hay cambio significativo"""</span>
        <span class="parameter">change</span> = <span class="builtin">abs</span>(<span class="parameter">subject</span>.change_percentage)
        
        <span class="keyword">if</span> <span class="parameter">change</span> >= <span class="self">self._alert_threshold</span>:
            <span class="builtin">print</span>(<span class="string">f"  🚨 [{<span class="self">self._channel</span>}] ¡ALERTA! {<span class="parameter">subject</span>.symbol} "</span>
                  <span class="string">f"cambió {<span class="parameter">subject</span>.change_percentage:+.2f}%"</span>)
        <span class="keyword">else</span>:
            <span class="builtin">print</span>(<span class="string">f"  📰 [{<span class="self">self._channel</span>}] {<span class="parameter">subject</span>.symbol} actualizado"</span>)

<span class="keyword">class</span> <span class="class-name">TradingBot</span>(<span class="class-name">Observer</span>):
    <span class="string">"""Bot de trading automático"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">bot_name</span>: <span class="builtin">str</span>, <span class="parameter">buy_threshold</span>: <span class="builtin">float</span>, <span class="parameter">sell_threshold</span>: <span class="builtin">float</span>):
        <span class="self">self._name</span> = <span class="parameter">bot_name</span>
        <span class="self">self._buy_threshold</span> = <span class="parameter">buy_threshold</span>
        <span class="self">self._sell_threshold</span> = <span class="parameter">sell_threshold</span>
    
    <span class="keyword">def</span> <span class="function">update</span>(<span class="self">self</span>, <span class="parameter">subject</span>: <span class="class-name">StockPrice</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Ejecutar estrategia de trading"""</span>
        <span class="parameter">change</span> = <span class="parameter">subject</span>.change_percentage
        
        <span class="keyword">if</span> <span class="parameter">change</span> <= -<span class="self">self._buy_threshold</span>:
            <span class="builtin">print</span>(<span class="string">f"  🤖 [{<span class="self">self._name</span>}] 💚 COMPRANDO {<span class="parameter">subject</span>.symbol} "</span>
                  <span class="string">f"a ${<span class="parameter">subject</span>.price:.2f}"</span>)
        <span class="keyword">elif</span> <span class="parameter">change</span> >= <span class="self">self._sell_threshold</span>:
            <span class="builtin">print</span>(<span class="string">f"  🤖 [{<span class="self">self._name</span>}] 💔 VENDIENDO {<span class="parameter">subject</span>.symbol} "</span>
                  <span class="string">f"a ${<span class="parameter">subject</span>.price:.2f}"</span>)
        <span class="keyword">else</span>:
            <span class="builtin">print</span>(<span class="string">f"  🤖 [{<span class="self">self._name</span>}] ⏸️  Manteniendo posición"</span>)

<span class="keyword">class</span> <span class="class-name">RiskManager</span>(<span class="class-name">Observer</span>):
    <span class="string">"""Sistema de gestión de riesgos"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">risk_limit</span>: <span class="builtin">float</span>):
        <span class="self">self._risk_limit</span> = <span class="parameter">risk_limit</span>
        <span class="self">self._alerts_sent</span> = <span class="number">0</span>
    
    <span class="keyword">def</span> <span class="function">update</span>(<span class="self">self</span>, <span class="parameter">subject</span>: <span class="class-name">StockPrice</span>) -> <span class="builtin">None</span>:
        <span class="string">"""Evaluar riesgo del movimiento"""</span>
        <span class="parameter">change</span> = <span class="builtin">abs</span>(<span class="parameter">subject</span>.change_percentage)
        
        <span class="keyword">if</span> <span class="parameter">change</span> > <span class="self">self._risk_limit</span>:
            <span class="self">self._alerts_sent</span> += <span class="number">1</span>
            <span class="builtin">print</span>(<span class="string">f"  ⚠️  [RISK] Alto riesgo detectado en {<span class="parameter">subject</span>.symbol}! "</span>
                  <span class="string">f"Volatilidad: {<span class="parameter">change</span>:.2f}%"</span>)

<span class="comment"># Uso del patrón Observer</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="builtin">print</span>(<span class="string">"=== SISTEMA DE MONITOREO DE ACCIONES ==="</span>)
    <span class="builtin">print</span>()
    
    <span class="comment"># Crear sujetos (acciones)</span>
    <span class="parameter">apple_stock</span> = <span class="class-name">StockPrice</span>(<span class="string">"AAPL"</span>, <span class="number">150.00</span>)
    <span class="parameter">tesla_stock</span> = <span class="class-name">StockPrice</span>(<span class="string">"TSLA"</span>, <span class="number">800.00</span>)
    
    <span class="comment"># Crear observadores</span>
    <span class="parameter">investor1</span> = <span class="class-name">InvestorApp</span>(<span class="string">"Carlos Pérez"</span>)
    <span class="parameter">investor2</span> = <span class="class-name">InvestorApp</span>(<span class="string">"María García"</span>)
    <span class="parameter">news</span> = <span class="class-name">NewsAlert</span>(<span class="string">"FinanceNews24"</span>)
    <span class="parameter">bot</span> = <span class="class-name">TradingBot</span>(<span class="string">"AlgoTrader"</span>, <span class="number">3.0</span>, <span class="number">4.0</span>)
    <span class="parameter">risk</span> = <span class="class-name">RiskManager</span>(<span class="number">7.0</span>)
    
    <span class="comment"># Suscribir observadores a Apple</span>
    <span class="builtin">print</span>(<span class="string">"📊 Configurando observadores para AAPL:"</span>)
    <span class="parameter">apple_stock</span>.attach(<span class="parameter">investor1</span>)
    <span class="parameter">apple_stock</span>.attach(<span class="parameter">investor2</span>)
    <span class="parameter">apple_stock</span>.attach(<span class="parameter">news</span>)
    <span class="parameter">apple_stock</span>.attach(<span class="parameter">bot</span>)
    <span class="parameter">apple_stock</span>.attach(<span class="parameter">risk</span>)
    
    <span class="comment"># Suscribir algunos observadores a Tesla</span>
    <span class="builtin">print</span>(<span class="string">"\n📊 Configurando observadores para TSLA:"</span>)
    <span class="parameter">tesla_stock</span>.attach(<span class="parameter">investor1</span>)
    <span class="parameter">tesla_stock</span>.attach(<span class="parameter">bot</span>)
    <span class="parameter">tesla_stock</span>.attach(<span class="parameter">risk</span>)
    
    <span class="comment"># Simular cambios de precio</span>
    <span class="builtin">print</span>(<span class="string">"\n📈 SIMULACIÓN DE MERCADO:"</span>)
    
    <span class="comment"># Cambio pequeño en Apple</span>
    <span class="parameter">apple_stock</span>.price = <span class="number">152.50</span>
    
    <span class="comment"># Cambio significativo en Tesla</span>
    <span class="parameter">tesla_stock</span>.price = <span class="number">850.00</span>
    
    <span class="comment"># Gran caída en Apple</span>
    <span class="parameter">apple_stock</span>.price = <span class="number">140.00</span>
    
    <span class="comment"># Recuperación de Tesla</span>
    <span class="parameter">tesla_stock</span>.price = <span class="number">880.00</span>
    
    <span class="comment"># Desuscribir un observador</span>
    <span class="builtin">print</span>(<span class="string">"\n🔌 Desuscribiendo a María García de AAPL:"</span>)
    <span class="parameter">apple_stock</span>.detach(<span class="parameter">investor2</span>)
    
    <span class="comment"># Otro cambio (María no será notificada)</span>
    <span class="parameter">apple_stock</span>.price = <span class="number">145.00</span></pre>
            </div>

            <h4>4.3.2 Patrón Strategy</h4>
            <p>El patrón Strategy define una familia de algoritmos, encapsula cada uno y los hace intercambiables. Permite que el algoritmo varíe independientemente de los clientes que lo usan, promoviendo el principio Open/Closed.</p>

            <div class="diagram-container" role="img" aria-label="Contenedor de diagrama">
                <div class="diagram-title">Figura 11: Patrón Strategy - Sistema de Pagos</div>
                <svg width="700" height="400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Context -->
                    <rect x="50" y="150" width="180" height="120" fill="white" stroke="black" stroke-width="2"/>
                    <text x="140" y="180" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">CarritoCompras</text>
                    <line x1="50" y1="190" x2="230" y2="190" stroke="black" stroke-width="1"/>
                    <text x="55" y="205" font-family="Arial" font-size="11">- items: List&lt;Item&gt;</text>
                    <text x="55" y="220" font-family="Arial" font-size="11">- estrategiaPago: PagoStrategy</text>
                    <text x="55" y="240" font-family="Arial" font-size="11">+ agregarItem(item: Item)</text>
                    <text x="55" y="255" font-family="Arial" font-size="11">+ setEstrategia(e: PagoStrategy)</text>
                    <text x="55" y="270" font-family="Arial" font-size="11">+ pagar(monto: double)</text>
                    
                    <!-- Strategy Interface -->
                    <rect x="350" y="20" width="200" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="450" y="40" text-anchor="middle" font-family="Arial" font-size="12">«interface»</text>
                    <text x="450" y="60" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">PagoStrategy</text>
                    <line x1="350" y1="70" x2="550" y2="70" stroke="black" stroke-width="1"/>
                    <text x="355" y="90" font-family="Arial" font-size="11">+ pagar(monto: double): boolean</text>
                    
                    <!-- Concrete Strategies -->
                    <rect x="250" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="310" y="210" text-anchor="middle" font-family="Arial" font-size="14">TarjetaCredito</text>
                    <line x1="250" y1="220" x2="370" y2="220" stroke="black" stroke-width="1"/>
                    <text x="255" y="235" font-family="Arial" font-size="10">- numero: String</text>
                    <text x="255" y="250" font-family="Arial" font-size="10">+ pagar(monto)</text>
                    
                    <rect x="400" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="460" y="210" text-anchor="middle" font-family="Arial" font-size="14">PayPal</text>
                    <line x1="400" y1="220" x2="520" y2="220" stroke="black" stroke-width="1"/>
                    <text x="405" y="235" font-family="Arial" font-size="10">- email: String</text>
                    <text x="405" y="250" font-family="Arial" font-size="10">+ pagar(monto)</text>
                    
                    <rect x="550" y="180" width="120" height="80" fill="white" stroke="black" stroke-width="2"/>
                    <text x="610" y="210" text-anchor="middle" font-family="Arial" font-size="14">Bitcoin</text>
                    <line x1="550" y1="220" x2="670" y2="220" stroke="black" stroke-width="1"/>
                    <text x="555" y="235" font-family="Arial" font-size="10">- wallet: String</text>
                    <text x="555" y="250" font-family="Arial" font-size="10">+ pagar(monto)</text>
                    
                    <!-- Relations -->
                    <line x1="310" y1="180" x2="450" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="460" y1="180" x2="450" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="610" y1="180" x2="450" y2="100" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
                    <polygon points="450,100 440,110 460,110" fill="white" stroke="black" stroke-width="2"/>
                    
                    <!-- Aggregation -->
                    <line x1="230" y1="210" x2="350" y2="60" stroke="black" stroke-width="2"/>
                    <polygon points="230,210 240,205 240,215" fill="white" stroke="black" stroke-width="2"/>
                    <text x="280" y="130" font-family="Arial" font-size="11">usa</text>
                </svg>
            </div>

            <div class="example-box">
                <h4>Ventajas del Strategy:</h4>
                <ul role="list">
                    <li role="listitem">Elimina condicionales complejos (switch/if largos)</li>
                    <li role="listitem">Facilita agregar nuevos algoritmos sin modificar código existente</li>
                    <li role="listitem">Permite cambiar el algoritmo en tiempo de ejecución</li>
                    <li role="listitem">Promueve la reutilización de algoritmos en diferentes contextos</li>
                </ul>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PYTHON</span>
                    <span class="code-filename">strategy_pagos.py</span>
                </div>
                <pre><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod
<span class="keyword">from</span> typing <span class="keyword">import</span> List, Dict
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime
<span class="keyword">import</span> re

<span class="comment"># Strategy Interface</span>
<span class="keyword">class</span> <span class="class-name">PagoStrategy</span>(ABC):
    <span class="string">"""Interfaz para todas las estrategias de pago"""</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">pagar</span>(<span class="self">self</span>, <span class="parameter">monto</span>: <span class="builtin">float</span>) -> <span class="builtin">bool</span>:
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">validar</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="keyword">pass</span>

<span class="comment"># Concrete Strategies</span>
<span class="keyword">class</span> <span class="class-name">TarjetaCredito</span>(<span class="class-name">PagoStrategy</span>):
    <span class="string">"""Estrategia de pago con tarjeta de crédito"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">numero</span>: <span class="builtin">str</span>, <span class="parameter">cvv</span>: <span class="builtin">str</span>, <span class="parameter">fecha_exp</span>: <span class="builtin">str</span>):
        <span class="self">self._numero</span> = <span class="parameter">numero</span>
        <span class="self">self._cvv</span> = <span class="parameter">cvv</span>
        <span class="self">self._fecha_exp</span> = <span class="parameter">fecha_exp</span>
        <span class="self">self._limite</span> = <span class="number">5000.0</span>  <span class="comment"># Límite de crédito</span>
    
    <span class="keyword">def</span> <span class="function">validar</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Validar datos de la tarjeta"""</span>
        <span class="comment"># Validar formato de número (simplificado)</span>
        <span class="keyword">if</span> <span class="keyword">not</span> re.match(r<span class="string">'^\d{16}

            <h4>4.3.3 Patrón Template Method</h4>
            <p>Define el esqueleto de un algoritmo en una operación, delegando algunos pasos a las subclases. Template Method permite a las subclases redefinir ciertos pasos de un algoritmo sin cambiar su estructura.</p>

            <div class="concept-box">
                <h4>Estructura del Template Method:</h4>
                <ol role="list">
                    <li role="listitem">Una clase abstracta define el template method</li>
                    <li role="listitem">El template method llama a operaciones primitivas</li>
                    <li role="listitem">Las subclases implementan las operaciones primitivas</li>
                    <li role="listitem">El algoritmo general permanece inmutable</li>
                </ol>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PYTHON</span>
                    <span class="code-filename">template_data_mining.py</span>
                </div>
                <pre><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod
<span class="keyword">from</span> typing <span class="keyword">import</span> Dict, List, Any
<span class="keyword">import</span> json
<span class="keyword">import</span> csv
<span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="comment"># Abstract Class con Template Method</span>
<span class="keyword">class</span> <span class="class-name">DataMiner</span>(ABC):
    <span class="string">"""Clase abstracta que define el algoritmo de minería de datos"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">filepath</span>: <span class="builtin">str</span>):
        <span class="self">self.filepath</span> = <span class="parameter">filepath</span>
        <span class="self">self.raw_data</span> = <span class="builtin">None</span>
        <span class="self">self.processed_data</span> = <span class="builtin">None</span>
        <span class="self">self.analysis_result</span> = <span class="builtin">None</span>
    
    <span class="comment"># Template Method - Define el algoritmo general</span>
    <span class="keyword">def</span> <span class="function">mine_data</span>(<span class="self">self</span>) -> Dict[<span class="builtin">str</span>, Any]:
        <span class="string">"""
        Template method que define los pasos del algoritmo de minería.
        Este método NO debe ser sobrescrito por las subclases.
        """</span>
        <span class="builtin">print</span>(<span class="string">f"\n🔍 Iniciando minería de datos desde: {<span class="self">self.filepath</span>}"</span>)
        <span class="builtin">print</span>(<span class="string">"="</span> * <span class="number">60</span>)
        
        <span class="comment"># Paso 1: Abrir archivo</span>
        <span class="self">self</span>.open_file()
        
        <span class="comment"># Paso 2: Extraer datos (abstracto)</span>
        <span class="self">self</span>.raw_data = <span class="self">self</span>.extract_data()
        <span class="builtin">print</span>(<span class="string">f"✅ Datos extraídos: {<span class="builtin">len</span>(<span class="self">self.raw_data</span>)} registros"</span>)
        
        <span class="comment"># Paso 3: Parsear datos (abstracto)</span>
        <span class="self">self</span>.processed_data = <span class="self">self</span>.parse_data()
        <span class="builtin">print</span>(<span class="string">f"✅ Datos parseados correctamente"</span>)
        
        <span class="comment"># Paso 4: Analizar datos (común para todos)</span>
        <span class="self">self</span>.analysis_result = <span class="self">self</span>.analyze_data()
        
        <span class="comment"># Paso 5: Generar reporte (hook method)</span>
        <span class="keyword">if</span> <span class="self">self</span>.should_generate_report():
            <span class="self">self</span>.generate_report()
        
        <span class="comment"># Paso 6: Cerrar archivo</span>
        <span class="self">self</span>.close_file()
        
        <span class="keyword">return</span> <span class="self">self.analysis_result</span>
    
    <span class="comment"># Métodos concretos (comunes para todas las subclases)</span>
    <span class="keyword">def</span> <span class="function">open_file</span>(<span class="self">self</span>):
        <span class="string">"""Abrir archivo para lectura"""</span>
        <span class="builtin">print</span>(<span class="string">f"📂 Abriendo archivo: {<span class="self">self.filepath</span>}"</span>)
    
    <span class="keyword">def</span> <span class="function">close_file</span>(<span class="self">self</span>):
        <span class="string">"""Cerrar archivo"""</span>
        <span class="builtin">print</span>(<span class="string">"📁 Archivo cerrado"</span>)
    
    <span class="keyword">def</span> <span class="function">analyze_data</span>(<span class="self">self</span>) -> Dict[<span class="builtin">str</span>, Any]:
        <span class="string">"""Análisis común para todos los tipos de datos"""</span>
        <span class="builtin">print</span>(<span class="string">"\n📊 Analizando datos..."</span>)
        
        <span class="parameter">analysis</span> = {
            <span class="string">'total_records'</span>: <span class="builtin">len</span>(<span class="self">self.processed_data</span>),
            <span class="string">'timestamp'</span>: datetime.now().isoformat(),
            <span class="string">'source_file'</span>: <span class="self">self.filepath</span>,
            <span class="string">'data_summary'</span>: {}
        }
        
        <span class="comment"># Análisis básico común</span>
        <span class="keyword">if</span> <span class="self">self.processed_data</span>:
            <span class="comment"># Contar tipos de datos</span>
            <span class="parameter">type_counts</span> = {}
            <span class="keyword">for</span> <span class="parameter">record</span> <span class="keyword">in</span> <span class="self">self.processed_data</span>:
                <span class="keyword">for</span> <span class="parameter">key</span>, <span class="parameter">value</span> <span class="keyword">in</span> <span class="parameter">record</span>.items():
                    <span class="parameter">data_type</span> = <span class="builtin">type</span>(<span class="parameter">value</span>).__name__
                    <span class="keyword">if</span> <span class="parameter">data_type</span> <span class="keyword">not in</span> <span class="parameter">type_counts</span>:
                        <span class="parameter">type_counts</span>[<span class="parameter">data_type</span>] = <span class="number">0</span>
                    <span class="parameter">type_counts</span>[<span class="parameter">data_type</span>] += <span class="number">1</span>
            
            <span class="parameter">analysis</span>[<span class="string">'data_types'</span>] = <span class="parameter">type_counts</span>
            
            <span class="comment"># Obtener campos únicos</span>
            <span class="parameter">all_fields</span> = <span class="builtin">set</span>()
            <span class="keyword">for</span> <span class="parameter">record</span> <span class="keyword">in</span> <span class="self">self.processed_data</span>:
                <span class="parameter">all_fields</span>.update(<span class="parameter">record</span>.keys())
            <span class="parameter">analysis</span>[<span class="string">'fields'</span>] = <span class="builtin">list</span>(<span class="parameter">all_fields</span>)
        
        <span class="keyword">return</span> <span class="parameter">analysis</span>
    
    <span class="comment"># Hook method (puede ser sobrescrito)</span>
    <span class="keyword">def</span> <span class="function">should_generate_report</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Hook method para decidir si generar reporte"""</span>
        <span class="keyword">return</span> <span class="builtin">True</span>
    
    <span class="keyword">def</span> <span class="function">generate_report</span>(<span class="self">self</span>):
        <span class="string">"""Generar reporte del análisis"""</span>
        <span class="builtin">print</span>(<span class="string">"\n📄 REPORTE DE ANÁLISIS:"</span>)
        <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)
        <span class="builtin">print</span>(<span class="string">f"Total de registros: {<span class="self">self.analysis_result</span>[<span class="string">'total_records'</span>]}"</span>)
        <span class="builtin">print</span>(<span class="string">f"Campos encontrados: {<span class="string">', '</span>.join(<span class="self">self.analysis_result</span>[<span class="string">'fields'</span>])}"</span>)
        <span class="builtin">print</span>(<span class="string">f"Tipos de datos: {<span class="self">self.analysis_result</span>[<span class="string">'data_types'</span>]}"</span>)
        <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)
    
    <span class="comment"># Métodos abstractos (deben ser implementados por subclases)</span>
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">extract_data</span>(<span class="self">self</span>) -> List[Any]:
        <span class="string">"""Extraer datos del archivo"""</span>
        <span class="keyword">pass</span>
    
    <span class="decorator">@abstractmethod</span>
    <span class="keyword">def</span> <span class="function">parse_data</span>(<span class="self">self</span>) -> List[Dict[<span class="builtin">str</span>, Any]]:
        <span class="string">"""Parsear datos al formato estándar"""</span>
        <span class="keyword">pass</span>

<span class="comment"># Concrete Classes</span>
<span class="keyword">class</span> <span class="class-name">CSVDataMiner</span>(<span class="class-name">DataMiner</span>):
    <span class="string">"""Implementación concreta para archivos CSV"""</span>
    
    <span class="keyword">def</span> <span class="function">extract_data</span>(<span class="self">self</span>) -> List[Any]:
        <span class="string">"""Extraer datos de archivo CSV"""</span>
        <span class="builtin">print</span>(<span class="string">"📋 Extrayendo datos CSV..."</span>)
        <span class="parameter">data</span> = []
        
        <span class="keyword">with</span> <span class="builtin">open</span>(<span class="self">self.filepath</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> <span class="parameter">file</span>:
            <span class="parameter">csv_reader</span> = csv.DictReader(<span class="parameter">file</span>)
            <span class="keyword">for</span> <span class="parameter">row</span> <span class="keyword">in</span> <span class="parameter">csv_reader</span>:
                <span class="parameter">data</span>.append(<span class="parameter">row</span>)
        
        <span class="keyword">return</span> <span class="parameter">data</span>
    
    <span class="keyword">def</span> <span class="function">parse_data</span>(<span class="self">self</span>) -> List[Dict[<span class="builtin">str</span>, Any]]:
        <span class="string">"""Parsear datos CSV al formato estándar"""</span>
        <span class="builtin">print</span>(<span class="string">"🔄 Parseando datos CSV..."</span>)
        <span class="parameter">parsed_data</span> = []
        
        <span class="keyword">for</span> <span class="parameter">row</span> <span class="keyword">in</span> <span class="self">self.raw_data</span>:
            <span class="parameter">parsed_row</span> = {}
            <span class="keyword">for</span> <span class="parameter">key</span>, <span class="parameter">value</span> <span class="keyword">in</span> <span class="parameter">row</span>.items():
                <span class="comment"># Intentar convertir a número si es posible</span>
                <span class="keyword">try</span>:
                    <span class="keyword">if</span> <span class="string">'.'</span> <span class="keyword">in</span> <span class="parameter">value</span>:
                        <span class="parameter">parsed_row</span>[<span class="parameter">key</span>] = <span class="builtin">float</span>(<span class="parameter">value</span>)
                    <span class="keyword">else</span>:
                        <span class="parameter">parsed_row</span>[<span class="parameter">key</span>] = <span class="builtin">int</span>(<span class="parameter">value</span>)
                <span class="keyword">except</span> <span class="builtin">ValueError</span>:
                    <span class="parameter">parsed_row</span>[<span class="parameter">key</span>] = <span class="parameter">value</span>
            
            <span class="parameter">parsed_data</span>.append(<span class="parameter">parsed_row</span>)
        
        <span class="keyword">return</span> <span class="parameter">parsed_data</span>

<span class="keyword">class</span> <span class="class-name">JSONDataMiner</span>(<span class="class-name">DataMiner</span>):
    <span class="string">"""Implementación concreta para archivos JSON"""</span>
    
    <span class="keyword">def</span> <span class="function">extract_data</span>(<span class="self">self</span>) -> List[Any]:
        <span class="string">"""Extraer datos de archivo JSON"""</span>
        <span class="builtin">print</span>(<span class="string">"🔧 Extrayendo datos JSON..."</span>)
        
        <span class="keyword">with</span> <span class="builtin">open</span>(<span class="self">self.filepath</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> <span class="parameter">file</span>:
            <span class="parameter">data</span> = json.load(<span class="parameter">file</span>)
        
        <span class="comment"># Si es un objeto, convertir a lista</span>
        <span class="keyword">if</span> <span class="builtin">isinstance</span>(<span class="parameter">data</span>, <span class="builtin">dict</span>):
            <span class="parameter">data</span> = [<span class="parameter">data</span>]
        
        <span class="keyword">return</span> <span class="parameter">data</span>
    
    <span class="keyword">def</span> <span class="function">parse_data</span>(<span class="self">self</span>) -> List[Dict[<span class="builtin">str</span>, Any]]:
        <span class="string">"""Parsear datos JSON al formato estándar"""</span>
        <span class="builtin">print</span>(<span class="string">"🔄 Parseando datos JSON..."</span>)
        <span class="comment"># JSON ya está en formato dict, solo validar estructura</span>
        <span class="keyword">return</span> <span class="self">self.raw_data</span>
    
    <span class="keyword">def</span> <span class="function">generate_report</span>(<span class="self">self</span>):
        <span class="string">"""Sobrescribir para agregar información específica de JSON"""</span>
        <span class="builtin">super</span>().generate_report()
        <span class="builtin">print</span>(<span class="string">"📊 Estructura JSON detectada"</span>)

<span class="keyword">class</span> <span class="class-name">XMLDataMiner</span>(<span class="class-name">DataMiner</span>):
    <span class="string">"""Implementación concreta para archivos XML"""</span>
    
    <span class="keyword">def</span> <span class="function">extract_data</span>(<span class="self">self</span>) -> List[Any]:
        <span class="string">"""Extraer datos de archivo XML"""</span>
        <span class="builtin">print</span>(<span class="string">"📜 Extrayendo datos XML..."</span>)
        
        <span class="parameter">tree</span> = ET.parse(<span class="self">self.filepath</span>)
        <span class="parameter">root</span> = <span class="parameter">tree</span>.getroot()
        
        <span class="parameter">data</span> = []
        <span class="keyword">for</span> <span class="parameter">child</span> <span class="keyword">in</span> <span class="parameter">root</span>:
            <span class="parameter">data</span>.append(<span class="parameter">child</span>)
        
        <span class="keyword">return</span> <span class="parameter">data</span>
    
    <span class="keyword">def</span> <span class="function">parse_data</span>(<span class="self">self</span>) -> List[Dict[<span class="builtin">str</span>, Any]]:
        <span class="string">"""Parsear datos XML al formato estándar"""</span>
        <span class="builtin">print</span>(<span class="string">"🔄 Parseando datos XML..."</span>)
        <span class="parameter">parsed_data</span> = []
        
        <span class="keyword">for</span> <span class="parameter">element</span> <span class="keyword">in</span> <span class="self">self.raw_data</span>:
            <span class="parameter">record</span> = {<span class="string">'tag'</span>: <span class="parameter">element</span>.tag}
            
            <span class="comment"># Agregar atributos</span>
            <span class="parameter">record</span>.update(<span class="parameter">element</span>.attrib)
            
            <span class="comment"># Agregar texto si existe</span>
            <span class="keyword">if</span> <span class="parameter">element</span>.text <span class="keyword">and</span> <span class="parameter">element</span>.text.strip():
                <span class="parameter">record</span>[<span class="string">'_text'</span>] = <span class="parameter">element</span>.text.strip()
            
            <span class="comment"># Agregar sub-elementos</span>
            <span class="keyword">for</span> <span class="parameter">child</span> <span class="keyword">in</span> <span class="parameter">element</span>:
                <span class="parameter">record</span>[<span class="parameter">child</span>.tag] = <span class="parameter">child</span>.text <span class="keyword">if</span> <span class="parameter">child</span>.text <span class="keyword">else</span> <span class="string">''</span>
            
            <span class="parameter">parsed_data</span>.append(<span class="parameter">record</span>)
        
        <span class="keyword">return</span> <span class="parameter">parsed_data</span>
    
    <span class="keyword">def</span> <span class="function">should_generate_report</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Hook method - XML siempre genera reporte detallado"""</span>
        <span class="keyword">return</span> <span class="builtin">True</span>

<span class="keyword">class</span> <span class="class-name">LogDataMiner</span>(<span class="class-name">DataMiner</span>):
    <span class="string">"""Implementación para archivos de log"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">filepath</span>: <span class="builtin">str</span>, <span class="parameter">pattern</span>: <span class="builtin">str</span> = <span class="builtin">None</span>):
        <span class="builtin">super</span>().__init__(<span class="parameter">filepath</span>)
        <span class="self">self.pattern</span> = <span class="parameter">pattern</span> <span class="keyword">or</span> <span class="string">r'(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) \[(\w+)\] (.*)'</span>
    
    <span class="keyword">def</span> <span class="function">extract_data</span>(<span class="self">self</span>) -> List[Any]:
        <span class="string">"""Extraer líneas del archivo de log"""</span>
        <span class="builtin">print</span>(<span class="string">"📝 Extrayendo datos de log..."</span>)
        
        <span class="keyword">with</span> <span class="builtin">open</span>(<span class="self">self.filepath</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> <span class="parameter">file</span>:
            <span class="parameter">lines</span> = <span class="parameter">file</span>.readlines()
        
        <span class="keyword">return</span> <span class="parameter">lines</span>
    
    <span class="keyword">def</span> <span class="function">parse_data</span>(<span class="self">self</span>) -> List[Dict[<span class="builtin">str</span>, Any]]:
        <span class="string">"""Parsear líneas de log al formato estándar"""</span>
        <span class="builtin">print</span>(<span class="string">"🔄 Parseando datos de log..."</span>)
        <span class="keyword">import</span> re
        
        <span class="parameter">parsed_data</span> = []
        <span class="parameter">pattern</span> = re.compile(<span class="self">self.pattern</span>)
        
        <span class="keyword">for</span> <span class="parameter">line</span> <span class="keyword">in</span> <span class="self">self.raw_data</span>:
            <span class="parameter">match</span> = <span class="parameter">pattern</span>.match(<span class="parameter">line</span>.strip())
            <span class="keyword">if</span> <span class="parameter">match</span>:
                <span class="parameter">parsed_data</span>.append({
                    <span class="string">'timestamp'</span>: <span class="parameter">match</span>.group(<span class="number">1</span>),
                    <span class="string">'level'</span>: <span class="parameter">match</span>.group(<span class="number">2</span>),
                    <span class="string">'message'</span>: <span class="parameter">match</span>.group(<span class="number">3</span>)
                })
        
        <span class="keyword">return</span> <span class="parameter">parsed_data</span>
    
    <span class="keyword">def</span> <span class="function">analyze_data</span>(<span class="self">self</span>) -> Dict[<span class="builtin">str</span>, Any]:
        <span class="string">"""Análisis específico para logs"""</span>
        <span class="parameter">analysis</span> = <span class="builtin">super</span>().analyze_data()
        
        <span class="comment"># Contar por nivel de log</span>
        <span class="parameter">level_counts</span> = {}
        <span class="keyword">for</span> <span class="parameter">record</span> <span class="keyword">in</span> <span class="self">self.processed_data</span>:
            <span class="parameter">level</span> = <span class="parameter">record</span>.get(<span class="string">'level'</span>, <span class="string">'UNKNOWN'</span>)
            <span class="parameter">level_counts</span>[<span class="parameter">level</span>] = <span class="parameter">level_counts</span>.get(<span class="parameter">level</span>, <span class="number">0</span>) + <span class="number">1</span>
        
        <span class="parameter">analysis</span>[<span class="string">'log_levels'</span>] = <span class="parameter">level_counts</span>
        <span class="keyword">return</span> <span class="parameter">analysis</span>

<span class="comment"># Función auxiliar para demostrar el patrón</span>
<span class="keyword">def</span> <span class="function">procesar_archivo</span>(<span class="parameter">miner</span>: <span class="class-name">DataMiner</span>):
    <span class="string">"""Procesar archivo usando el data miner apropiado"""</span>
    <span class="keyword">try</span>:
        <span class="parameter">resultado</span> = <span class="parameter">miner</span>.mine_data()
        <span class="builtin">print</span>(<span class="string">f"\n✅ Procesamiento completado exitosamente"</span>)
        <span class="keyword">return</span> <span class="parameter">resultado</span>
    <span class="keyword">except</span> <span class="builtin">Exception</span> <span class="keyword">as</span> <span class="parameter">e</span>:
        <span class="builtin">print</span>(<span class="string">f"\n❌ Error durante el procesamiento: {<span class="parameter">e</span>}"</span>)
        <span class="keyword">return</span> <span class="builtin">None</span>

<span class="comment"># Uso del patrón Template Method</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="builtin">print</span>(<span class="string">"🎯 SISTEMA DE MINERÍA DE DATOS"</span>)
    <span class="builtin">print</span>(<span class="string">"="</span> * <span class="number">60</span>)
    
    <span class="comment"># Simular diferentes tipos de archivos</span>
    <span class="comment"># Nota: En un caso real, estos archivos existirían</span>
    
    <span class="comment"># Procesar archivo CSV</span>
    <span class="builtin">print</span>(<span class="string">"\n1️⃣ PROCESANDO ARCHIVO CSV"</span>)
    <span class="parameter">csv_miner</span> = <span class="class-name">CSVDataMiner</span>(<span class="string">"ventas.csv"</span>)
    <span class="comment"># procesar_archivo(csv_miner)</span>
    
    <span class="comment"># Procesar archivo JSON</span>
    <span class="builtin">print</span>(<span class="string">"\n2️⃣ PROCESANDO ARCHIVO JSON"</span>)
    <span class="parameter">json_miner</span> = <span class="class-name">JSONDataMiner</span>(<span class="string">"configuracion.json"</span>)
    <span class="comment"># procesar_archivo(json_miner)</span>
    
    <span class="comment"># Procesar archivo XML</span>
    <span class="builtin">print</span>(<span class="string">"\n3️⃣ PROCESANDO ARCHIVO XML"</span>)
    <span class="parameter">xml_miner</span> = <span class="class-name">XMLDataMiner</span>(<span class="string">"productos.xml"</span>)
    <span class="comment"># procesar_archivo(xml_miner)</span>
    
    <span class="comment"># Procesar archivo de logs</span>
    <span class="builtin">print</span>(<span class="string">"\n4️⃣ PROCESANDO ARCHIVO DE LOGS"</span>)
    <span class="parameter">log_miner</span> = <span class="class-name">LogDataMiner</span>(<span class="string">"sistema.log"</span>)
    <span class="comment"># procesar_archivo(log_miner)</span>
    
    <span class="builtin">print</span>(<span class="string">"\n📌 Nota: El algoritmo general (Template Method) es el mismo"</span>)
    <span class="builtin">print</span>(<span class="string">"   para todos los tipos de archivo, solo cambian los pasos"</span>)
    <span class="builtin">print</span>(<span class="string">"   específicos de extracción y parseo."</span>)</pre>
            </div>

            <h3>4.4 Representación de Patrones en UML</h3>
            <p>Al documentar patrones en UML, es fundamental seguir convenciones que mejoren la comunicación y comprensión del diseño.</p>

            <div class="synoptic-table">
                <h4>Guía de Mejores Prácticas para Documentar Patrones:</h4>
                <table role="table">
                    <tr role="row">
                        <th role="columnheader">Aspecto</th>
                        <th role="columnheader">Recomendación</th>
                        <th role="columnheader">Ejemplo</th>
                    </tr>
                    <tr role="row">
                        <td role="cell">Estereotipos</td>
                        <td role="cell">Usar para identificar roles del patrón</td>
                        <td role="cell">«Singleton», «Factory», «Observer»</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Nombres</td>
                        <td role="cell">Incluir el nombre del patrón cuando sea claro</td>
                        <td role="cell">ConfigurationSingleton, PaymentStrategy</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Notas</td>
                        <td role="cell">Agregar notas UML explicando decisiones</td>
                        <td role="cell">"Este patrón permite cambiar el algoritmo en runtime"</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Colaboraciones</td>
                        <td role="cell">Incluir diagramas de secuencia</td>
                        <td role="cell">Mostrar flujo de llamadas entre objetos</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Multiplicidad</td>
                        <td role="cell">Ser preciso con las cardinalidades</td>
                        <td role="cell">Observer: 1 Subject → * Observers</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Interfaces</td>
                        <td role="cell">Usar interfaces para abstracciones</td>
                        <td role="cell">Marcar claramente con «interface»</td>
                    </tr>
                </table>
            </div>

            <h3>4.5 Combinación de Patrones</h3>
            <p>En sistemas reales, los patrones raramente aparecen aislados. Es común combinar múltiples patrones para resolver problemas complejos.</p>

            <div class="pattern-card">
                <h5>Ejemplos de Combinaciones Comunes:</h5>
                <ul role="list">
                    <li role="listitem"><strong>MVC:</strong> Combina Observer (Model-View) + Strategy (Controller) + Composite (View)</li>
                    <li role="listitem"><strong>Abstract Factory + Singleton:</strong> Fábricas únicas para familias de objetos</li>
                    <li role="listitem"><strong>Decorator + Factory Method:</strong> Crear decoradores dinámicamente</li>
                    <li role="listitem"><strong>Strategy + Template Method:</strong> Algoritmos intercambiables con estructura común</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>Anti-patrones a Evitar:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Singleton Overuse:</strong> No todo necesita ser singleton</li>
                    <li role="listitem"><strong>Pattern Obsession:</strong> No forzar patrones donde no son necesarios</li>
                    <li role="listitem"><strong>Premature Abstraction:</strong> No sobre-diseñar anticipando cambios futuros</li>
                    <li role="listitem"><strong>Copy-Paste Pattern:</strong> Entender el patrón, no solo copiar código</li>
                </ul>
            </div>

            <p>La representación efectiva de patrones en UML no solo documenta la solución técnica, sino que también comunica la intención del diseño, las decisiones arquitectónicas y facilita la comprensión y mantenimiento del sistema a largo plazo. El dominio de estos patrones y su correcta representación en UML es una habilidad fundamental para todo analista de sistemas.</p>
        </section>

        <!-- Resumen y Conclusiones -->
        <section class="section">
            <h2>Resumen y Conclusiones</h2>
            
            <div class="concept-box">
                <h3>Puntos Clave de la Clase:</h3>
                <ul role="list">
                    <li role="listitem">Los diagramas de clases UML son fundamentales para el modelado orientado a objetos</li>
                    <li role="listitem">La notación precisa es esencial para la comunicación efectiva</li>
                    <li role="listitem">Las relaciones entre clases expresan la estructura y colaboración del sistema</li>
                    <li role="listitem">Las técnicas sistemáticas de modelado mejoran la calidad del diseño</li>
                    <li role="listitem">Los patrones de diseño se documentan efectivamente usando UML</li>
                </ul>
            </div>

            <h3>Próximos Pasos</h3>
            <p>En la siguiente clase, exploraremos los Casos de Uso Avanzados, profundizando en la especificación según Cockburn y las relaciones complejas entre casos de uso.</p>
        </section>

        <!-- Sección de Evaluación -->
        <section class="quiz-section">
            <h2>Evaluación - 20 Preguntas</h2>
            <p class="quiz-instructions">Selecciona la respuesta correcta para cada pregunta. Al finalizar, presiona el botón "Ver Resultados" para conocer tu puntuación.</p>
            
            <div id="quiz-container">
                <div class="question" data-question="1" data-answer="B">
                    <h4>1. ¿Qué símbolo representa un atributo privado en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) ~</li>
                    </ul>
                </div>

                <div class="question" data-question="2" data-answer="B">
                    <h4>2. ¿Cuál es la diferencia visual entre agregación y composición?</h4>
                    <ul class="options">
                        <li data-option="A">A) La agregación usa un diamante relleno, la composición uno vacío</li>
                        <li data-option="B">B) La agregación usa un diamante vacío, la composición uno relleno</li>
                        <li data-option="C">C) Ambas usan el mismo símbolo</li>
                        <li data-option="D">D) La agregación no tiene símbolo especial</li>
                    </ul>
                </div>

                <div class="question" data-question="3" data-answer="C">
                    <h4>3. ¿Cuándo se usa una relación de dependencia?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cuando hay una relación permanente entre clases</li>
                        <li data-option="B">B) Cuando una clase hereda de otra</li>
                        <li data-option="C">C) Cuando el uso es temporal y no implica un atributo permanente</li>
                        <li data-option="D">D) Cuando las clases comparten atributos</li>
                    </ul>
                </div>

                <div class="question" data-question="4" data-answer="D">
                    <h4>4. ¿Qué representa una línea punteada con flecha en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Herencia</li>
                        <li data-option="B">B) Asociación</li>
                        <li data-option="C">C) Composición</li>
                        <li data-option="D">D) Dependencia o Realización</li>
                    </ul>
                </div>

                <div class="question" data-question="5" data-answer="B">
                    <h4>5. ¿Cómo se indica una clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Con el nombre en negrita</li>
                        <li data-option="B">B) Con el nombre en cursiva o estereotipo «abstract»</li>
                        <li data-option="C">C) Con un asterisco después del nombre</li>
                        <li data-option="D">D) Subrayando el nombre</li>
                    </ul>
                </div>

                <div class="question" data-question="6" data-answer="C">
                    <h4>6. ¿Qué significa la multiplicidad "1..*" en una asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cero o más</li>
                        <li data-option="B">B) Exactamente uno</li>
                        <li data-option="C">C) Uno o más</li>
                        <li data-option="D">D) Cero o uno</li>
                    </ul>
                </div>

                <div class="question" data-question="7" data-answer="B">
                    <h4>7. ¿Cuál es el propósito principal de una clase de asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases en el diagrama</li>
                        <li data-option="B">B) Modelar atributos y comportamiento de la relación misma</li>
                        <li data-option="C">C) Simplificar la herencia</li>
                        <li data-option="D">D) Eliminar dependencias</li>
                    </ul>
                </div>

                <div class="question" data-question="8" data-answer="B">
                    <h4>8. En el patrón Singleton, ¿qué característica es fundamental?</h4>
                    <ul class="options">
                        <li data-option="A">A) Múltiples constructores públicos</li>
                        <li data-option="B">B) Constructor privado y método getInstance() estático</li>
                        <li data-option="C">C) Herencia múltiple</li>
                        <li data-option="D">D) Implementación de varias interfaces</li>
                    </ul>
                </div>

                <div class="question" data-question="9" data-answer="B">
                    <h4>9. ¿Qué técnica usa sustantivos para identificar clases candidatas?</h4>
                    <ul class="options">
                        <li data-option="A">A) Análisis CRC</li>
                        <li data-option="B">B) Análisis lingüístico</li>
                        <li data-option="C">C) Análisis de patrones</li>
                        <li data-option="D">D) Análisis de casos de uso</li>
                    </ul>
                </div>

                <div class="question" data-question="10" data-answer="C">
                    <h4>10. ¿Cuál NO es una categoría típica de clases en el modelado?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cosas tangibles</li>
                        <li data-option="B">B) Roles</li>
                        <li data-option="C">C) Colores</li>
                        <li data-option="D">D) Eventos</li>
                    </ul>
                </div>

                <div class="question" data-question="11" data-answer="B">
                    <h4>11. ¿Qué significa CRC en las tarjetas CRC?</h4>
                    <ul class="options">
                        <li data-option="A">A) Create-Read-Copy</li>
                        <li data-option="B">B) Clase-Responsabilidad-Colaboración</li>
                        <li data-option="C">C) Control-Relación-Clase</li>
                        <li data-option="D">D) Concepto-Regla-Condición</li>
                    </ul>
                </div>

                <div class="question" data-question="12" data-answer="B">
                    <h4>12. ¿Cuál es la diferencia principal entre interfaz y clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) No hay diferencia</li>
                        <li data-option="B">B) Las interfaces solo tienen operaciones, no atributos</li>
                        <li data-option="C">C) Las clases abstractas no pueden tener métodos</li>
                        <li data-option="D">D) Las interfaces usan herencia múltiple</li>
                    </ul>
                </div>

                <div class="question" data-question="13" data-answer="D">
                    <h4>13. ¿Qué patrón define una familia de algoritmos intercambiables?</h4>
                    <ul class="options">
                        <li data-option="A">A) Singleton</li>
                        <li data-option="B">B) Factory</li>
                        <li data-option="C">C) Observer</li>
                        <li data-option="D">D) Strategy</li>
                    </ul>
                </div>

                <div class="question" data-question="14" data-answer="B">
                    <h4>14. En una relación de composición, ¿qué ocurre cuando se elimina el "todo"?</h4>
                    <ul class="options">
                        <li data-option="A">A) Las partes continúan existiendo</li>
                        <li data-option="B">B) Las partes también se eliminan</li>
                        <li data-option="C">C) Se convierten en agregación</li>
                        <li data-option="D">D) Se crea una nueva instancia</li>
                    </ul>
                </div>

                <div class="question" data-question="15" data-answer="C">
                    <h4>15. ¿Qué notación se usa para un método estático en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cursiva</li>
                        <li data-option="B">B) Negrita</li>
                        <li data-option="C">C) Subrayado</li>
                        <li data-option="D">D) Entre corchetes</li>
                    </ul>
                </div>

                <div class="question" data-question="16" data-answer="C">
                    <h4>16. ¿Cuál es el símbolo de visibilidad para "protegido"?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) *</li>
                    </ul>
                </div>

                <div class="question" data-question="17" data-answer="B">
                    <h4>17. ¿Qué tipo de flecha indica herencia en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Flecha simple</li>
                        <li data-option="B">B) Flecha con triángulo vacío</li>
                        <li data-option="C">C) Flecha punteada</li>
                        <li data-option="D">D) Flecha doble</li>
                    </ul>
                </div>

                <div class="question" data-question="18" data-answer="C">
                    <h4>18. ¿Cuándo es apropiado usar navegabilidad unidireccional?</h4>
                    <ul class="options">
                        <li data-option="A">A) Siempre</li>
                        <li data-option="B">B) Nunca</li>
                        <li data-option="C">C) Cuando solo una clase necesita conocer a la otra</li>
                        <li data-option="D">D) En relaciones de herencia</li>
                    </ul>
                </div>

                <div class="question" data-question="19" data-answer="C">
                    <h4>19. ¿Qué indica el estereotipo «enumeration»?</h4>
                    <ul class="options">
                        <li data-option="A">A) Una clase abstracta</li>
                        <li data-option="B">B) Una interfaz</li>
                        <li data-option="C">C) Un tipo con valores fijos predefinidos</li>
                        <li data-option="D">D) Una clase singleton</li>
                    </ul>
                </div>

                <div class="question" data-question="20" data-answer="C">
                    <h4>20. ¿Cuál es el beneficio principal de usar patrones de diseño?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases</li>
                        <li data-option="B">B) Aumentar la complejidad</li>
                        <li data-option="C">C) Proporcionar soluciones probadas a problemas recurrentes</li>
                        <li data-option="D">D) Eliminar la necesidad de documentación</li>
                    </ul>
                </div>
            </div>

            <div class="quiz-controls">
                <button id="submit-quiz" class="quiz-button">Ver Resultados</button>
                <button id="reset-quiz" class="quiz-button secondary" style="display: none;">Reiniciar Cuestionario</button>
            </div>

            <div id="quiz-results" class="quiz-results" style="display: none;">
                <h3>Resultados de la Evaluación</h3>
                <div class="results-summary">
                    <div class="score-circle">
                        <div class="score-text">
                            <span id="score-number">0</span>
                            <span class="score-total">/20</span>
                        </div>
                        <div class="score-percentage" id="score-percentage">0%</div>
                    </div>
                    <div class="score-message" id="score-message"></div>
                </div>
                <div class="answers-review" id="answers-review"></div>
            </div>
        </section>

        <!-- Referencias Bibliográficas -->
        <section class="section">
            <h2>Referencias Bibliográficas</h2>
            <ul role="list">
                <li role="listitem">Larman, C. (2003). <em>UML y Patrones: Una Introducción al Análisis y Diseño Orientado a Objetos y al Proceso Unificado</em>. Segunda edición. Pearson Educación.</li>
                <li role="listitem">Fowler, M. (1999). <em>UML gota a gota</em>. Pearson Educación.</li>
                <li role="listitem">Booch, G., Rumbaugh, J., & Jacobson, I. (2006). <em>El Lenguaje Unificado de Modelado. UML 2.0</em>. Addison-Wesley.</li>
                <li role="listitem">Cockburn, A. (2000). <em>Writing Effective Use Cases</em>. Addison-Wesley.</li>
                <li role="listitem">Pressman, R. (1998). <em>Ingeniería de Software: Un enfoque Práctico</em>. 4ª ed. McGraw-Hill.</li>
            </ul>
        </section>
    </div>

    <script>
        // Script para interactividad del cuestionario
        document.addEventListener('DOMContentLoaded', function() {
            // Variables globales
            const quizContainer = document.getElementById('quiz-container');
            const submitButton = document.getElementById('submit-quiz');
            const resetButton = document.getElementById('reset-quiz');
            const resultsDiv = document.getElementById('quiz-results');
            const scoreNumber = document.getElementById('score-number');
            const scorePercentage = document.getElementById('score-percentage');
            const scoreMessage = document.getElementById('score-message');
            const answersReview = document.getElementById('answers-review');
            
            // Estado del quiz
            let userAnswers = {};
            let quizSubmitted = false;

            // Manejar selección de respuestas
            const optionElements = document.querySelectorAll('.options li');
            optionElements.forEach(option => {
                option.addEventListener('click', function() {
                    if (quizSubmitted) return; // No permitir cambios después de enviar
                    
                    const questionDiv = this.closest('.question');
                    const questionNumber = questionDiv.dataset.question;
                    const selectedOption = this.dataset.option;
                    
                    // Eliminar selección previa
                    questionDiv.querySelectorAll('.options li').forEach(li => {
                        li.classList.remove('selected');
                    });
                    
                    // Agregar nueva selección
                    this.classList.add('selected');
                    questionDiv.classList.add('answered');
                    
                    // Guardar respuesta
                    userAnswers[questionNumber] = selectedOption;
                    
                    // Verificar si todas las preguntas fueron respondidas
                    checkAllAnswered();
                });
            });

            // Verificar si todas las preguntas fueron respondidas
            function checkAllAnswered() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions === totalQuestions) {
                    submitButton.style.background = '#27ae60';
                    submitButton.textContent = '¡Listo! Ver Resultados';
                }
            }

            // Manejar envío del quiz
            submitButton.addEventListener('click', function() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions < totalQuestions) {
                    alert(`Por favor responde todas las preguntas. Has respondido ${answeredQuestions} de ${totalQuestions}.`);
                    return;
                }
                
                // Calcular puntuación
                let correctAnswers = 0;
                const questions = document.querySelectorAll('.question');
                
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    
                    if (userAnswer === correctAnswer) {
                        correctAnswers++;
                    }
                });
                
                // Mostrar resultados
                showResults(correctAnswers, totalQuestions);
                quizSubmitted = true;
                
                // Cambiar botones
                submitButton.style.display = 'none';
                resetButton.style.display = 'inline-block';
                
                // Scroll a resultados
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Mostrar resultados
            function showResults(correct, total) {
                const percentage = Math.round((correct / total) * 100);
                
                // Mostrar puntuación
                scoreNumber.textContent = correct;
                scorePercentage.textContent = percentage + '%';
                
                // Mostrar mensaje según el resultado
                let message = '';
                let messageClass = '';
                
                if (percentage >= 90) {
                    message = '¡Excelente! Dominas muy bien los conceptos de UML.';
                    messageClass = 'excellent';
                } else if (percentage >= 70) {
                    message = '¡Muy bien! Tienes un buen conocimiento de UML.';
                    messageClass = 'good';
                } else if (percentage >= 50) {
                    message = 'Regular. Te recomendamos repasar algunos conceptos.';
                    messageClass = 'regular';
                } else {
                    message = 'Necesitas mejorar. Revisa el material de estudio nuevamente.';
                    messageClass = 'needs-improvement';
                }
                
                scoreMessage.textContent = message;
                scoreMessage.className = 'score-message ' + messageClass;
                
                // Mostrar revisión de respuestas
                showAnswersReview();
                
                // Mostrar div de resultados
                resultsDiv.style.display = 'block';
                
                // Animar el círculo de puntuación
                animateScore(percentage);
            }

            // Mostrar revisión de respuestas
            function showAnswersReview() {
                answersReview.innerHTML = '<h3>Revisión de Respuestas:</h3>';
                
                const questions = document.querySelectorAll('.question');
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    const isCorrect = userAnswer === correctAnswer;
                    
                    const reviewItem = document.createElement('div');
                    reviewItem.className = `answer-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    
                    const icon = isCorrect ? '✓' : '✗';
                    const text = isCorrect 
                        ? `Pregunta ${questionNumber}: Correcta (${userAnswer})`
                        : `Pregunta ${questionNumber}: Incorrecta - Tu respuesta: ${userAnswer}, Correcta: ${correctAnswer}`;
                    
                    reviewItem.innerHTML = `
                        <span class="answer-icon">${icon}</span>
                        <span>${text}</span>
                    `;
                    
                    answersReview.appendChild(reviewItem);
                    
                    // Marcar respuestas en el quiz original
                    const options = question.querySelectorAll('.options li');
                    options.forEach(option => {
                        if (option.dataset.option === correctAnswer) {
                            option.classList.add('correct');
                        } else if (option.dataset.option === userAnswer && !isCorrect) {
                            option.classList.add('incorrect');
                        }
                    });
                });
            }

            // Animar puntuación
            function animateScore(targetPercentage) {
                let currentPercentage = 0;
                const increment = targetPercentage / 50; // Animar en 50 pasos
                
                const animation = setInterval(() => {
                    currentPercentage += increment;
                    if (currentPercentage >= targetPercentage) {
                        currentPercentage = targetPercentage;
                        clearInterval(animation);
                    }
                    
                    // Actualizar color del círculo según el porcentaje
                    const scoreCircle = document.querySelector('.score-circle');
                    if (currentPercentage >= 90) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    } else if (currentPercentage >= 70) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #3498db, #5dade2)';
                    } else if (currentPercentage >= 50) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #f39c12, #f1c40f)';
                    } else {
                        scoreCircle.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    }
                }, 20);
            }

            // Reiniciar quiz
            resetButton.addEventListener('click', function() {
                // Reiniciar variables
                userAnswers = {};
                quizSubmitted = false;
                
                // Limpiar selecciones
                document.querySelectorAll('.options li').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                document.querySelectorAll('.question').forEach(question => {
                    question.classList.remove('answered');
                });
                
                // Ocultar resultados
                resultsDiv.style.display = 'none';
                
                // Cambiar botones
                submitButton.style.display = 'inline-block';
                submitButton.style.background = '';
                submitButton.textContent = 'Ver Resultados';
                resetButton.style.display = 'none';
                
                // Scroll al inicio del quiz
                quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Hacer que los diagramas SVG sean interactivos
            const svgDiagrams = document.querySelectorAll('.interactive-diagram');
            svgDiagrams.forEach(diagram => {
                diagram.addEventListener('click', function() {
                    // Aquí se puede agregar funcionalidad adicional
                    console.log('Diagrama clickeado');
                });
            });
        });
    </script>
    <script src="keyboard-navigation.js"></script>
</body>
</html></span>, <span class="self">self._numero</span>.replace(<span class="string">' '</span>, <span class="string">''</span>)):
            <span class="builtin">print</span>(<span class="string">"❌ Número de tarjeta inválido"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="comment"># Validar CVV</span>
        <span class="keyword">if</span> <span class="keyword">not</span> re.match(r<span class="string">'^\d{3,4}

            <h4>4.3.3 Patrón Template Method</h4>
            <p>Define el esqueleto de un algoritmo en una operación, delegando algunos pasos a las subclases. Template Method permite a las subclases redefinir ciertos pasos de un algoritmo sin cambiar su estructura.</p>

            <div class="concept-box">
                <h4>Estructura del Template Method:</h4>
                <ol role="list">
                    <li role="listitem">Una clase abstracta define el template method</li>
                    <li role="listitem">El template method llama a operaciones primitivas</li>
                    <li role="listitem">Las subclases implementan las operaciones primitivas</li>
                    <li role="listitem">El algoritmo general permanece inmutable</li>
                </ol>
            </div>

            <h3>4.4 Representación de Patrones en UML</h3>
            <p>Al documentar patrones en UML, es fundamental seguir convenciones que mejoren la comunicación y comprensión del diseño.</p>

            <div class="synoptic-table">
                <h4>Guía de Mejores Prácticas para Documentar Patrones:</h4>
                <table role="table">
                    <tr role="row">
                        <th role="columnheader">Aspecto</th>
                        <th role="columnheader">Recomendación</th>
                        <th role="columnheader">Ejemplo</th>
                    </tr>
                    <tr role="row">
                        <td role="cell">Estereotipos</td>
                        <td role="cell">Usar para identificar roles del patrón</td>
                        <td role="cell">«Singleton», «Factory», «Observer»</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Nombres</td>
                        <td role="cell">Incluir el nombre del patrón cuando sea claro</td>
                        <td role="cell">ConfigurationSingleton, PaymentStrategy</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Notas</td>
                        <td role="cell">Agregar notas UML explicando decisiones</td>
                        <td role="cell">"Este patrón permite cambiar el algoritmo en runtime"</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Colaboraciones</td>
                        <td role="cell">Incluir diagramas de secuencia</td>
                        <td role="cell">Mostrar flujo de llamadas entre objetos</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Multiplicidad</td>
                        <td role="cell">Ser preciso con las cardinalidades</td>
                        <td role="cell">Observer: 1 Subject → * Observers</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Interfaces</td>
                        <td role="cell">Usar interfaces para abstracciones</td>
                        <td role="cell">Marcar claramente con «interface»</td>
                    </tr>
                </table>
            </div>

            <h3>4.5 Combinación de Patrones</h3>
            <p>En sistemas reales, los patrones raramente aparecen aislados. Es común combinar múltiples patrones para resolver problemas complejos.</p>

            <div class="pattern-card">
                <h5>Ejemplos de Combinaciones Comunes:</h5>
                <ul role="list">
                    <li role="listitem"><strong>MVC:</strong> Combina Observer (Model-View) + Strategy (Controller) + Composite (View)</li>
                    <li role="listitem"><strong>Abstract Factory + Singleton:</strong> Fábricas únicas para familias de objetos</li>
                    <li role="listitem"><strong>Decorator + Factory Method:</strong> Crear decoradores dinámicamente</li>
                    <li role="listitem"><strong>Strategy + Template Method:</strong> Algoritmos intercambiables con estructura común</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>Anti-patrones a Evitar:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Singleton Overuse:</strong> No todo necesita ser singleton</li>
                    <li role="listitem"><strong>Pattern Obsession:</strong> No forzar patrones donde no son necesarios</li>
                    <li role="listitem"><strong>Premature Abstraction:</strong> No sobre-diseñar anticipando cambios futuros</li>
                    <li role="listitem"><strong>Copy-Paste Pattern:</strong> Entender el patrón, no solo copiar código</li>
                </ul>
            </div>

            <p>La representación efectiva de patrones en UML no solo documenta la solución técnica, sino que también comunica la intención del diseño, las decisiones arquitectónicas y facilita la comprensión y mantenimiento del sistema a largo plazo. El dominio de estos patrones y su correcta representación en UML es una habilidad fundamental para todo analista de sistemas.</p>
        </section>

        <!-- Resumen y Conclusiones -->
        <section class="section">
            <h2>Resumen y Conclusiones</h2>
            
            <div class="concept-box">
                <h3>Puntos Clave de la Clase:</h3>
                <ul role="list">
                    <li role="listitem">Los diagramas de clases UML son fundamentales para el modelado orientado a objetos</li>
                    <li role="listitem">La notación precisa es esencial para la comunicación efectiva</li>
                    <li role="listitem">Las relaciones entre clases expresan la estructura y colaboración del sistema</li>
                    <li role="listitem">Las técnicas sistemáticas de modelado mejoran la calidad del diseño</li>
                    <li role="listitem">Los patrones de diseño se documentan efectivamente usando UML</li>
                </ul>
            </div>

            <h3>Próximos Pasos</h3>
            <p>En la siguiente clase, exploraremos los Casos de Uso Avanzados, profundizando en la especificación según Cockburn y las relaciones complejas entre casos de uso.</p>
        </section>

        <!-- Sección de Evaluación -->
        <section class="quiz-section">
            <h2>Evaluación - 20 Preguntas</h2>
            <p class="quiz-instructions">Selecciona la respuesta correcta para cada pregunta. Al finalizar, presiona el botón "Ver Resultados" para conocer tu puntuación.</p>
            
            <div id="quiz-container">
                <div class="question" data-question="1" data-answer="B">
                    <h4>1. ¿Qué símbolo representa un atributo privado en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) ~</li>
                    </ul>
                </div>

                <div class="question" data-question="2" data-answer="B">
                    <h4>2. ¿Cuál es la diferencia visual entre agregación y composición?</h4>
                    <ul class="options">
                        <li data-option="A">A) La agregación usa un diamante relleno, la composición uno vacío</li>
                        <li data-option="B">B) La agregación usa un diamante vacío, la composición uno relleno</li>
                        <li data-option="C">C) Ambas usan el mismo símbolo</li>
                        <li data-option="D">D) La agregación no tiene símbolo especial</li>
                    </ul>
                </div>

                <div class="question" data-question="3" data-answer="C">
                    <h4>3. ¿Cuándo se usa una relación de dependencia?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cuando hay una relación permanente entre clases</li>
                        <li data-option="B">B) Cuando una clase hereda de otra</li>
                        <li data-option="C">C) Cuando el uso es temporal y no implica un atributo permanente</li>
                        <li data-option="D">D) Cuando las clases comparten atributos</li>
                    </ul>
                </div>

                <div class="question" data-question="4" data-answer="D">
                    <h4>4. ¿Qué representa una línea punteada con flecha en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Herencia</li>
                        <li data-option="B">B) Asociación</li>
                        <li data-option="C">C) Composición</li>
                        <li data-option="D">D) Dependencia o Realización</li>
                    </ul>
                </div>

                <div class="question" data-question="5" data-answer="B">
                    <h4>5. ¿Cómo se indica una clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Con el nombre en negrita</li>
                        <li data-option="B">B) Con el nombre en cursiva o estereotipo «abstract»</li>
                        <li data-option="C">C) Con un asterisco después del nombre</li>
                        <li data-option="D">D) Subrayando el nombre</li>
                    </ul>
                </div>

                <div class="question" data-question="6" data-answer="C">
                    <h4>6. ¿Qué significa la multiplicidad "1..*" en una asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cero o más</li>
                        <li data-option="B">B) Exactamente uno</li>
                        <li data-option="C">C) Uno o más</li>
                        <li data-option="D">D) Cero o uno</li>
                    </ul>
                </div>

                <div class="question" data-question="7" data-answer="B">
                    <h4>7. ¿Cuál es el propósito principal de una clase de asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases en el diagrama</li>
                        <li data-option="B">B) Modelar atributos y comportamiento de la relación misma</li>
                        <li data-option="C">C) Simplificar la herencia</li>
                        <li data-option="D">D) Eliminar dependencias</li>
                    </ul>
                </div>

                <div class="question" data-question="8" data-answer="B">
                    <h4>8. En el patrón Singleton, ¿qué característica es fundamental?</h4>
                    <ul class="options">
                        <li data-option="A">A) Múltiples constructores públicos</li>
                        <li data-option="B">B) Constructor privado y método getInstance() estático</li>
                        <li data-option="C">C) Herencia múltiple</li>
                        <li data-option="D">D) Implementación de varias interfaces</li>
                    </ul>
                </div>

                <div class="question" data-question="9" data-answer="B">
                    <h4>9. ¿Qué técnica usa sustantivos para identificar clases candidatas?</h4>
                    <ul class="options">
                        <li data-option="A">A) Análisis CRC</li>
                        <li data-option="B">B) Análisis lingüístico</li>
                        <li data-option="C">C) Análisis de patrones</li>
                        <li data-option="D">D) Análisis de casos de uso</li>
                    </ul>
                </div>

                <div class="question" data-question="10" data-answer="C">
                    <h4>10. ¿Cuál NO es una categoría típica de clases en el modelado?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cosas tangibles</li>
                        <li data-option="B">B) Roles</li>
                        <li data-option="C">C) Colores</li>
                        <li data-option="D">D) Eventos</li>
                    </ul>
                </div>

                <div class="question" data-question="11" data-answer="B">
                    <h4>11. ¿Qué significa CRC en las tarjetas CRC?</h4>
                    <ul class="options">
                        <li data-option="A">A) Create-Read-Copy</li>
                        <li data-option="B">B) Clase-Responsabilidad-Colaboración</li>
                        <li data-option="C">C) Control-Relación-Clase</li>
                        <li data-option="D">D) Concepto-Regla-Condición</li>
                    </ul>
                </div>

                <div class="question" data-question="12" data-answer="B">
                    <h4>12. ¿Cuál es la diferencia principal entre interfaz y clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) No hay diferencia</li>
                        <li data-option="B">B) Las interfaces solo tienen operaciones, no atributos</li>
                        <li data-option="C">C) Las clases abstractas no pueden tener métodos</li>
                        <li data-option="D">D) Las interfaces usan herencia múltiple</li>
                    </ul>
                </div>

                <div class="question" data-question="13" data-answer="D">
                    <h4>13. ¿Qué patrón define una familia de algoritmos intercambiables?</h4>
                    <ul class="options">
                        <li data-option="A">A) Singleton</li>
                        <li data-option="B">B) Factory</li>
                        <li data-option="C">C) Observer</li>
                        <li data-option="D">D) Strategy</li>
                    </ul>
                </div>

                <div class="question" data-question="14" data-answer="B">
                    <h4>14. En una relación de composición, ¿qué ocurre cuando se elimina el "todo"?</h4>
                    <ul class="options">
                        <li data-option="A">A) Las partes continúan existiendo</li>
                        <li data-option="B">B) Las partes también se eliminan</li>
                        <li data-option="C">C) Se convierten en agregación</li>
                        <li data-option="D">D) Se crea una nueva instancia</li>
                    </ul>
                </div>

                <div class="question" data-question="15" data-answer="C">
                    <h4>15. ¿Qué notación se usa para un método estático en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cursiva</li>
                        <li data-option="B">B) Negrita</li>
                        <li data-option="C">C) Subrayado</li>
                        <li data-option="D">D) Entre corchetes</li>
                    </ul>
                </div>

                <div class="question" data-question="16" data-answer="C">
                    <h4>16. ¿Cuál es el símbolo de visibilidad para "protegido"?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) *</li>
                    </ul>
                </div>

                <div class="question" data-question="17" data-answer="B">
                    <h4>17. ¿Qué tipo de flecha indica herencia en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Flecha simple</li>
                        <li data-option="B">B) Flecha con triángulo vacío</li>
                        <li data-option="C">C) Flecha punteada</li>
                        <li data-option="D">D) Flecha doble</li>
                    </ul>
                </div>

                <div class="question" data-question="18" data-answer="C">
                    <h4>18. ¿Cuándo es apropiado usar navegabilidad unidireccional?</h4>
                    <ul class="options">
                        <li data-option="A">A) Siempre</li>
                        <li data-option="B">B) Nunca</li>
                        <li data-option="C">C) Cuando solo una clase necesita conocer a la otra</li>
                        <li data-option="D">D) En relaciones de herencia</li>
                    </ul>
                </div>

                <div class="question" data-question="19" data-answer="C">
                    <h4>19. ¿Qué indica el estereotipo «enumeration»?</h4>
                    <ul class="options">
                        <li data-option="A">A) Una clase abstracta</li>
                        <li data-option="B">B) Una interfaz</li>
                        <li data-option="C">C) Un tipo con valores fijos predefinidos</li>
                        <li data-option="D">D) Una clase singleton</li>
                    </ul>
                </div>

                <div class="question" data-question="20" data-answer="C">
                    <h4>20. ¿Cuál es el beneficio principal de usar patrones de diseño?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases</li>
                        <li data-option="B">B) Aumentar la complejidad</li>
                        <li data-option="C">C) Proporcionar soluciones probadas a problemas recurrentes</li>
                        <li data-option="D">D) Eliminar la necesidad de documentación</li>
                    </ul>
                </div>
            </div>

            <div class="quiz-controls">
                <button id="submit-quiz" class="quiz-button">Ver Resultados</button>
                <button id="reset-quiz" class="quiz-button secondary" style="display: none;">Reiniciar Cuestionario</button>
            </div>

            <div id="quiz-results" class="quiz-results" style="display: none;">
                <h3>Resultados de la Evaluación</h3>
                <div class="results-summary">
                    <div class="score-circle">
                        <div class="score-text">
                            <span id="score-number">0</span>
                            <span class="score-total">/20</span>
                        </div>
                        <div class="score-percentage" id="score-percentage">0%</div>
                    </div>
                    <div class="score-message" id="score-message"></div>
                </div>
                <div class="answers-review" id="answers-review"></div>
            </div>
        </section>

        <!-- Referencias Bibliográficas -->
        <section class="section">
            <h2>Referencias Bibliográficas</h2>
            <ul role="list">
                <li role="listitem">Larman, C. (2003). <em>UML y Patrones: Una Introducción al Análisis y Diseño Orientado a Objetos y al Proceso Unificado</em>. Segunda edición. Pearson Educación.</li>
                <li role="listitem">Fowler, M. (1999). <em>UML gota a gota</em>. Pearson Educación.</li>
                <li role="listitem">Booch, G., Rumbaugh, J., & Jacobson, I. (2006). <em>El Lenguaje Unificado de Modelado. UML 2.0</em>. Addison-Wesley.</li>
                <li role="listitem">Cockburn, A. (2000). <em>Writing Effective Use Cases</em>. Addison-Wesley.</li>
                <li role="listitem">Pressman, R. (1998). <em>Ingeniería de Software: Un enfoque Práctico</em>. 4ª ed. McGraw-Hill.</li>
            </ul>
        </section>
    </div>

    <script>
        // Script para interactividad del cuestionario
        document.addEventListener('DOMContentLoaded', function() {
            // Variables globales
            const quizContainer = document.getElementById('quiz-container');
            const submitButton = document.getElementById('submit-quiz');
            const resetButton = document.getElementById('reset-quiz');
            const resultsDiv = document.getElementById('quiz-results');
            const scoreNumber = document.getElementById('score-number');
            const scorePercentage = document.getElementById('score-percentage');
            const scoreMessage = document.getElementById('score-message');
            const answersReview = document.getElementById('answers-review');
            
            // Estado del quiz
            let userAnswers = {};
            let quizSubmitted = false;

            // Manejar selección de respuestas
            const optionElements = document.querySelectorAll('.options li');
            optionElements.forEach(option => {
                option.addEventListener('click', function() {
                    if (quizSubmitted) return; // No permitir cambios después de enviar
                    
                    const questionDiv = this.closest('.question');
                    const questionNumber = questionDiv.dataset.question;
                    const selectedOption = this.dataset.option;
                    
                    // Eliminar selección previa
                    questionDiv.querySelectorAll('.options li').forEach(li => {
                        li.classList.remove('selected');
                    });
                    
                    // Agregar nueva selección
                    this.classList.add('selected');
                    questionDiv.classList.add('answered');
                    
                    // Guardar respuesta
                    userAnswers[questionNumber] = selectedOption;
                    
                    // Verificar si todas las preguntas fueron respondidas
                    checkAllAnswered();
                });
            });

            // Verificar si todas las preguntas fueron respondidas
            function checkAllAnswered() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions === totalQuestions) {
                    submitButton.style.background = '#27ae60';
                    submitButton.textContent = '¡Listo! Ver Resultados';
                }
            }

            // Manejar envío del quiz
            submitButton.addEventListener('click', function() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions < totalQuestions) {
                    alert(`Por favor responde todas las preguntas. Has respondido ${answeredQuestions} de ${totalQuestions}.`);
                    return;
                }
                
                // Calcular puntuación
                let correctAnswers = 0;
                const questions = document.querySelectorAll('.question');
                
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    
                    if (userAnswer === correctAnswer) {
                        correctAnswers++;
                    }
                });
                
                // Mostrar resultados
                showResults(correctAnswers, totalQuestions);
                quizSubmitted = true;
                
                // Cambiar botones
                submitButton.style.display = 'none';
                resetButton.style.display = 'inline-block';
                
                // Scroll a resultados
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Mostrar resultados
            function showResults(correct, total) {
                const percentage = Math.round((correct / total) * 100);
                
                // Mostrar puntuación
                scoreNumber.textContent = correct;
                scorePercentage.textContent = percentage + '%';
                
                // Mostrar mensaje según el resultado
                let message = '';
                let messageClass = '';
                
                if (percentage >= 90) {
                    message = '¡Excelente! Dominas muy bien los conceptos de UML.';
                    messageClass = 'excellent';
                } else if (percentage >= 70) {
                    message = '¡Muy bien! Tienes un buen conocimiento de UML.';
                    messageClass = 'good';
                } else if (percentage >= 50) {
                    message = 'Regular. Te recomendamos repasar algunos conceptos.';
                    messageClass = 'regular';
                } else {
                    message = 'Necesitas mejorar. Revisa el material de estudio nuevamente.';
                    messageClass = 'needs-improvement';
                }
                
                scoreMessage.textContent = message;
                scoreMessage.className = 'score-message ' + messageClass;
                
                // Mostrar revisión de respuestas
                showAnswersReview();
                
                // Mostrar div de resultados
                resultsDiv.style.display = 'block';
                
                // Animar el círculo de puntuación
                animateScore(percentage);
            }

            // Mostrar revisión de respuestas
            function showAnswersReview() {
                answersReview.innerHTML = '<h3>Revisión de Respuestas:</h3>';
                
                const questions = document.querySelectorAll('.question');
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    const isCorrect = userAnswer === correctAnswer;
                    
                    const reviewItem = document.createElement('div');
                    reviewItem.className = `answer-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    
                    const icon = isCorrect ? '✓' : '✗';
                    const text = isCorrect 
                        ? `Pregunta ${questionNumber}: Correcta (${userAnswer})`
                        : `Pregunta ${questionNumber}: Incorrecta - Tu respuesta: ${userAnswer}, Correcta: ${correctAnswer}`;
                    
                    reviewItem.innerHTML = `
                        <span class="answer-icon">${icon}</span>
                        <span>${text}</span>
                    `;
                    
                    answersReview.appendChild(reviewItem);
                    
                    // Marcar respuestas en el quiz original
                    const options = question.querySelectorAll('.options li');
                    options.forEach(option => {
                        if (option.dataset.option === correctAnswer) {
                            option.classList.add('correct');
                        } else if (option.dataset.option === userAnswer && !isCorrect) {
                            option.classList.add('incorrect');
                        }
                    });
                });
            }

            // Animar puntuación
            function animateScore(targetPercentage) {
                let currentPercentage = 0;
                const increment = targetPercentage / 50; // Animar en 50 pasos
                
                const animation = setInterval(() => {
                    currentPercentage += increment;
                    if (currentPercentage >= targetPercentage) {
                        currentPercentage = targetPercentage;
                        clearInterval(animation);
                    }
                    
                    // Actualizar color del círculo según el porcentaje
                    const scoreCircle = document.querySelector('.score-circle');
                    if (currentPercentage >= 90) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    } else if (currentPercentage >= 70) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #3498db, #5dade2)';
                    } else if (currentPercentage >= 50) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #f39c12, #f1c40f)';
                    } else {
                        scoreCircle.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    }
                }, 20);
            }

            // Reiniciar quiz
            resetButton.addEventListener('click', function() {
                // Reiniciar variables
                userAnswers = {};
                quizSubmitted = false;
                
                // Limpiar selecciones
                document.querySelectorAll('.options li').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                document.querySelectorAll('.question').forEach(question => {
                    question.classList.remove('answered');
                });
                
                // Ocultar resultados
                resultsDiv.style.display = 'none';
                
                // Cambiar botones
                submitButton.style.display = 'inline-block';
                submitButton.style.background = '';
                submitButton.textContent = 'Ver Resultados';
                resetButton.style.display = 'none';
                
                // Scroll al inicio del quiz
                quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Hacer que los diagramas SVG sean interactivos
            const svgDiagrams = document.querySelectorAll('.interactive-diagram');
            svgDiagrams.forEach(diagram => {
                diagram.addEventListener('click', function() {
                    // Aquí se puede agregar funcionalidad adicional
                    console.log('Diagrama clickeado');
                });
            });
        });
    </script>
    <script src="keyboard-navigation.js"></script>
</body>
</html></span>, <span class="self">self._cvv</span>):
            <span class="builtin">print</span>(<span class="string">"❌ CVV inválido"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="comment"># Validar fecha de expiración</span>
        <span class="keyword">try</span>:
            <span class="parameter">exp_date</span> = datetime.strptime(<span class="self">self._fecha_exp</span>, <span class="string">"%m/%y"</span>)
            <span class="keyword">if</span> <span class="parameter">exp_date</span> < datetime.now():
                <span class="builtin">print</span>(<span class="string">"❌ Tarjeta expirada"</span>)
                <span class="keyword">return</span> <span class="builtin">False</span>
        <span class="keyword">except</span> <span class="builtin">ValueError</span>:
            <span class="builtin">print</span>(<span class="string">"❌ Fecha de expiración inválida"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="keyword">return</span> <span class="builtin">True</span>
    
    <span class="keyword">def</span> <span class="function">pagar</span>(<span class="self">self</span>, <span class="parameter">monto</span>: <span class="builtin">float</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Procesar pago con tarjeta de crédito"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self</span>.validar():
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="keyword">if</span> <span class="parameter">monto</span> > <span class="self">self._limite</span>:
            <span class="builtin">print</span>(<span class="string">f"❌ Monto ${<span class="parameter">monto</span>:.2f} excede el límite de ${<span class="self">self._limite</span>:.2f}"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="comment"># Enmascarar número de tarjeta para mostrar</span>
        <span class="parameter">numero_enmascarado</span> = <span class="string">f"****-****-****-{<span class="self">self._numero</span>[-4:]}"</span>
        <span class="builtin">print</span>(<span class="string">f"💳 Procesando pago de ${<span class="parameter">monto</span>:.2f} con tarjeta {<span class="parameter">numero_enmascarado</span>}"</span>)
        <span class="builtin">print</span>(<span class="string">"✅ Pago aprobado con tarjeta de crédito"</span>)
        <span class="keyword">return</span> <span class="builtin">True</span>

<span class="keyword">class</span> <span class="class-name">PayPal</span>(<span class="class-name">PagoStrategy</span>):
    <span class="string">"""Estrategia de pago con PayPal"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">email</span>: <span class="builtin">str</span>, <span class="parameter">password</span>: <span class="builtin">str</span>):
        <span class="self">self._email</span> = <span class="parameter">email</span>
        <span class="self">self._password</span> = <span class="parameter">password</span>
        <span class="self">self._saldo</span> = <span class="number">1000.0</span>  <span class="comment"># Saldo simulado</span>
        <span class="self">self._autenticado</span> = <span class="builtin">False</span>
    
    <span class="keyword">def</span> <span class="function">validar</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Validar credenciales de PayPal"""</span>
        <span class="comment"># Validar formato de email</span>
        <span class="keyword">if</span> <span class="keyword">not</span> re.match(r<span class="string">'^[\w\.-]+@[\w\.-]+\.\w+

            <h4>4.3.3 Patrón Template Method</h4>
            <p>Define el esqueleto de un algoritmo en una operación, delegando algunos pasos a las subclases. Template Method permite a las subclases redefinir ciertos pasos de un algoritmo sin cambiar su estructura.</p>

            <div class="concept-box">
                <h4>Estructura del Template Method:</h4>
                <ol role="list">
                    <li role="listitem">Una clase abstracta define el template method</li>
                    <li role="listitem">El template method llama a operaciones primitivas</li>
                    <li role="listitem">Las subclases implementan las operaciones primitivas</li>
                    <li role="listitem">El algoritmo general permanece inmutable</li>
                </ol>
            </div>

            <h3>4.4 Representación de Patrones en UML</h3>
            <p>Al documentar patrones en UML, es fundamental seguir convenciones que mejoren la comunicación y comprensión del diseño.</p>

            <div class="synoptic-table">
                <h4>Guía de Mejores Prácticas para Documentar Patrones:</h4>
                <table role="table">
                    <tr role="row">
                        <th role="columnheader">Aspecto</th>
                        <th role="columnheader">Recomendación</th>
                        <th role="columnheader">Ejemplo</th>
                    </tr>
                    <tr role="row">
                        <td role="cell">Estereotipos</td>
                        <td role="cell">Usar para identificar roles del patrón</td>
                        <td role="cell">«Singleton», «Factory», «Observer»</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Nombres</td>
                        <td role="cell">Incluir el nombre del patrón cuando sea claro</td>
                        <td role="cell">ConfigurationSingleton, PaymentStrategy</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Notas</td>
                        <td role="cell">Agregar notas UML explicando decisiones</td>
                        <td role="cell">"Este patrón permite cambiar el algoritmo en runtime"</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Colaboraciones</td>
                        <td role="cell">Incluir diagramas de secuencia</td>
                        <td role="cell">Mostrar flujo de llamadas entre objetos</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Multiplicidad</td>
                        <td role="cell">Ser preciso con las cardinalidades</td>
                        <td role="cell">Observer: 1 Subject → * Observers</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Interfaces</td>
                        <td role="cell">Usar interfaces para abstracciones</td>
                        <td role="cell">Marcar claramente con «interface»</td>
                    </tr>
                </table>
            </div>

            <h3>4.5 Combinación de Patrones</h3>
            <p>En sistemas reales, los patrones raramente aparecen aislados. Es común combinar múltiples patrones para resolver problemas complejos.</p>

            <div class="pattern-card">
                <h5>Ejemplos de Combinaciones Comunes:</h5>
                <ul role="list">
                    <li role="listitem"><strong>MVC:</strong> Combina Observer (Model-View) + Strategy (Controller) + Composite (View)</li>
                    <li role="listitem"><strong>Abstract Factory + Singleton:</strong> Fábricas únicas para familias de objetos</li>
                    <li role="listitem"><strong>Decorator + Factory Method:</strong> Crear decoradores dinámicamente</li>
                    <li role="listitem"><strong>Strategy + Template Method:</strong> Algoritmos intercambiables con estructura común</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>Anti-patrones a Evitar:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Singleton Overuse:</strong> No todo necesita ser singleton</li>
                    <li role="listitem"><strong>Pattern Obsession:</strong> No forzar patrones donde no son necesarios</li>
                    <li role="listitem"><strong>Premature Abstraction:</strong> No sobre-diseñar anticipando cambios futuros</li>
                    <li role="listitem"><strong>Copy-Paste Pattern:</strong> Entender el patrón, no solo copiar código</li>
                </ul>
            </div>

            <p>La representación efectiva de patrones en UML no solo documenta la solución técnica, sino que también comunica la intención del diseño, las decisiones arquitectónicas y facilita la comprensión y mantenimiento del sistema a largo plazo. El dominio de estos patrones y su correcta representación en UML es una habilidad fundamental para todo analista de sistemas.</p>
        </section>

        <!-- Resumen y Conclusiones -->
        <section class="section">
            <h2>Resumen y Conclusiones</h2>
            
            <div class="concept-box">
                <h3>Puntos Clave de la Clase:</h3>
                <ul role="list">
                    <li role="listitem">Los diagramas de clases UML son fundamentales para el modelado orientado a objetos</li>
                    <li role="listitem">La notación precisa es esencial para la comunicación efectiva</li>
                    <li role="listitem">Las relaciones entre clases expresan la estructura y colaboración del sistema</li>
                    <li role="listitem">Las técnicas sistemáticas de modelado mejoran la calidad del diseño</li>
                    <li role="listitem">Los patrones de diseño se documentan efectivamente usando UML</li>
                </ul>
            </div>

            <h3>Próximos Pasos</h3>
            <p>En la siguiente clase, exploraremos los Casos de Uso Avanzados, profundizando en la especificación según Cockburn y las relaciones complejas entre casos de uso.</p>
        </section>

        <!-- Sección de Evaluación -->
        <section class="quiz-section">
            <h2>Evaluación - 20 Preguntas</h2>
            <p class="quiz-instructions">Selecciona la respuesta correcta para cada pregunta. Al finalizar, presiona el botón "Ver Resultados" para conocer tu puntuación.</p>
            
            <div id="quiz-container">
                <div class="question" data-question="1" data-answer="B">
                    <h4>1. ¿Qué símbolo representa un atributo privado en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) ~</li>
                    </ul>
                </div>

                <div class="question" data-question="2" data-answer="B">
                    <h4>2. ¿Cuál es la diferencia visual entre agregación y composición?</h4>
                    <ul class="options">
                        <li data-option="A">A) La agregación usa un diamante relleno, la composición uno vacío</li>
                        <li data-option="B">B) La agregación usa un diamante vacío, la composición uno relleno</li>
                        <li data-option="C">C) Ambas usan el mismo símbolo</li>
                        <li data-option="D">D) La agregación no tiene símbolo especial</li>
                    </ul>
                </div>

                <div class="question" data-question="3" data-answer="C">
                    <h4>3. ¿Cuándo se usa una relación de dependencia?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cuando hay una relación permanente entre clases</li>
                        <li data-option="B">B) Cuando una clase hereda de otra</li>
                        <li data-option="C">C) Cuando el uso es temporal y no implica un atributo permanente</li>
                        <li data-option="D">D) Cuando las clases comparten atributos</li>
                    </ul>
                </div>

                <div class="question" data-question="4" data-answer="D">
                    <h4>4. ¿Qué representa una línea punteada con flecha en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Herencia</li>
                        <li data-option="B">B) Asociación</li>
                        <li data-option="C">C) Composición</li>
                        <li data-option="D">D) Dependencia o Realización</li>
                    </ul>
                </div>

                <div class="question" data-question="5" data-answer="B">
                    <h4>5. ¿Cómo se indica una clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Con el nombre en negrita</li>
                        <li data-option="B">B) Con el nombre en cursiva o estereotipo «abstract»</li>
                        <li data-option="C">C) Con un asterisco después del nombre</li>
                        <li data-option="D">D) Subrayando el nombre</li>
                    </ul>
                </div>

                <div class="question" data-question="6" data-answer="C">
                    <h4>6. ¿Qué significa la multiplicidad "1..*" en una asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cero o más</li>
                        <li data-option="B">B) Exactamente uno</li>
                        <li data-option="C">C) Uno o más</li>
                        <li data-option="D">D) Cero o uno</li>
                    </ul>
                </div>

                <div class="question" data-question="7" data-answer="B">
                    <h4>7. ¿Cuál es el propósito principal de una clase de asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases en el diagrama</li>
                        <li data-option="B">B) Modelar atributos y comportamiento de la relación misma</li>
                        <li data-option="C">C) Simplificar la herencia</li>
                        <li data-option="D">D) Eliminar dependencias</li>
                    </ul>
                </div>

                <div class="question" data-question="8" data-answer="B">
                    <h4>8. En el patrón Singleton, ¿qué característica es fundamental?</h4>
                    <ul class="options">
                        <li data-option="A">A) Múltiples constructores públicos</li>
                        <li data-option="B">B) Constructor privado y método getInstance() estático</li>
                        <li data-option="C">C) Herencia múltiple</li>
                        <li data-option="D">D) Implementación de varias interfaces</li>
                    </ul>
                </div>

                <div class="question" data-question="9" data-answer="B">
                    <h4>9. ¿Qué técnica usa sustantivos para identificar clases candidatas?</h4>
                    <ul class="options">
                        <li data-option="A">A) Análisis CRC</li>
                        <li data-option="B">B) Análisis lingüístico</li>
                        <li data-option="C">C) Análisis de patrones</li>
                        <li data-option="D">D) Análisis de casos de uso</li>
                    </ul>
                </div>

                <div class="question" data-question="10" data-answer="C">
                    <h4>10. ¿Cuál NO es una categoría típica de clases en el modelado?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cosas tangibles</li>
                        <li data-option="B">B) Roles</li>
                        <li data-option="C">C) Colores</li>
                        <li data-option="D">D) Eventos</li>
                    </ul>
                </div>

                <div class="question" data-question="11" data-answer="B">
                    <h4>11. ¿Qué significa CRC en las tarjetas CRC?</h4>
                    <ul class="options">
                        <li data-option="A">A) Create-Read-Copy</li>
                        <li data-option="B">B) Clase-Responsabilidad-Colaboración</li>
                        <li data-option="C">C) Control-Relación-Clase</li>
                        <li data-option="D">D) Concepto-Regla-Condición</li>
                    </ul>
                </div>

                <div class="question" data-question="12" data-answer="B">
                    <h4>12. ¿Cuál es la diferencia principal entre interfaz y clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) No hay diferencia</li>
                        <li data-option="B">B) Las interfaces solo tienen operaciones, no atributos</li>
                        <li data-option="C">C) Las clases abstractas no pueden tener métodos</li>
                        <li data-option="D">D) Las interfaces usan herencia múltiple</li>
                    </ul>
                </div>

                <div class="question" data-question="13" data-answer="D">
                    <h4>13. ¿Qué patrón define una familia de algoritmos intercambiables?</h4>
                    <ul class="options">
                        <li data-option="A">A) Singleton</li>
                        <li data-option="B">B) Factory</li>
                        <li data-option="C">C) Observer</li>
                        <li data-option="D">D) Strategy</li>
                    </ul>
                </div>

                <div class="question" data-question="14" data-answer="B">
                    <h4>14. En una relación de composición, ¿qué ocurre cuando se elimina el "todo"?</h4>
                    <ul class="options">
                        <li data-option="A">A) Las partes continúan existiendo</li>
                        <li data-option="B">B) Las partes también se eliminan</li>
                        <li data-option="C">C) Se convierten en agregación</li>
                        <li data-option="D">D) Se crea una nueva instancia</li>
                    </ul>
                </div>

                <div class="question" data-question="15" data-answer="C">
                    <h4>15. ¿Qué notación se usa para un método estático en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cursiva</li>
                        <li data-option="B">B) Negrita</li>
                        <li data-option="C">C) Subrayado</li>
                        <li data-option="D">D) Entre corchetes</li>
                    </ul>
                </div>

                <div class="question" data-question="16" data-answer="C">
                    <h4>16. ¿Cuál es el símbolo de visibilidad para "protegido"?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) *</li>
                    </ul>
                </div>

                <div class="question" data-question="17" data-answer="B">
                    <h4>17. ¿Qué tipo de flecha indica herencia en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Flecha simple</li>
                        <li data-option="B">B) Flecha con triángulo vacío</li>
                        <li data-option="C">C) Flecha punteada</li>
                        <li data-option="D">D) Flecha doble</li>
                    </ul>
                </div>

                <div class="question" data-question="18" data-answer="C">
                    <h4>18. ¿Cuándo es apropiado usar navegabilidad unidireccional?</h4>
                    <ul class="options">
                        <li data-option="A">A) Siempre</li>
                        <li data-option="B">B) Nunca</li>
                        <li data-option="C">C) Cuando solo una clase necesita conocer a la otra</li>
                        <li data-option="D">D) En relaciones de herencia</li>
                    </ul>
                </div>

                <div class="question" data-question="19" data-answer="C">
                    <h4>19. ¿Qué indica el estereotipo «enumeration»?</h4>
                    <ul class="options">
                        <li data-option="A">A) Una clase abstracta</li>
                        <li data-option="B">B) Una interfaz</li>
                        <li data-option="C">C) Un tipo con valores fijos predefinidos</li>
                        <li data-option="D">D) Una clase singleton</li>
                    </ul>
                </div>

                <div class="question" data-question="20" data-answer="C">
                    <h4>20. ¿Cuál es el beneficio principal de usar patrones de diseño?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases</li>
                        <li data-option="B">B) Aumentar la complejidad</li>
                        <li data-option="C">C) Proporcionar soluciones probadas a problemas recurrentes</li>
                        <li data-option="D">D) Eliminar la necesidad de documentación</li>
                    </ul>
                </div>
            </div>

            <div class="quiz-controls">
                <button id="submit-quiz" class="quiz-button">Ver Resultados</button>
                <button id="reset-quiz" class="quiz-button secondary" style="display: none;">Reiniciar Cuestionario</button>
            </div>

            <div id="quiz-results" class="quiz-results" style="display: none;">
                <h3>Resultados de la Evaluación</h3>
                <div class="results-summary">
                    <div class="score-circle">
                        <div class="score-text">
                            <span id="score-number">0</span>
                            <span class="score-total">/20</span>
                        </div>
                        <div class="score-percentage" id="score-percentage">0%</div>
                    </div>
                    <div class="score-message" id="score-message"></div>
                </div>
                <div class="answers-review" id="answers-review"></div>
            </div>
        </section>

        <!-- Referencias Bibliográficas -->
        <section class="section">
            <h2>Referencias Bibliográficas</h2>
            <ul role="list">
                <li role="listitem">Larman, C. (2003). <em>UML y Patrones: Una Introducción al Análisis y Diseño Orientado a Objetos y al Proceso Unificado</em>. Segunda edición. Pearson Educación.</li>
                <li role="listitem">Fowler, M. (1999). <em>UML gota a gota</em>. Pearson Educación.</li>
                <li role="listitem">Booch, G., Rumbaugh, J., & Jacobson, I. (2006). <em>El Lenguaje Unificado de Modelado. UML 2.0</em>. Addison-Wesley.</li>
                <li role="listitem">Cockburn, A. (2000). <em>Writing Effective Use Cases</em>. Addison-Wesley.</li>
                <li role="listitem">Pressman, R. (1998). <em>Ingeniería de Software: Un enfoque Práctico</em>. 4ª ed. McGraw-Hill.</li>
            </ul>
        </section>
    </div>

    <script>
        // Script para interactividad del cuestionario
        document.addEventListener('DOMContentLoaded', function() {
            // Variables globales
            const quizContainer = document.getElementById('quiz-container');
            const submitButton = document.getElementById('submit-quiz');
            const resetButton = document.getElementById('reset-quiz');
            const resultsDiv = document.getElementById('quiz-results');
            const scoreNumber = document.getElementById('score-number');
            const scorePercentage = document.getElementById('score-percentage');
            const scoreMessage = document.getElementById('score-message');
            const answersReview = document.getElementById('answers-review');
            
            // Estado del quiz
            let userAnswers = {};
            let quizSubmitted = false;

            // Manejar selección de respuestas
            const optionElements = document.querySelectorAll('.options li');
            optionElements.forEach(option => {
                option.addEventListener('click', function() {
                    if (quizSubmitted) return; // No permitir cambios después de enviar
                    
                    const questionDiv = this.closest('.question');
                    const questionNumber = questionDiv.dataset.question;
                    const selectedOption = this.dataset.option;
                    
                    // Eliminar selección previa
                    questionDiv.querySelectorAll('.options li').forEach(li => {
                        li.classList.remove('selected');
                    });
                    
                    // Agregar nueva selección
                    this.classList.add('selected');
                    questionDiv.classList.add('answered');
                    
                    // Guardar respuesta
                    userAnswers[questionNumber] = selectedOption;
                    
                    // Verificar si todas las preguntas fueron respondidas
                    checkAllAnswered();
                });
            });

            // Verificar si todas las preguntas fueron respondidas
            function checkAllAnswered() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions === totalQuestions) {
                    submitButton.style.background = '#27ae60';
                    submitButton.textContent = '¡Listo! Ver Resultados';
                }
            }

            // Manejar envío del quiz
            submitButton.addEventListener('click', function() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions < totalQuestions) {
                    alert(`Por favor responde todas las preguntas. Has respondido ${answeredQuestions} de ${totalQuestions}.`);
                    return;
                }
                
                // Calcular puntuación
                let correctAnswers = 0;
                const questions = document.querySelectorAll('.question');
                
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    
                    if (userAnswer === correctAnswer) {
                        correctAnswers++;
                    }
                });
                
                // Mostrar resultados
                showResults(correctAnswers, totalQuestions);
                quizSubmitted = true;
                
                // Cambiar botones
                submitButton.style.display = 'none';
                resetButton.style.display = 'inline-block';
                
                // Scroll a resultados
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Mostrar resultados
            function showResults(correct, total) {
                const percentage = Math.round((correct / total) * 100);
                
                // Mostrar puntuación
                scoreNumber.textContent = correct;
                scorePercentage.textContent = percentage + '%';
                
                // Mostrar mensaje según el resultado
                let message = '';
                let messageClass = '';
                
                if (percentage >= 90) {
                    message = '¡Excelente! Dominas muy bien los conceptos de UML.';
                    messageClass = 'excellent';
                } else if (percentage >= 70) {
                    message = '¡Muy bien! Tienes un buen conocimiento de UML.';
                    messageClass = 'good';
                } else if (percentage >= 50) {
                    message = 'Regular. Te recomendamos repasar algunos conceptos.';
                    messageClass = 'regular';
                } else {
                    message = 'Necesitas mejorar. Revisa el material de estudio nuevamente.';
                    messageClass = 'needs-improvement';
                }
                
                scoreMessage.textContent = message;
                scoreMessage.className = 'score-message ' + messageClass;
                
                // Mostrar revisión de respuestas
                showAnswersReview();
                
                // Mostrar div de resultados
                resultsDiv.style.display = 'block';
                
                // Animar el círculo de puntuación
                animateScore(percentage);
            }

            // Mostrar revisión de respuestas
            function showAnswersReview() {
                answersReview.innerHTML = '<h3>Revisión de Respuestas:</h3>';
                
                const questions = document.querySelectorAll('.question');
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    const isCorrect = userAnswer === correctAnswer;
                    
                    const reviewItem = document.createElement('div');
                    reviewItem.className = `answer-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    
                    const icon = isCorrect ? '✓' : '✗';
                    const text = isCorrect 
                        ? `Pregunta ${questionNumber}: Correcta (${userAnswer})`
                        : `Pregunta ${questionNumber}: Incorrecta - Tu respuesta: ${userAnswer}, Correcta: ${correctAnswer}`;
                    
                    reviewItem.innerHTML = `
                        <span class="answer-icon">${icon}</span>
                        <span>${text}</span>
                    `;
                    
                    answersReview.appendChild(reviewItem);
                    
                    // Marcar respuestas en el quiz original
                    const options = question.querySelectorAll('.options li');
                    options.forEach(option => {
                        if (option.dataset.option === correctAnswer) {
                            option.classList.add('correct');
                        } else if (option.dataset.option === userAnswer && !isCorrect) {
                            option.classList.add('incorrect');
                        }
                    });
                });
            }

            // Animar puntuación
            function animateScore(targetPercentage) {
                let currentPercentage = 0;
                const increment = targetPercentage / 50; // Animar en 50 pasos
                
                const animation = setInterval(() => {
                    currentPercentage += increment;
                    if (currentPercentage >= targetPercentage) {
                        currentPercentage = targetPercentage;
                        clearInterval(animation);
                    }
                    
                    // Actualizar color del círculo según el porcentaje
                    const scoreCircle = document.querySelector('.score-circle');
                    if (currentPercentage >= 90) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    } else if (currentPercentage >= 70) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #3498db, #5dade2)';
                    } else if (currentPercentage >= 50) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #f39c12, #f1c40f)';
                    } else {
                        scoreCircle.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    }
                }, 20);
            }

            // Reiniciar quiz
            resetButton.addEventListener('click', function() {
                // Reiniciar variables
                userAnswers = {};
                quizSubmitted = false;
                
                // Limpiar selecciones
                document.querySelectorAll('.options li').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                document.querySelectorAll('.question').forEach(question => {
                    question.classList.remove('answered');
                });
                
                // Ocultar resultados
                resultsDiv.style.display = 'none';
                
                // Cambiar botones
                submitButton.style.display = 'inline-block';
                submitButton.style.background = '';
                submitButton.textContent = 'Ver Resultados';
                resetButton.style.display = 'none';
                
                // Scroll al inicio del quiz
                quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Hacer que los diagramas SVG sean interactivos
            const svgDiagrams = document.querySelectorAll('.interactive-diagram');
            svgDiagrams.forEach(diagram => {
                diagram.addEventListener('click', function() {
                    // Aquí se puede agregar funcionalidad adicional
                    console.log('Diagrama clickeado');
                });
            });
        });
    </script>
    <script src="keyboard-navigation.js"></script>
</body>
</html></span>, <span class="self">self._email</span>):
            <span class="builtin">print</span>(<span class="string">"❌ Email inválido"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="comment"># Simular autenticación</span>
        <span class="keyword">if</span> <span class="builtin">len</span>(<span class="self">self._password</span>) >= <span class="number">6</span>:
            <span class="self">self._autenticado</span> = <span class="builtin">True</span>
            <span class="keyword">return</span> <span class="builtin">True</span>
        
        <span class="builtin">print</span>(<span class="string">"❌ Contraseña incorrecta"</span>)
        <span class="keyword">return</span> <span class="builtin">False</span>
    
    <span class="keyword">def</span> <span class="function">pagar</span>(<span class="self">self</span>, <span class="parameter">monto</span>: <span class="builtin">float</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Procesar pago con PayPal"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self</span>.validar():
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="keyword">if</span> <span class="parameter">monto</span> > <span class="self">self._saldo</span>:
            <span class="builtin">print</span>(<span class="string">f"❌ Saldo insuficiente. Saldo actual: ${<span class="self">self._saldo</span>:.2f}"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="builtin">print</span>(<span class="string">f"🅿️ Procesando pago de ${<span class="parameter">monto</span>:.2f} con PayPal ({<span class="self">self._email</span>})"</span>)
        <span class="self">self._saldo</span> -= <span class="parameter">monto</span>
        <span class="builtin">print</span>(<span class="string">f"✅ Pago aprobado. Saldo restante: ${<span class="self">self._saldo</span>:.2f}"</span>)
        <span class="keyword">return</span> <span class="builtin">True</span>

<span class="keyword">class</span> <span class="class-name">Bitcoin</span>(<span class="class-name">PagoStrategy</span>):
    <span class="string">"""Estrategia de pago con Bitcoin"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">wallet_address</span>: <span class="builtin">str</span>):
        <span class="self">self._wallet</span> = <span class="parameter">wallet_address</span>
        <span class="self">self._balance_btc</span> = <span class="number">0.05</span>  <span class="comment"># Balance simulado en BTC</span>
        <span class="self">self._btc_to_usd</span> = <span class="number">45000.0</span>  <span class="comment"># Tasa de cambio simulada</span>
    
    <span class="keyword">def</span> <span class="function">validar</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Validar dirección de wallet"""</span>
        <span class="comment"># Validación simplificada de dirección Bitcoin</span>
        <span class="keyword">if</span> <span class="builtin">len</span>(<span class="self">self._wallet</span>) >= <span class="number">26</span> <span class="keyword">and</span> <span class="builtin">len</span>(<span class="self">self._wallet</span>) <= <span class="number">35</span>:
            <span class="keyword">return</span> <span class="builtin">True</span>
        
        <span class="builtin">print</span>(<span class="string">"❌ Dirección de wallet inválida"</span>)
        <span class="keyword">return</span> <span class="builtin">False</span>
    
    <span class="keyword">def</span> <span class="function">pagar</span>(<span class="self">self</span>, <span class="parameter">monto</span>: <span class="builtin">float</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Procesar pago con Bitcoin"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self</span>.validar():
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="parameter">monto_btc</span> = <span class="parameter">monto</span> / <span class="self">self._btc_to_usd</span>
        
        <span class="keyword">if</span> <span class="parameter">monto_btc</span> > <span class="self">self._balance_btc</span>:
            <span class="builtin">print</span>(<span class="string">f"❌ Balance insuficiente. Balance: {<span class="self">self._balance_btc</span>:.4f} BTC"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="builtin">print</span>(<span class="string">f"₿ Procesando pago de ${<span class="parameter">monto</span>:.2f} ({<span class="parameter">monto_btc</span>:.6f} BTC)"</span>)
        <span class="builtin">print</span>(<span class="string">f"📤 Desde wallet: {<span class="self">self._wallet</span>[:8]}...{<span class="self">self._wallet</span>[-4:]}"</span>)
        <span class="self">self._balance_btc</span> -= <span class="parameter">monto_btc</span>
        <span class="builtin">print</span>(<span class="string">f"✅ Transacción confirmada. Balance: {<span class="self">self._balance_btc</span>:.6f} BTC"</span>)
        <span class="keyword">return</span> <span class="builtin">True</span>

<span class="keyword">class</span> <span class="class-name">TransferenciaBancaria</span>(<span class="class-name">PagoStrategy</span>):
    <span class="string">"""Estrategia de pago con transferencia bancaria"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">numero_cuenta</span>: <span class="builtin">str</span>, <span class="parameter">banco</span>: <span class="builtin">str</span>):
        <span class="self">self._numero_cuenta</span> = <span class="parameter">numero_cuenta</span>
        <span class="self">self._banco</span> = <span class="parameter">banco</span>
        <span class="self">self._saldo</span> = <span class="number">3000.0</span>  <span class="comment"># Saldo simulado</span>
    
    <span class="keyword">def</span> <span class="function">validar</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Validar datos bancarios"""</span>
        <span class="keyword">if</span> <span class="builtin">len</span>(<span class="self">self._numero_cuenta</span>) != <span class="number">20</span>:
            <span class="builtin">print</span>(<span class="string">"❌ Número de cuenta inválido"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        <span class="keyword">return</span> <span class="builtin">True</span>
    
    <span class="keyword">def</span> <span class="function">pagar</span>(<span class="self">self</span>, <span class="parameter">monto</span>: <span class="builtin">float</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Procesar transferencia bancaria"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self</span>.validar():
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="keyword">if</span> <span class="parameter">monto</span> > <span class="self">self._saldo</span>:
            <span class="builtin">print</span>(<span class="string">f"❌ Saldo insuficiente en cuenta bancaria"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="builtin">print</span>(<span class="string">f"🏦 Procesando transferencia de ${<span class="parameter">monto</span>:.2f}"</span>)
        <span class="builtin">print</span>(<span class="string">f"   Banco: {<span class="self">self._banco</span>}"</span>)
        <span class="builtin">print</span>(<span class="string">f"   Cuenta: ****{<span class="self">self._numero_cuenta</span>[-4:]}"</span>)
        <span class="self">self._saldo</span> -= <span class="parameter">monto</span>
        <span class="builtin">print</span>(<span class="string">"✅ Transferencia completada"</span>)
        <span class="keyword">return</span> <span class="builtin">True</span>

<span class="comment"># Context</span>
<span class="keyword">class</span> <span class="class-name">Item</span>:
    <span class="string">"""Clase para representar un item del carrito"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, <span class="parameter">nombre</span>: <span class="builtin">str</span>, <span class="parameter">precio</span>: <span class="builtin">float</span>, <span class="parameter">cantidad</span>: <span class="builtin">int</span> = <span class="number">1</span>):
        <span class="self">self.nombre</span> = <span class="parameter">nombre</span>
        <span class="self">self.precio</span> = <span class="parameter">precio</span>
        <span class="self">self.cantidad</span> = <span class="parameter">cantidad</span>
    
    <span class="keyword">def</span> <span class="function">get_total</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="keyword">return</span> <span class="self">self.precio</span> * <span class="self">self.cantidad</span>

<span class="keyword">class</span> <span class="class-name">CarritoCompras</span>:
    <span class="string">"""Context que usa las estrategias de pago"""</span>
    
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>):
        <span class="self">self._items</span>: List[<span class="class-name">Item</span>] = []
        <span class="self">self._estrategia_pago</span>: <span class="class-name">PagoStrategy</span> = <span class="builtin">None</span>
    
    <span class="keyword">def</span> <span class="function">agregar_item</span>(<span class="self">self</span>, <span class="parameter">item</span>: <span class="class-name">Item</span>):
        <span class="string">"""Agregar item al carrito"""</span>
        <span class="self">self._items</span>.append(<span class="parameter">item</span>)
        <span class="builtin">print</span>(<span class="string">f"➕ Agregado: {<span class="parameter">item</span>.nombre} x{<span class="parameter">item</span>.cantidad} - "</span>
              <span class="string">f"${<span class="parameter">item</span>.precio:.2f} c/u"</span>)
    
    <span class="keyword">def</span> <span class="function">set_estrategia_pago</span>(<span class="self">self</span>, <span class="parameter">estrategia</span>: <span class="class-name">PagoStrategy</span>):
        <span class="string">"""Establecer la estrategia de pago"""</span>
        <span class="self">self._estrategia_pago</span> = <span class="parameter">estrategia</span>
        <span class="builtin">print</span>(<span class="string">f"💰 Método de pago seleccionado: "</span>
              <span class="string">f"{<span class="parameter">estrategia</span>.__class__.__name__}"</span>)
    
    <span class="keyword">def</span> <span class="function">calcular_total</span>(<span class="self">self</span>) -> <span class="builtin">float</span>:
        <span class="string">"""Calcular el total del carrito"""</span>
        <span class="keyword">return</span> <span class="builtin">sum</span>(<span class="parameter">item</span>.get_total() <span class="keyword">for</span> <span class="parameter">item</span> <span class="keyword">in</span> <span class="self">self._items</span>)
    
    <span class="keyword">def</span> <span class="function">mostrar_resumen</span>(<span class="self">self</span>):
        <span class="string">"""Mostrar resumen del carrito"""</span>
        <span class="builtin">print</span>(<span class="string">"\n📋 RESUMEN DEL CARRITO:"</span>)
        <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)
        <span class="keyword">for</span> <span class="parameter">item</span> <span class="keyword">in</span> <span class="self">self._items</span>:
            <span class="builtin">print</span>(<span class="string">f"{<span class="parameter">item</span>.nombre} x{<span class="parameter">item</span>.cantidad}: "</span>
                  <span class="string">f"${<span class="parameter">item</span>.get_total():.2f}"</span>)
        <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)
        <span class="builtin">print</span>(<span class="string">f"TOTAL: ${<span class="self">self</span>.calcular_total():.2f}"</span>)
        <span class="builtin">print</span>(<span class="string">"-"</span> * <span class="number">40</span>)
    
    <span class="keyword">def</span> <span class="function">pagar</span>(<span class="self">self</span>) -> <span class="builtin">bool</span>:
        <span class="string">"""Procesar el pago usando la estrategia seleccionada"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self._estrategia_pago</span>:
            <span class="builtin">print</span>(<span class="string">"❌ No se ha seleccionado método de pago"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="keyword">if</span> <span class="keyword">not</span> <span class="self">self._items</span>:
            <span class="builtin">print</span>(<span class="string">"❌ El carrito está vacío"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>
        
        <span class="self">self</span>.mostrar_resumen()
        <span class="parameter">total</span> = <span class="self">self</span>.calcular_total()
        
        <span class="builtin">print</span>(<span class="string">"\n💳 PROCESANDO PAGO..."</span>)
        <span class="keyword">if</span> <span class="self">self._estrategia_pago</span>.pagar(<span class="parameter">total</span>):
            <span class="self">self._items</span>.clear()  <span class="comment"># Vaciar carrito después del pago</span>
            <span class="builtin">print</span>(<span class="string">"\n🎉 ¡Compra completada con éxito!"</span>)
            <span class="keyword">return</span> <span class="builtin">True</span>
        <span class="keyword">else</span>:
            <span class="builtin">print</span>(<span class="string">"\n😞 La compra no pudo ser completada"</span>)
            <span class="keyword">return</span> <span class="builtin">False</span>

<span class="comment"># Uso del patrón Strategy</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="builtin">print</span>(<span class="string">"🛒 SISTEMA DE COMPRAS EN LÍNEA"</span>)
    <span class="builtin">print</span>(<span class="string">"="</span> * <span class="number">50</span>)
    
    <span class="comment"># Crear carrito y agregar items</span>
    <span class="parameter">carrito</span> = <span class="class-name">CarritoCompras</span>()
    <span class="parameter">carrito</span>.agregar_item(<span class="class-name">Item</span>(<span class="string">"Laptop"</span>, <span class="number">899.99</span>))
    <span class="parameter">carrito</span>.agregar_item(<span class="class-name">Item</span>(<span class="string">"Mouse"</span>, <span class="number">29.99</span>, <span class="number">2</span>))
    <span class="parameter">carrito</span>.agregar_item(<span class="class-name">Item</span>(<span class="string">"Teclado"</span>, <span class="number">79.99</span>))
    
    <span class="comment"># Probar diferentes estrategias de pago</span>
    <span class="builtin">print</span>(<span class="string">"\n--- PAGO CON TARJETA DE CRÉDITO ---"</span>)
    <span class="parameter">tarjeta</span> = <span class="class-name">TarjetaCredito</span>(<span class="string">"1234567812345678"</span>, <span class="string">"123"</span>, <span class="string">"12/25"</span>)
    <span class="parameter">carrito</span>.set_estrategia_pago(<span class="parameter">tarjeta</span>)
    <span class="parameter">carrito</span>.pagar()
    
    <span class="comment"># Nuevo carrito con PayPal</span>
    <span class="builtin">print</span>(<span class="string">"\n\n--- PAGO CON PAYPAL ---"</span>)
    <span class="parameter">carrito2</span> = <span class="class-name">CarritoCompras</span>()
    <span class="parameter">carrito2</span>.agregar_item(<span class="class-name">Item</span>(<span class="string">"Auriculares"</span>, <span class="number">149.99</span>))
    <span class="parameter">carrito2</span>.agregar_item(<span class="class-name">Item</span>(<span class="string">"Cable USB"</span>, <span class="number">9.99</span>, <span class="number">3</span>))
    
    <span class="parameter">paypal</span> = <span class="class-name">PayPal</span>(<span class="string">"usuario@email.com"</span>, <span class="string">"password123"</span>)
    <span class="parameter">carrito2</span>.set_estrategia_pago(<span class="parameter">paypal</span>)
    <span class="parameter">carrito2</span>.pagar()
    
    <span class="comment"># Cambiar estrategia en tiempo de ejecución</span>
    <span class="builtin">print</span>(<span class="string">"\n\n--- CAMBIO DE MÉTODO DE PAGO ---"</span>)
    <span class="parameter">carrito3</span> = <span class="class-name">CarritoCompras</span>()
    <span class="parameter">carrito3</span>.agregar_item(<span class="class-name">Item</span>(<span class="string">"Monitor"</span>, <span class="number">299.99</span>))
    
    <span class="comment"># Primero intenta con Bitcoin</span>
    <span class="parameter">bitcoin</span> = <span class="class-name">Bitcoin</span>(<span class="string">"1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"</span>)
    <span class="parameter">carrito3</span>.set_estrategia_pago(<span class="parameter">bitcoin</span>)
    
    <span class="comment"># Luego cambia a transferencia bancaria</span>
    <span class="builtin">print</span>(<span class="string">"\n🔄 Cambiando método de pago..."</span>)
    <span class="parameter">transferencia</span> = <span class="class-name">TransferenciaBancaria</span>(<span class="string">"12345678901234567890"</span>, <span class="string">"Banco Nacional"</span>)
    <span class="parameter">carrito3</span>.set_estrategia_pago(<span class="parameter">transferencia</span>)
    <span class="parameter">carrito3</span>.pagar()</pre>
            </div>

            <h4>4.3.3 Patrón Template Method</h4>
            <p>Define el esqueleto de un algoritmo en una operación, delegando algunos pasos a las subclases. Template Method permite a las subclases redefinir ciertos pasos de un algoritmo sin cambiar su estructura.</p>

            <div class="concept-box">
                <h4>Estructura del Template Method:</h4>
                <ol role="list">
                    <li role="listitem">Una clase abstracta define el template method</li>
                    <li role="listitem">El template method llama a operaciones primitivas</li>
                    <li role="listitem">Las subclases implementan las operaciones primitivas</li>
                    <li role="listitem">El algoritmo general permanece inmutable</li>
                </ol>
            </div>

            <h3>4.4 Representación de Patrones en UML</h3>
            <p>Al documentar patrones en UML, es fundamental seguir convenciones que mejoren la comunicación y comprensión del diseño.</p>

            <div class="synoptic-table">
                <h4>Guía de Mejores Prácticas para Documentar Patrones:</h4>
                <table role="table">
                    <tr role="row">
                        <th role="columnheader">Aspecto</th>
                        <th role="columnheader">Recomendación</th>
                        <th role="columnheader">Ejemplo</th>
                    </tr>
                    <tr role="row">
                        <td role="cell">Estereotipos</td>
                        <td role="cell">Usar para identificar roles del patrón</td>
                        <td role="cell">«Singleton», «Factory», «Observer»</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Nombres</td>
                        <td role="cell">Incluir el nombre del patrón cuando sea claro</td>
                        <td role="cell">ConfigurationSingleton, PaymentStrategy</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Notas</td>
                        <td role="cell">Agregar notas UML explicando decisiones</td>
                        <td role="cell">"Este patrón permite cambiar el algoritmo en runtime"</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Colaboraciones</td>
                        <td role="cell">Incluir diagramas de secuencia</td>
                        <td role="cell">Mostrar flujo de llamadas entre objetos</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Multiplicidad</td>
                        <td role="cell">Ser preciso con las cardinalidades</td>
                        <td role="cell">Observer: 1 Subject → * Observers</td>
                    </tr>
                    <tr role="row">
                        <td role="cell">Interfaces</td>
                        <td role="cell">Usar interfaces para abstracciones</td>
                        <td role="cell">Marcar claramente con «interface»</td>
                    </tr>
                </table>
            </div>

            <h3>4.5 Combinación de Patrones</h3>
            <p>En sistemas reales, los patrones raramente aparecen aislados. Es común combinar múltiples patrones para resolver problemas complejos.</p>

            <div class="pattern-card">
                <h5>Ejemplos de Combinaciones Comunes:</h5>
                <ul role="list">
                    <li role="listitem"><strong>MVC:</strong> Combina Observer (Model-View) + Strategy (Controller) + Composite (View)</li>
                    <li role="listitem"><strong>Abstract Factory + Singleton:</strong> Fábricas únicas para familias de objetos</li>
                    <li role="listitem"><strong>Decorator + Factory Method:</strong> Crear decoradores dinámicamente</li>
                    <li role="listitem"><strong>Strategy + Template Method:</strong> Algoritmos intercambiables con estructura común</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>Anti-patrones a Evitar:</h4>
                <ul role="list">
                    <li role="listitem"><strong>Singleton Overuse:</strong> No todo necesita ser singleton</li>
                    <li role="listitem"><strong>Pattern Obsession:</strong> No forzar patrones donde no son necesarios</li>
                    <li role="listitem"><strong>Premature Abstraction:</strong> No sobre-diseñar anticipando cambios futuros</li>
                    <li role="listitem"><strong>Copy-Paste Pattern:</strong> Entender el patrón, no solo copiar código</li>
                </ul>
            </div>

            <p>La representación efectiva de patrones en UML no solo documenta la solución técnica, sino que también comunica la intención del diseño, las decisiones arquitectónicas y facilita la comprensión y mantenimiento del sistema a largo plazo. El dominio de estos patrones y su correcta representación en UML es una habilidad fundamental para todo analista de sistemas.</p>
        </section>

        <!-- Resumen y Conclusiones -->
        <section class="section">
            <h2>Resumen y Conclusiones</h2>
            
            <div class="concept-box">
                <h3>Puntos Clave de la Clase:</h3>
                <ul role="list">
                    <li role="listitem">Los diagramas de clases UML son fundamentales para el modelado orientado a objetos</li>
                    <li role="listitem">La notación precisa es esencial para la comunicación efectiva</li>
                    <li role="listitem">Las relaciones entre clases expresan la estructura y colaboración del sistema</li>
                    <li role="listitem">Las técnicas sistemáticas de modelado mejoran la calidad del diseño</li>
                    <li role="listitem">Los patrones de diseño se documentan efectivamente usando UML</li>
                </ul>
            </div>

            <h3>Próximos Pasos</h3>
            <p>En la siguiente clase, exploraremos los Casos de Uso Avanzados, profundizando en la especificación según Cockburn y las relaciones complejas entre casos de uso.</p>
        </section>

        <!-- Sección de Evaluación -->
        <section class="quiz-section">
            <h2>Evaluación - 20 Preguntas</h2>
            <p class="quiz-instructions">Selecciona la respuesta correcta para cada pregunta. Al finalizar, presiona el botón "Ver Resultados" para conocer tu puntuación.</p>
            
            <div id="quiz-container">
                <div class="question" data-question="1" data-answer="B">
                    <h4>1. ¿Qué símbolo representa un atributo privado en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) ~</li>
                    </ul>
                </div>

                <div class="question" data-question="2" data-answer="B">
                    <h4>2. ¿Cuál es la diferencia visual entre agregación y composición?</h4>
                    <ul class="options">
                        <li data-option="A">A) La agregación usa un diamante relleno, la composición uno vacío</li>
                        <li data-option="B">B) La agregación usa un diamante vacío, la composición uno relleno</li>
                        <li data-option="C">C) Ambas usan el mismo símbolo</li>
                        <li data-option="D">D) La agregación no tiene símbolo especial</li>
                    </ul>
                </div>

                <div class="question" data-question="3" data-answer="C">
                    <h4>3. ¿Cuándo se usa una relación de dependencia?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cuando hay una relación permanente entre clases</li>
                        <li data-option="B">B) Cuando una clase hereda de otra</li>
                        <li data-option="C">C) Cuando el uso es temporal y no implica un atributo permanente</li>
                        <li data-option="D">D) Cuando las clases comparten atributos</li>
                    </ul>
                </div>

                <div class="question" data-question="4" data-answer="D">
                    <h4>4. ¿Qué representa una línea punteada con flecha en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Herencia</li>
                        <li data-option="B">B) Asociación</li>
                        <li data-option="C">C) Composición</li>
                        <li data-option="D">D) Dependencia o Realización</li>
                    </ul>
                </div>

                <div class="question" data-question="5" data-answer="B">
                    <h4>5. ¿Cómo se indica una clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Con el nombre en negrita</li>
                        <li data-option="B">B) Con el nombre en cursiva o estereotipo «abstract»</li>
                        <li data-option="C">C) Con un asterisco después del nombre</li>
                        <li data-option="D">D) Subrayando el nombre</li>
                    </ul>
                </div>

                <div class="question" data-question="6" data-answer="C">
                    <h4>6. ¿Qué significa la multiplicidad "1..*" en una asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cero o más</li>
                        <li data-option="B">B) Exactamente uno</li>
                        <li data-option="C">C) Uno o más</li>
                        <li data-option="D">D) Cero o uno</li>
                    </ul>
                </div>

                <div class="question" data-question="7" data-answer="B">
                    <h4>7. ¿Cuál es el propósito principal de una clase de asociación?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases en el diagrama</li>
                        <li data-option="B">B) Modelar atributos y comportamiento de la relación misma</li>
                        <li data-option="C">C) Simplificar la herencia</li>
                        <li data-option="D">D) Eliminar dependencias</li>
                    </ul>
                </div>

                <div class="question" data-question="8" data-answer="B">
                    <h4>8. En el patrón Singleton, ¿qué característica es fundamental?</h4>
                    <ul class="options">
                        <li data-option="A">A) Múltiples constructores públicos</li>
                        <li data-option="B">B) Constructor privado y método getInstance() estático</li>
                        <li data-option="C">C) Herencia múltiple</li>
                        <li data-option="D">D) Implementación de varias interfaces</li>
                    </ul>
                </div>

                <div class="question" data-question="9" data-answer="B">
                    <h4>9. ¿Qué técnica usa sustantivos para identificar clases candidatas?</h4>
                    <ul class="options">
                        <li data-option="A">A) Análisis CRC</li>
                        <li data-option="B">B) Análisis lingüístico</li>
                        <li data-option="C">C) Análisis de patrones</li>
                        <li data-option="D">D) Análisis de casos de uso</li>
                    </ul>
                </div>

                <div class="question" data-question="10" data-answer="C">
                    <h4>10. ¿Cuál NO es una categoría típica de clases en el modelado?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cosas tangibles</li>
                        <li data-option="B">B) Roles</li>
                        <li data-option="C">C) Colores</li>
                        <li data-option="D">D) Eventos</li>
                    </ul>
                </div>

                <div class="question" data-question="11" data-answer="B">
                    <h4>11. ¿Qué significa CRC en las tarjetas CRC?</h4>
                    <ul class="options">
                        <li data-option="A">A) Create-Read-Copy</li>
                        <li data-option="B">B) Clase-Responsabilidad-Colaboración</li>
                        <li data-option="C">C) Control-Relación-Clase</li>
                        <li data-option="D">D) Concepto-Regla-Condición</li>
                    </ul>
                </div>

                <div class="question" data-question="12" data-answer="B">
                    <h4>12. ¿Cuál es la diferencia principal entre interfaz y clase abstracta en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) No hay diferencia</li>
                        <li data-option="B">B) Las interfaces solo tienen operaciones, no atributos</li>
                        <li data-option="C">C) Las clases abstractas no pueden tener métodos</li>
                        <li data-option="D">D) Las interfaces usan herencia múltiple</li>
                    </ul>
                </div>

                <div class="question" data-question="13" data-answer="D">
                    <h4>13. ¿Qué patrón define una familia de algoritmos intercambiables?</h4>
                    <ul class="options">
                        <li data-option="A">A) Singleton</li>
                        <li data-option="B">B) Factory</li>
                        <li data-option="C">C) Observer</li>
                        <li data-option="D">D) Strategy</li>
                    </ul>
                </div>

                <div class="question" data-question="14" data-answer="B">
                    <h4>14. En una relación de composición, ¿qué ocurre cuando se elimina el "todo"?</h4>
                    <ul class="options">
                        <li data-option="A">A) Las partes continúan existiendo</li>
                        <li data-option="B">B) Las partes también se eliminan</li>
                        <li data-option="C">C) Se convierten en agregación</li>
                        <li data-option="D">D) Se crea una nueva instancia</li>
                    </ul>
                </div>

                <div class="question" data-question="15" data-answer="C">
                    <h4>15. ¿Qué notación se usa para un método estático en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Cursiva</li>
                        <li data-option="B">B) Negrita</li>
                        <li data-option="C">C) Subrayado</li>
                        <li data-option="D">D) Entre corchetes</li>
                    </ul>
                </div>

                <div class="question" data-question="16" data-answer="C">
                    <h4>16. ¿Cuál es el símbolo de visibilidad para "protegido"?</h4>
                    <ul class="options">
                        <li data-option="A">A) +</li>
                        <li data-option="B">B) -</li>
                        <li data-option="C">C) #</li>
                        <li data-option="D">D) *</li>
                    </ul>
                </div>

                <div class="question" data-question="17" data-answer="B">
                    <h4>17. ¿Qué tipo de flecha indica herencia en UML?</h4>
                    <ul class="options">
                        <li data-option="A">A) Flecha simple</li>
                        <li data-option="B">B) Flecha con triángulo vacío</li>
                        <li data-option="C">C) Flecha punteada</li>
                        <li data-option="D">D) Flecha doble</li>
                    </ul>
                </div>

                <div class="question" data-question="18" data-answer="C">
                    <h4>18. ¿Cuándo es apropiado usar navegabilidad unidireccional?</h4>
                    <ul class="options">
                        <li data-option="A">A) Siempre</li>
                        <li data-option="B">B) Nunca</li>
                        <li data-option="C">C) Cuando solo una clase necesita conocer a la otra</li>
                        <li data-option="D">D) En relaciones de herencia</li>
                    </ul>
                </div>

                <div class="question" data-question="19" data-answer="C">
                    <h4>19. ¿Qué indica el estereotipo «enumeration»?</h4>
                    <ul class="options">
                        <li data-option="A">A) Una clase abstracta</li>
                        <li data-option="B">B) Una interfaz</li>
                        <li data-option="C">C) Un tipo con valores fijos predefinidos</li>
                        <li data-option="D">D) Una clase singleton</li>
                    </ul>
                </div>

                <div class="question" data-question="20" data-answer="C">
                    <h4>20. ¿Cuál es el beneficio principal de usar patrones de diseño?</h4>
                    <ul class="options">
                        <li data-option="A">A) Reducir el número de clases</li>
                        <li data-option="B">B) Aumentar la complejidad</li>
                        <li data-option="C">C) Proporcionar soluciones probadas a problemas recurrentes</li>
                        <li data-option="D">D) Eliminar la necesidad de documentación</li>
                    </ul>
                </div>
            </div>

            <div class="quiz-controls">
                <button id="submit-quiz" class="quiz-button">Ver Resultados</button>
                <button id="reset-quiz" class="quiz-button secondary" style="display: none;">Reiniciar Cuestionario</button>
            </div>

            <div id="quiz-results" class="quiz-results" style="display: none;">
                <h3>Resultados de la Evaluación</h3>
                <div class="results-summary">
                    <div class="score-circle">
                        <div class="score-text">
                            <span id="score-number">0</span>
                            <span class="score-total">/20</span>
                        </div>
                        <div class="score-percentage" id="score-percentage">0%</div>
                    </div>
                    <div class="score-message" id="score-message"></div>
                </div>
                <div class="answers-review" id="answers-review"></div>
            </div>
        </section>

        <!-- Referencias Bibliográficas -->
        <section class="section">
            <h2>Referencias Bibliográficas</h2>
            <ul role="list">
                <li role="listitem">Larman, C. (2003). <em>UML y Patrones: Una Introducción al Análisis y Diseño Orientado a Objetos y al Proceso Unificado</em>. Segunda edición. Pearson Educación.</li>
                <li role="listitem">Fowler, M. (1999). <em>UML gota a gota</em>. Pearson Educación.</li>
                <li role="listitem">Booch, G., Rumbaugh, J., & Jacobson, I. (2006). <em>El Lenguaje Unificado de Modelado. UML 2.0</em>. Addison-Wesley.</li>
                <li role="listitem">Cockburn, A. (2000). <em>Writing Effective Use Cases</em>. Addison-Wesley.</li>
                <li role="listitem">Pressman, R. (1998). <em>Ingeniería de Software: Un enfoque Práctico</em>. 4ª ed. McGraw-Hill.</li>
            </ul>
        </section>
    </div>

    <script>
        // Script para interactividad del cuestionario
        document.addEventListener('DOMContentLoaded', function() {
            // Variables globales
            const quizContainer = document.getElementById('quiz-container');
            const submitButton = document.getElementById('submit-quiz');
            const resetButton = document.getElementById('reset-quiz');
            const resultsDiv = document.getElementById('quiz-results');
            const scoreNumber = document.getElementById('score-number');
            const scorePercentage = document.getElementById('score-percentage');
            const scoreMessage = document.getElementById('score-message');
            const answersReview = document.getElementById('answers-review');
            
            // Estado del quiz
            let userAnswers = {};
            let quizSubmitted = false;

            // Manejar selección de respuestas
            const optionElements = document.querySelectorAll('.options li');
            optionElements.forEach(option => {
                option.addEventListener('click', function() {
                    if (quizSubmitted) return; // No permitir cambios después de enviar
                    
                    const questionDiv = this.closest('.question');
                    const questionNumber = questionDiv.dataset.question;
                    const selectedOption = this.dataset.option;
                    
                    // Eliminar selección previa
                    questionDiv.querySelectorAll('.options li').forEach(li => {
                        li.classList.remove('selected');
                    });
                    
                    // Agregar nueva selección
                    this.classList.add('selected');
                    questionDiv.classList.add('answered');
                    
                    // Guardar respuesta
                    userAnswers[questionNumber] = selectedOption;
                    
                    // Verificar si todas las preguntas fueron respondidas
                    checkAllAnswered();
                });
            });

            // Verificar si todas las preguntas fueron respondidas
            function checkAllAnswered() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions === totalQuestions) {
                    submitButton.style.background = '#27ae60';
                    submitButton.textContent = '¡Listo! Ver Resultados';
                }
            }

            // Manejar envío del quiz
            submitButton.addEventListener('click', function() {
                const totalQuestions = document.querySelectorAll('.question').length;
                const answeredQuestions = Object.keys(userAnswers).length;
                
                if (answeredQuestions < totalQuestions) {
                    alert(`Por favor responde todas las preguntas. Has respondido ${answeredQuestions} de ${totalQuestions}.`);
                    return;
                }
                
                // Calcular puntuación
                let correctAnswers = 0;
                const questions = document.querySelectorAll('.question');
                
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    
                    if (userAnswer === correctAnswer) {
                        correctAnswers++;
                    }
                });
                
                // Mostrar resultados
                showResults(correctAnswers, totalQuestions);
                quizSubmitted = true;
                
                // Cambiar botones
                submitButton.style.display = 'none';
                resetButton.style.display = 'inline-block';
                
                // Scroll a resultados
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Mostrar resultados
            function showResults(correct, total) {
                const percentage = Math.round((correct / total) * 100);
                
                // Mostrar puntuación
                scoreNumber.textContent = correct;
                scorePercentage.textContent = percentage + '%';
                
                // Mostrar mensaje según el resultado
                let message = '';
                let messageClass = '';
                
                if (percentage >= 90) {
                    message = '¡Excelente! Dominas muy bien los conceptos de UML.';
                    messageClass = 'excellent';
                } else if (percentage >= 70) {
                    message = '¡Muy bien! Tienes un buen conocimiento de UML.';
                    messageClass = 'good';
                } else if (percentage >= 50) {
                    message = 'Regular. Te recomendamos repasar algunos conceptos.';
                    messageClass = 'regular';
                } else {
                    message = 'Necesitas mejorar. Revisa el material de estudio nuevamente.';
                    messageClass = 'needs-improvement';
                }
                
                scoreMessage.textContent = message;
                scoreMessage.className = 'score-message ' + messageClass;
                
                // Mostrar revisión de respuestas
                showAnswersReview();
                
                // Mostrar div de resultados
                resultsDiv.style.display = 'block';
                
                // Animar el círculo de puntuación
                animateScore(percentage);
            }

            // Mostrar revisión de respuestas
            function showAnswersReview() {
                answersReview.innerHTML = '<h3>Revisión de Respuestas:</h3>';
                
                const questions = document.querySelectorAll('.question');
                questions.forEach(question => {
                    const questionNumber = question.dataset.question;
                    const correctAnswer = question.dataset.answer;
                    const userAnswer = userAnswers[questionNumber];
                    const isCorrect = userAnswer === correctAnswer;
                    
                    const reviewItem = document.createElement('div');
                    reviewItem.className = `answer-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    
                    const icon = isCorrect ? '✓' : '✗';
                    const text = isCorrect 
                        ? `Pregunta ${questionNumber}: Correcta (${userAnswer})`
                        : `Pregunta ${questionNumber}: Incorrecta - Tu respuesta: ${userAnswer}, Correcta: ${correctAnswer}`;
                    
                    reviewItem.innerHTML = `
                        <span class="answer-icon">${icon}</span>
                        <span>${text}</span>
                    `;
                    
                    answersReview.appendChild(reviewItem);
                    
                    // Marcar respuestas en el quiz original
                    const options = question.querySelectorAll('.options li');
                    options.forEach(option => {
                        if (option.dataset.option === correctAnswer) {
                            option.classList.add('correct');
                        } else if (option.dataset.option === userAnswer && !isCorrect) {
                            option.classList.add('incorrect');
                        }
                    });
                });
            }

            // Animar puntuación
            function animateScore(targetPercentage) {
                let currentPercentage = 0;
                const increment = targetPercentage / 50; // Animar en 50 pasos
                
                const animation = setInterval(() => {
                    currentPercentage += increment;
                    if (currentPercentage >= targetPercentage) {
                        currentPercentage = targetPercentage;
                        clearInterval(animation);
                    }
                    
                    // Actualizar color del círculo según el porcentaje
                    const scoreCircle = document.querySelector('.score-circle');
                    if (currentPercentage >= 90) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    } else if (currentPercentage >= 70) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #3498db, #5dade2)';
                    } else if (currentPercentage >= 50) {
                        scoreCircle.style.background = 'linear-gradient(135deg, #f39c12, #f1c40f)';
                    } else {
                        scoreCircle.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    }
                }, 20);
            }

            // Reiniciar quiz
            resetButton.addEventListener('click', function() {
                // Reiniciar variables
                userAnswers = {};
                quizSubmitted = false;
                
                // Limpiar selecciones
                document.querySelectorAll('.options li').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                
                document.querySelectorAll('.question').forEach(question => {
                    question.classList.remove('answered');
                });
                
                // Ocultar resultados
                resultsDiv.style.display = 'none';
                
                // Cambiar botones
                submitButton.style.display = 'inline-block';
                submitButton.style.background = '';
                submitButton.textContent = 'Ver Resultados';
                resetButton.style.display = 'none';
                
                // Scroll al inicio del quiz
                quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            // Hacer que los diagramas SVG sean interactivos
            const svgDiagrams = document.querySelectorAll('.interactive-diagram');
            svgDiagrams.forEach(diagram => {
                diagram.addEventListener('click', function() {
                    // Aquí se puede agregar funcionalidad adicional
                    console.log('Diagrama clickeado');
                });
            });
        });
    </script>
    <script src="keyboard-navigation.js"></script>
</body>
</html>